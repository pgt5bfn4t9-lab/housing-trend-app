const startYearSlider = document.querySelector("#start-year");
const startYearLabel = document.querySelector("#start-year-label");
const startPriceEl = document.querySelector("#start-price");
const latestPriceEl = document.querySelector("#latest-price");
const totalChangeEl = document.querySelector("#total-change");
const dataBody = document.querySelector("#data-body");
const chart = document.querySelector("#chart");
const chartPanel = document.querySelector(".chart-panel");
const chartTooltip = document.querySelector("#chart-tooltip");
const districtPanel = document.querySelector(".district-panel");
const districtTooltip = document.querySelector("#district-tooltip");
const cityIndexPanel = document.querySelector(".city-index-panel");
const cityIndexChart = document.querySelector("#city-index-chart");
const cityIndexTooltip = document.querySelector("#city-index-tooltip");
const cityIndexSummary = document.querySelector("#city-index-summary");
const pyramidPanel = document.querySelector(".pyramid-panel");
const populationPyramidChart = document.querySelector("#population-pyramid-chart");
const populationPyramidTooltip = document.querySelector("#population-pyramid-tooltip");
const pyramidWorkingAgeSummary = document.querySelector("#pyramid-working-age-summary");
const pyramidYearSlider = document.querySelector("#pyramid-year");
const pyramidYearLabel = document.querySelector("#pyramid-year-label");
const pyramidPlayBtn = document.querySelector("#pyramid-play-btn");
const rawInput = document.querySelector("#raw-input");
const parseBtn = document.querySelector("#parse-btn");
const bgmBtn = document.querySelector("#bgm-btn");
const bgmVolume = document.querySelector("#bgm-volume");
const parseStatus = document.querySelector("#parse-status");
const saveNameInput = document.querySelector("#save-name");
const saveBtn = document.querySelector("#save-btn");
const savedSelect = document.querySelector("#saved-select");
const deleteBtn = document.querySelector("#delete-btn");
const exportSavedBtn = document.querySelector("#export-saved-btn");
const importSavedBtn = document.querySelector("#import-saved-btn");
const importSavedFile = document.querySelector("#import-saved-file");
const districtResidenceChart = document.querySelector("#district-residence-chart");

const SAVED_KEY = "housingSavedPastesV1";
const DEFAULT_SAVED_NAME = "颐德公馆";
const XIYA_SAVED_NAME = "西雅苑";
const PENGRUI_SAVED_NAME = "鹏瑞金玥湾";
const NANSHAN_SAVED_NAME = "南山丰景";
const FULI_DONGDIWAN_SAVED_NAME = "富力东堤湾";
const XIAOFENGYINYUE_SAVED_NAME = "绿城晓风印月";
const HUIYAYUAN_SAVED_NAME = "荟雅苑";
const TIANYU_GARDEN_SAVED_NAME = "天誉花园";
const TIANYUE_JIANGWAN_SAVED_NAME = "天悦江湾";
const DIECUIFENG_SAVED_NAME = "叠翠峰";
const DISTRICT_YEARS = ["2021", "2022", "2023", "2024", "2025"];
const DISTRICT_RESIDENCE_SERIES = [
  { name: "越秀", color: "#ef4444", data: [10870, 6731, 8450, 9482, 8014] },
  { name: "海珠", color: "#f97316", data: [15751, 9094, 11215, 12212, 13152] },
  { name: "荔湾", color: "#eab308", data: [7537, 5124, 6980, 7976, 9866] },
  { name: "天河", color: "#22c55e", data: [15210, 7731, 9395, 9857, 9375] },
  { name: "白云", color: "#06b6d4", data: [11356, 6987, 8627, 9089, 10638] },
  { name: "黄埔", color: "#3b82f6", data: [5808, 2707, 4425, 5785, 6464] },
  { name: "花都", color: "#6366f1", data: [10257, 7551, 10025, 9367, 9468] },
  { name: "番禺", color: "#a855f7", data: [15654, 9095, 11990, 13639, 13835] },
  { name: "南沙", color: "#ec4899", data: [5246, 2025, 2925, 4378, 5052] },
  { name: "从化", color: "#14b8a6", data: [4111, 3257, 4051, 3979, 4298] },
  { name: "增城", color: "#84cc16", data: [12579, 6587, 8864, 10252, 11453] },
];
const DISTRICT_YEAR_TOTALS = DISTRICT_YEARS.map((_, yearIdx) =>
  DISTRICT_RESIDENCE_SERIES.reduce((sum, s) => sum + s.data[yearIdx], 0),
);
const CITY_INDEX_DATES = buildMonthlyLabels("2008-01", "2026-01");
const CITY_INDEX_ANCHORS = {
  北京: [
    ["2008-01", 100], ["2009-01", 85], ["2010-01", 130], ["2011-01", 170], ["2012-01", 160], ["2013-01", 185],
    ["2014-01", 225], ["2015-01", 220], ["2016-01", 260], ["2017-01", 330], ["2018-01", 360], ["2019-01", 355],
    ["2020-01", 340], ["2021-01", 330], ["2022-01", 390], ["2023-01", 410], ["2024-01", 437.4], ["2025-01", 320], ["2026-01", 269.9],
  ],
  上海: [
    ["2008-01", 100], ["2009-01", 88], ["2010-01", 120], ["2011-01", 140], ["2012-01", 150], ["2013-01", 170],
    ["2014-01", 190], ["2015-01", 180], ["2016-01", 210], ["2017-01", 335], ["2018-01", 330], ["2019-01", 320],
    ["2020-01", 310], ["2021-01", 330], ["2022-01", 385.8], ["2023-01", 370], ["2024-01", 340], ["2025-01", 270], ["2026-01", 232.9],
  ],
  广州: [
    ["2008-01", 100], ["2009-01", 90], ["2010-01", 125], ["2011-01", 145], ["2012-01", 170], ["2013-01", 200],
    ["2014-01", 240], ["2015-01", 225], ["2016-01", 250], ["2017-01", 320], ["2018-01", 430], ["2019-01", 395],
    ["2020-01", 420], ["2021-01", 430], ["2022-01", 511.5], ["2023-01", 470], ["2024-01", 500], ["2025-01", 360], ["2026-01", 305.0],
  ],
  深圳: [
    ["2008-01", 100], ["2009-01", 82], ["2010-01", 135], ["2011-01", 130], ["2012-01", 145], ["2013-01", 160],
    ["2014-01", 170], ["2015-01", 200], ["2016-01", 330], ["2017-01", 370], ["2018-01", 380], ["2019-01", 370],
    ["2020-01", 400], ["2021-01", 500], ["2022-01", 571.5], ["2023-01", 460], ["2024-01", 470], ["2025-01", 360], ["2026-01", 318.1],
  ],
  香港: [
    ["2008-01", 100], ["2009-01", 80], ["2010-01", 95], ["2011-01", 115], ["2012-01", 140], ["2013-01", 160],
    ["2014-01", 170], ["2015-01", 200], ["2016-01", 180], ["2017-01", 220], ["2018-01", 268.8], ["2019-01", 260],
    ["2020-01", 250], ["2021-01", 250], ["2022-01", 268], ["2023-01", 230], ["2024-01", 220], ["2025-01", 190], ["2026-01", 207.5],
  ],
};
const CITY_INDEX_SERIES = [
  { name: "北京", color: "#5b8ff9", data: buildInterpolatedSeries(CITY_INDEX_DATES, CITY_INDEX_ANCHORS.北京, 2, 4.2) },
  { name: "上海", color: "#f08c3a", data: buildInterpolatedSeries(CITY_INDEX_DATES, CITY_INDEX_ANCHORS.上海, 4, 3.9) },
  { name: "广州", color: "#f0c419", data: buildInterpolatedSeries(CITY_INDEX_DATES, CITY_INDEX_ANCHORS.广州, 7, 5.2) },
  { name: "深圳", color: "#5f8f4a", data: buildInterpolatedSeries(CITY_INDEX_DATES, CITY_INDEX_ANCHORS.深圳, 11, 5.8) },
  { name: "香港", color: "#1f1f1f", data: buildInterpolatedSeries(CITY_INDEX_DATES, CITY_INDEX_ANCHORS.香港, 16, 3.2) },
];
const PYRAMID_AGE_GROUPS = ["0-10", "10-20", "20-30", "30-40", "40-50", "50-60", "60-70", "70-80", "80-90", "90-100"];
const PYRAMID_ANCHOR_YEARS = [1991, 2001, 2011, 2021, 2031];
const PYRAMID_YEARS = buildYearLabels(PYRAMID_ANCHOR_YEARS[0], PYRAMID_ANCHOR_YEARS[PYRAMID_ANCHOR_YEARS.length - 1]);
const POPULATION_PYRAMID_ANCHORS = {
  "1991": [
    {
      name: "中国",
      male: [86, 82, 78, 95, 88, 68, 50, 33, 18, 7],
      female: [80, 76, 72, 90, 84, 65, 48, 32, 17, 7],
      totalLabel: "1,168,317,741",
      colors: { male: "#c0392b", female: "#e74c3c" },
    },
    {
      name: "印度",
      male: [82, 76, 70, 62, 52, 41, 30, 19, 10, 4],
      female: [79, 73, 67, 59, 49, 39, 29, 18, 9, 4],
      totalLabel: "853,724,391",
      colors: { male: "#f39c12", female: "#f1c40f" },
    },
  ],
  "2001": [
    {
      name: "中国",
      male: [80, 78, 75, 90, 92, 74, 54, 36, 20, 8],
      female: [75, 73, 70, 87, 90, 72, 53, 35, 19, 8],
      totalLabel: "1,267,430,000",
      colors: { male: "#c0392b", female: "#e74c3c" },
    },
    {
      name: "印度",
      male: [96, 88, 80, 70, 60, 47, 34, 22, 12, 5],
      female: [92, 85, 77, 68, 58, 45, 33, 21, 11, 5],
      totalLabel: "1,053,050,912",
      colors: { male: "#f39c12", female: "#f1c40f" },
    },
  ],
  "2011": [
    {
      name: "中国",
      male: [72, 70, 74, 86, 95, 82, 62, 42, 24, 10],
      female: [68, 67, 71, 84, 94, 80, 61, 41, 24, 10],
      totalLabel: "1,344,130,000",
      colors: { male: "#c0392b", female: "#e74c3c" },
    },
    {
      name: "印度",
      male: [92, 90, 86, 78, 68, 55, 41, 27, 15, 6],
      female: [88, 86, 83, 75, 65, 53, 40, 26, 15, 6],
      totalLabel: "1,210,854,977",
      colors: { male: "#f39c12", female: "#f1c40f" },
    },
  ],
  "2021": [
    {
      name: "中国",
      male: [62, 64, 70, 82, 93, 88, 72, 52, 31, 13],
      female: [58, 61, 68, 80, 92, 87, 71, 52, 31, 13],
      totalLabel: "1,412,360,000",
      colors: { male: "#c0392b", female: "#e74c3c" },
    },
    {
      name: "印度",
      male: [86, 88, 90, 86, 76, 62, 47, 32, 18, 8],
      female: [82, 84, 87, 83, 73, 60, 46, 31, 18, 8],
      totalLabel: "1,393,409,038",
      colors: { male: "#f39c12", female: "#f1c40f" },
    },
  ],
  "2031": [
    {
      name: "中国",
      male: [54, 58, 66, 76, 88, 92, 82, 64, 42, 18],
      female: [50, 55, 64, 74, 87, 91, 82, 65, 43, 19],
      totalLabel: "1,430,000,000",
      colors: { male: "#c0392b", female: "#e74c3c" },
    },
    {
      name: "印度",
      male: [80, 84, 88, 90, 86, 72, 56, 38, 23, 10],
      female: [77, 81, 85, 88, 84, 70, 55, 37, 22, 10],
      totalLabel: "1,520,000,000",
      colors: { male: "#f39c12", female: "#f1c40f" },
    },
  ],
};
const POPULATION_PYRAMID_FRAMES = buildPyramidFramesByYear(POPULATION_PYRAMID_ANCHORS);
const YIDE_DATA_TEXT = `日期	单价	面积（㎡）	总价	朝向	楼层
日期2026.01.22	126123元	220.42	2780万元	南 西南 北	低楼层(共36层)
日期2024.11.11	199320元	170.58	3400万元	南 北	高楼层(共43层)
日期2024.10.12	200978元	184.1	3700万元	南 北	高楼层(共43层)
日期2023.08.22	244343元	170.58	4168万元	南 北	高楼层(共43层)
日期2023.04.14	252005元	199.6	5030万元	南	高楼层(共43层)
日期2023.03.01	236407元	219.96	5200万元	南	低楼层(共36层)
日期2023.02.22	244990元	199.6	4890万元	南	高楼层(共43层)
日期2023.01.06	209853元	203	4260万元	南	低楼层(共43层)
日期2022.11.13	199034元	207	4120万元	北	低楼层(共42层)
日期2022.03.21	217375元	199.6	4338.8万元	南	中楼层(共43层)
日期2021.05.16	227460元	170.58	3880万元	南 北	中楼层(共43层)
日期2021.03.04	180361元	199.6	3600万元	南 北	高楼层(共43层)
日期2021.01.15	167353元	170	2845万元	南 北	中楼层(共43层)
日期2020.08.21	132752元	219.96	2920万元	南	低楼层(共36层)
日期2020.07.18	110542元	173.69	1920万元	南 北	低楼层(共43层)`;
const XIYA_DATA_TEXT = `西雅苑 3室1厅 91.2平米-广州西雅苑二手房成交
西雅苑 3室1厅 91.2平米
北 | 精装2025.12.19362.8万
低楼层(共28层) 2002年塔楼39781元/平
房屋满五年近地铁
挂牌418万成交周期146天
欧阳家免费咨询
西雅苑 2室2厅 94.62平米-广州西雅苑二手房成交
西雅苑 2室2厅 94.62平米
南 | 其他2025.12.17316万
低楼层(共28层) 1997年板塔结合33397元/平
房屋满五年
挂牌399万成交周期971天
崔晓锋免费咨询
西雅苑 2室2厅 91.2平米-广州西雅苑二手房成交
西雅苑 2室2厅 91.2平米
北 | 精装2025.06.09468万
高楼层(共28层) 1998年塔楼51316元/平
房屋满五年近地铁
挂牌468万成交周期193天
何城免费咨询
西雅苑 3室1厅 88.01平米-广州西雅苑二手房成交
西雅苑 3室1厅 88.01平米
南 | 其他2025.05.16468万
中楼层(共18层) 1998年塔楼53176元/平
房屋满五年近地铁
挂牌468万成交周期41天
何城免费咨询
西雅苑 3室1厅 98.94平米-广州西雅苑二手房成交
西雅苑 3室1厅 98.94平米
南 北 | 简装2025.04.04522万
中楼层(共28层) 1998年塔楼52760元/平
近地铁
挂牌565万成交周期380天
梁柱金免费咨询
西雅苑 3室2厅 98.94平米-广州西雅苑二手房成交
西雅苑 3室2厅 98.94平米
南 北 | 精装2025.03.19556万
高楼层(共28层) 1998年塔楼56196元/平
房屋满两年近地铁
挂牌638万成交周期78天
郑思源免费咨询
西雅苑 3室2厅 109.72平米-广州西雅苑二手房成交
西雅苑 3室2厅 109.72平米
南 | 精装2025.01.24558万
高楼层(共28层) 1998年塔楼50857元/平
房屋满五年近地铁
挂牌595万成交周期101天
潘桂朱免费咨询
西雅苑 4室2厅 114.86平米-广州西雅苑二手房成交
西雅苑 4室2厅 114.86平米
南 | 其他2024.10.15650万
中楼层(共18层) 1998年塔楼56591元/平
房屋满五年近地铁
挂牌768万成交周期52天
谢华建免费咨询
西雅苑 1室0厅 44.2平米-广州西雅苑二手房成交
西雅苑 1室0厅 44.2平米
东南 | 其他2024.08.04208万
高楼层(共28层) 1998年板塔结合47059元/平
房屋满五年
挂牌240万成交周期57天
黄亚妮免费咨询
西雅苑 3室2厅 109.72平米-广州西雅苑二手房成交
西雅苑 3室2厅 109.72平米
南 西南 北 | 简装2024.06.16558万
高楼层(共28层) 1998年塔楼50857元/平
房屋满五年近地铁
挂牌650万成交周期118天
冯洁谊免费咨询
西雅苑 3室2厅 104平米-广州西雅苑二手房成交
西雅苑 3室2厅 104平米
南 | 其他2024.06.11615万
高楼层(共18层) 1998年塔楼59135元/平
近地铁
挂牌750万成交周期45天
戴志杭免费咨询
西雅苑 3室2厅 95.86平米-广州西雅苑二手房成交
西雅苑 3室2厅 95.86平米
南 | 精装2024.06.08533万
高楼层(共18层) 1998年塔楼55602元/平
房屋满五年近地铁
挂牌588万成交周期35天
张苗免费咨询
西雅苑 3室2厅 89.9平米-广州西雅苑二手房成交
西雅苑 3室2厅 89.9平米
南 | 简装2022.10.10708万
高楼层(共28层) 1998年塔楼78755元/平
房屋满五年近地铁
挂牌745万成交周期99天
李钰免费咨询
西雅苑 2室2厅 79.19平米-广州西雅苑二手房成交
西雅苑 2室2厅 79.19平米
西北 | 精装2022.04.16525万
低楼层(共28层) 1998年板塔结合66297元/平
房屋满五年
挂牌549万成交周期88天
梁金艳免费咨询
西雅苑 3室2厅 109.72平米-广州西雅苑二手房成交
西雅苑 3室2厅 109.72平米
南 | 简装2021.07.24830万
中楼层(共28层) 1998年塔楼75648元/平
房屋满五年近地铁
挂牌840万成交周期7天
许家杰免费咨询
西雅苑 3室1厅 91.2平米-广州西雅苑二手房成交
西雅苑 3室1厅 91.2平米
北 | 简装2021.05.02660万
高楼层(共28层) 1998年塔楼72369元/平
房屋满五年近地铁
挂牌715万成交周期11天
崔晓锋免费咨询
西雅苑 3室2厅 109平米-广州西雅苑二手房成交
西雅苑 3室2厅 109平米
南 | 其他2021.01.03733万
低楼层(共28层) 1998年板塔结合67248元/平
房屋满五年
挂牌756万成交周期76天
崔晓锋免费咨询
西雅苑 3室1厅 89平米-广州西雅苑二手房成交
西雅苑 3室1厅 89平米
南 | 其他2020.11.14656万
中楼层(共28层) 塔楼73708元/平
近地铁
挂牌670万成交周期2天
崔晓锋免费咨询
西雅苑 3室2厅 109平米-广州西雅苑二手房成交
西雅苑 3室2厅 109平米
南 北 | 简装2020.08.23641万
中楼层(共28层) 1998年塔楼58808元/平
房屋满五年近地铁
挂牌665万成交周期678天
余淡梅免费咨询
西雅苑 3室1厅 91.2平米-广州西雅苑二手房成交
西雅苑 3室1厅 91.2平米
南 | 其他2020.08.23568万
中楼层(共28层) 1998年塔楼62281元/平
房屋满五年近地铁
挂牌600万成交周期91天
罗雪梅免费咨询
西雅苑 3室2厅 99平米-广州西雅苑二手房成交
西雅苑 3室2厅 99平米
东南 | 简装2019.09.30600万
低楼层(共28层) 1990年塔楼60607元/平
近地铁
挂牌625万成交周期87天
崔晓锋免费咨询
西雅苑 2室2厅 93平米-广州西雅苑二手房成交
西雅苑 2室2厅 93平米
北 | 简装2018.09.10480万
低楼层(共28层) 1998年板塔结合51613元/平
挂牌518万成交周期191天
许家杰免费咨询`;
const PENGRUI_DATA_TEXT = `鹏瑞金玥湾 4室2厅 143.79平米-珠海鹏瑞金玥湾二手房成交
鹏瑞金玥湾 4室2厅 143.79平米
东南 | 精装2025.04.02290.8万
中楼层(共26层) 板楼20224元/平
房屋满两年
挂牌320万成交周期30天
李孔科免费咨询
鹏瑞金玥湾 4室2厅 143.38平米-珠海鹏瑞金玥湾二手房成交
鹏瑞金玥湾 4室2厅 143.38平米
南 北 | 毛坯2025.02.16270万
中楼层(共6层) 暂无数据18832元/平
房屋满两年
挂牌300万成交周期494天
刘统光免费咨询
鹏瑞金玥湾 3室2厅 128.27平米-珠海鹏瑞金玥湾二手房成交
鹏瑞金玥湾 3室2厅 128.27平米
南 | 其他2025.01.23310万
高楼层(共26层) 板楼24168元/平
挂牌360万成交周期325天
肖武平免费咨询
鹏瑞金玥湾 3室2厅 128.24平米-珠海鹏瑞金玥湾二手房成交
鹏瑞金玥湾 3室2厅 128.24平米
南 | 其他2024.12.28210万
低楼层(共26层) 板楼16376元/平
房屋满两年
挂牌245万成交周期386天
刘忠芹免费咨询
鹏瑞金玥湾 3室2厅 99.45平米-珠海鹏瑞金玥湾二手房成交
鹏瑞金玥湾 3室2厅 99.45平米
东南 | 精装2024.08.31183万
中楼层(共26层) 板楼18402元/平
挂牌200万成交周期106天
黄林免费咨询
鹏瑞金玥湾 3室2厅 99.45平米-珠海鹏瑞金玥湾二手房成交
鹏瑞金玥湾 3室2厅 99.45平米
东南 | 其他2024.06.15190万
高楼层(共26层) 板楼19106元/平
挂牌199万成交周期279天
黄业勤免费咨询
鹏瑞金玥湾 5室2厅 143.99平米-珠海鹏瑞金玥湾二手房成交
鹏瑞金玥湾 5室2厅 143.99平米
东南 | 毛坯2024.04.20496万
低楼层(共6层) 板楼34447元/平
挂牌600万成交周期57天
郑妮华免费咨询
鹏瑞金玥湾 4室2厅 193平米-珠海鹏瑞金玥湾二手房成交
鹏瑞金玥湾 4室2厅 193平米
东南 | 精装2024.02.27458万
低楼层(共26层) 板楼23731元/平
挂牌470万成交周期82天
杨豪杰`;
const NANSHAN_DATA_TEXT = `南山丰景 3室2厅 106.14平米-广州南山丰景二手房成交
南山丰景 3室2厅 106.14平米
南 | 简装2021.08.08141万
低楼层(共29层) 2017年板楼13285元/平
房屋满五年
挂牌142万成交周期132天
贺桂玉免费咨询
南山丰景 2室1厅 66.2平米-广州南山丰景二手房成交
南山丰景 2室1厅 66.2平米
南 | 精装2021.07.2181.8万
高楼层(共31层) 2017年暂无数据12357元/平
房屋满五年
挂牌82万成交周期13天
郭燕免费咨询
南山丰景 2室1厅 81.65平米-广州南山丰景二手房成交
南山丰景 2室1厅 81.65平米
南 | 精装2021.07.15100万
高楼层(共29层) 2017年板楼12248元/平
房屋满五年
挂牌101万成交周期50天
沙海林免费咨询
南山丰景 3室2厅 106.28平米-广州南山丰景二手房成交
南山丰景 3室2厅 106.28平米
南 | 精装2021.07.10132万
高楼层(共28层) 2017年塔楼12421元/平
房屋满五年
挂牌137万成交周期109天
沙海林免费咨询
南山丰景 4室2厅 141.52平米-广州南山丰景二手房成交
南山丰景 4室2厅 141.52平米
南 | 简装2021.06.20183万
低楼层(共28层) 2017年暂无数据12932元/平
房屋满五年
挂牌190万成交周期60天
沙海林免费咨询
南山丰景 2室2厅 62平米-广州南山丰景二手房成交
南山丰景 2室2厅 62平米
北 | 精装2021.05.2388万
高楼层(共31层) 2017年暂无数据14194元/平
房屋满五年
挂牌90万成交周期46天
沙海林免费咨询
南山丰景 2室2厅 61.97平米-广州南山丰景二手房成交
南山丰景 2室2厅 61.97平米
北 | 其他2021.05.1686.8万
中楼层(共31层) 2017年暂无数据14007元/平
房屋满五年
挂牌90万成交周期5天
沙海林免费咨询
南山丰景 2室1厅 84.45平米-广州南山丰景二手房成交
南山丰景 2室1厅 84.45平米
南 | 精装2021.05.1099万
高楼层(共28层) 2017年塔楼11723元/平
房屋满五年
挂牌103万成交周期33天
沙海林免费咨询
南山丰景 2室2厅 83.9平米-广州南山丰景二手房成交
南山丰景 2室2厅 83.9平米
南 | 精装2021.03.24112.5万
中楼层(共29层) 2017年塔楼13409元/平
房屋满五年
挂牌117万成交周期13天
沙海林免费咨询
南山丰景 3室2厅 117.74平米-广州南山丰景二手房成交
南山丰景 3室2厅 117.74平米
南 | 其他2021.02.27160万
高楼层(共28层) 2017年暂无数据13590元/平
房屋满五年
挂牌162万成交周期49天
沙海林免费咨询
南山丰景 3室2厅 106.28平米-广州南山丰景二手房成交
南山丰景 3室2厅 106.28平米
南 北 | 精装2021.02.20142.5万
中楼层(共28层) 2017年塔楼13408元/平
房屋满五年
挂牌145万成交周期55天
揭燕娇免费咨询
南山丰景 2室2厅 66.2平米-广州南山丰景二手房成交
南山丰景 2室2厅 66.2平米
南 | 精装2021.02.2084万
低楼层(共31层) 2017年暂无数据12689元/平
房屋满五年
挂牌85万成交周期29天
孙元乾免费咨询
南山丰景 2室1厅 84.54平米-广州南山丰景二手房成交
南山丰景 2室1厅 84.54平米
南 | 精装2021.02.07105万
高楼层(共29层) 2017年塔楼12421元/平
房屋满五年
挂牌108万成交周期9天
郭燕免费咨询
南山丰景 2室2厅 81.65平米-广州南山丰景二手房成交
南山丰景 2室2厅 81.65平米
南 北 | 简装2021.01.23103万
低楼层(共29层) 2017年板楼12615元/平
房屋满五年
挂牌108万成交周期61天
郑小妹免费咨询
南山丰景 2室2厅 63平米
南 | 其他2021.01.1884万
高楼层(共31层) 2017年暂无数据13334元/平
房屋满五年
挂牌86万成交周期2天
沙海林免费咨询
南山丰景 2室2厅 66.16平米-广州南山丰景二手房成交
南山丰景 2室2厅 66.16平米
东 南 | 精装2021.01.1881.5万
低楼层(共31层) 2017年暂无数据12319元/平
房屋满五年
挂牌88万成交周期21天
沙海林免费咨询
南山丰景 2室2厅 66.86平米-广州南山丰景二手房成交
南山丰景 2室2厅 66.86平米
南 | 精装2021.01.0483万
中楼层(共31层) 2017年暂无数据12414元/平
房屋满五年
挂牌85万成交周期13天
卢雁盈免费咨询
南山丰景 2室2厅 84.45平米-广州南山丰景二手房成交
南山丰景 2室2厅 84.45平米
南 北 | 简装2020.12.3096万
高楼层(共28层) 2017年塔楼11368元/平
房屋满五年
挂牌103万成交周期32天
周秀琼免费咨询
南山丰景 2室2厅 66.2平米-广州南山丰景二手房成交
南山丰景 2室2厅 66.2平米
南 | 其他2020.11.2682万
中楼层(共31层) 2017年暂无数据12387元/平
房屋满五年
挂牌87万成交周期53天
沙海林免费咨询
南山丰景 2室2厅 62平米
北 | 其他2020.06.1978万
低楼层(共31层) 2017年暂无数据12581元/平
挂牌78万成交周期2天
庄盛艺免费咨询

南山丰景 2室2厅 62.04平米
北 | 精装2026.01.2436.5万
中楼层(共29层) 暂无数据5884元/平
房屋满两年
挂牌40万成交周期20天
王晓明免费咨询
南山丰景 2室2厅 66.16平米-广州南山丰景二手房成交
南山丰景 2室2厅 66.16平米
南 | 简装2025.12.3038.8万
高楼层(共31层) 2017年暂无数据5865元/平
房屋满两年
挂牌44.8万成交周期10天
沙海林免费咨询
南山丰景 2室1厅 83.96平米-广州南山丰景二手房成交
南山丰景 2室1厅 83.96平米
南 | 简装2025.12.2039万
高楼层(共29层) 2017年塔楼4646元/平
房屋满五年
挂牌46.5万成交周期122天
周利利免费咨询
南山丰景 2室1厅 61.97平米-广州南山丰景二手房成交
南山丰景 2室1厅 61.97平米
北 | 精装2025.11.0538.6万
高楼层(共31层) 暂无数据6229元/平
房屋满两年
挂牌43.8万成交周期64天
陈怡琳免费咨询
南山丰景 2室2厅 62平米-广州南山丰景二手房成交
南山丰景 2室2厅 62平米
东北 | 精装2025.10.2439.3万
中楼层(共29层) 暂无数据6339元/平
挂牌45万成交周期20天
张房坤免费咨询
南山丰景 2室1厅 62.04平米-广州南山丰景二手房成交
南山丰景 2室1厅 62.04平米
北 | 简装2025.10.1335万
中楼层(共29层) 暂无数据5642元/平
房屋满两年
挂牌46万成交周期16天
王冬梅免费咨询
南山丰景 4室1厅 140.01平米-广州南山丰景二手房成交
南山丰景 4室1厅 140.01平米
南 | 精装2025.05.2693.5万
中楼层(共28层) 暂无数据6679元/平
房屋满两年
挂牌106万成交周期253天
郑江红免费咨询
南山丰景 2室1厅 66.2平米-广州南山丰景二手房成交
南山丰景 2室1厅 66.2平米
南 北 | 其他2025.04.1146.2万
低楼层(共31层) 2017年暂无数据6979元/平
挂牌48万成交周期36天
陈怡琳免费咨询
南山丰景 2室2厅 66.24平米-广州南山丰景二手房成交
南山丰景 2室2厅 66.24平米
东南 南 | 精装2025.03.2046.8万
高楼层(共29层) 暂无数据7066元/平
房屋满五年
挂牌50万成交周期68天
曹金花免费咨询
南山丰景 2室1厅 63.03平米-广州南山丰景二手房成交
南山丰景 2室1厅 63.03平米
南 | 精装2025.02.2843.8万
高楼层(共31层) 2017年暂无数据6950元/平
房屋满两年
挂牌50万成交周期4天
陈怡琳免费咨询
南山丰景 3室1厅 106.1平米-广州南山丰景二手房成交
南山丰景 3室1厅 106.1平米
南 北 | 其他2024.11.0274.5万
高楼层(共29层) 2017年暂无数据7022元/平
挂牌89万成交周期1天
徐文婷免费咨询
南山丰景 2室2厅 66.9平米-广州南山丰景二手房成交
南山丰景 2室2厅 66.9平米
南 | 精装2024.08.0846.6万
中楼层(共29层) 暂无数据6966元/平
房屋满两年
挂牌55万成交周期24天
郑江红免费咨询
南山丰景 2室1厅 66.2平米-广州南山丰景二手房成交
南山丰景 2室1厅 66.2平米
南 | 其他2024.07.0850.5万
中楼层(共31层) 2017年暂无数据7629元/平
挂牌57万成交周期4天
陈树云免费咨询
南山丰景 4室2厅 140平米
西南 | 其他2024.05.22103万
高楼层(共28层) 2017年暂无数据7358元/平
挂牌135万成交周期3天
沙海林免费咨询
南山丰景 2室2厅 66.2平米-广州南山丰景二手房成交
南山丰景 2室2厅 66.2平米
南 | 精装2024.05.0451.2万
低楼层(共31层) 2017年暂无数据7735元/平
房屋满两年
挂牌56万成交周期63天
郑江红免费咨询
南山丰景 3室2厅 117.68平米-广州南山丰景二手房成交
南山丰景 3室2厅 117.68平米
南 | 精装2024.03.2688.8万
高楼层(共28层) 暂无数据7546元/平
房屋满两年
挂牌95万成交周期21天
郑江红免费咨询
南山丰景 4室1厅 139.43平米-广州南山丰景二手房成交
南山丰景 4室1厅 139.43平米
南 | 其他2023.12.14112万
中楼层(共28层) 2017年暂无数据8033元/平
房屋满两年
挂牌125万成交周期10天
叶志辉免费咨询
南山丰景 4室2厅 140.64平米-广州南山丰景二手房成交
南山丰景 4室2厅 140.64平米
南 | 精装2023.11.23118万
中楼层(共28层) 2017年暂无数据8391元/平
房屋满两年
挂牌126万成交周期7天
唐光卓免费咨询
南山丰景 2室1厅 66.86平米-广州南山丰景二手房成交
南山丰景 2室1厅 66.86平米
南 | 精装2023.11.2060万
高楼层(共31层) 2017年暂无数据8974元/平
房屋满五年
挂牌60万成交周期2天
温伟杰免费咨询
南山丰景 2室1厅 83.96平米-广州南山丰景二手房成交
南山丰景 2室1厅 83.96平米
南 | 精装2023.05.2178万
中楼层(共29层) 2017年塔楼9291元/平
房屋满两年
挂牌85万成交周期84天
周秀琼免费咨询
南山丰景 3室2厅 103.17平米-广州南山丰景二手房成交
南山丰景 3室2厅 103.17平米
东南 | 简装2023.05.04112万
中楼层(共29层) 2017年暂无数据10856元/平
房屋满两年
挂牌115万成交周期35天
陈树云免费咨询
南山丰景 2室1厅 66平米-广州南山丰景二手房成交
南山丰景 2室1厅 66平米
南 | 简装2023.03.3063万
中楼层(共31层) 2017年暂无数据9546元/平
挂牌65万成交周期22天
陈树云免费咨询
南山丰景 2室2厅 66.9平米-广州南山丰景二手房成交
南山丰景 2室2厅 66.9平米
南 | 其他2023.03.2571万
低楼层(共29层) 暂无数据10613元/平
房屋满两年
挂牌75万成交周期26天
倪荣珊免费咨询
南山丰景 2室1厅 61.97平米-广州南山丰景二手房成交
南山丰景 2室1厅 61.97平米
北 | 简装2023.03.1162万
高楼层(共31层) 暂无数据10005元/平
挂牌63万成交周期12天
沙海林免费咨询
南山丰景 3室2厅 103.17平米-广州南山丰景二手房成交
南山丰景 3室2厅 103.17平米
南 | 精装2022.12.05114.8万
高楼层(共29层) 2017年暂无数据11128元/平
房屋满两年
挂牌115万成交周期15天
陈树云免费咨询
南山丰景 3室2厅 121.33平米-广州南山丰景二手房成交
南山丰景 3室2厅 121.33平米
南 | 精装2022.09.04151万
低楼层(共28层) 2017年暂无数据12446元/平
房屋满五年
挂牌158万成交周期175天
沙海林免费咨询
南山丰景 2室2厅 81.65平米-广州南山丰景二手房成交
南山丰景 2室2厅 81.65平米
南 北 | 简装2022.08.2895万
中楼层(共29层) 2017年板楼11636元/平
房屋满五年
挂牌100万成交周期35天
陈树云免费咨询
南山丰景 2室1厅 66.16平米-广州南山丰景二手房成交
南山丰景 2室1厅 66.16平米
南 | 精装2022.01.0184.5万
低楼层(共31层) 2017年暂无数据12773元/平
房屋满五年
挂牌88万成交周期10天
沙海林免费咨询
南山丰景 2室2厅 66.2平米-广州南山丰景二手房成交
南山丰景 2室2厅 66.2平米
南 | 精装2021.10.2090万
中楼层(共31层) 2017年暂无数据13596元/平
房屋满五年
挂牌92.5万成交周期12天
沙海林免费咨询
南山丰景 2室2厅 81.76平米-广州南山丰景二手房成交
南山丰景 2室2厅 81.76平米
南 | 精装2021.08.19101万
高楼层(共29层) 2017年塔楼12354元/平
挂牌104.5万成交周期17天
陈家熙`;
const FULI_DONGDIWAN_DATA_TEXT = `日期	单价	面积（㎡）	总价	朝向	楼层
2025.12.01	78521	117.74	924.5	南	高楼层
2025.11.24	66328	84.43	560	南 西	低楼层
2025.10.07	70629	82.12	580	西南	中楼层
2025.05.01	80815	119.78	968	西南	高楼层
2025.03.23	79173	44.46	352	东北	高楼层
2025.03.18	73457	81	595	西北	中楼层
2025.03.11	79282	116.42	923	东 东南	中楼层
2025.03.01	74225	44.46	330	西南	低楼层
2024.12.23	80656	97.7	788	东 西 西南	中楼层
2024.11.19	69889	84.42	590	北	高楼层
2024.11.13	71224	83.54	595	西北	中楼层
2024.11.05	71812	82.16	590	西南	低楼层
2024.10.29	79822	139.06	1110	东南	低楼层
2024.10.26	74500	117.45	875	东南	低楼层
2024.10.23	71352	121.09	864	西北	低楼层
2024.10.15	78625	115.74	910	西北	高楼层
2024.10.13	76059	115.7	880	西南	中楼层
2024.10.11	67784	125.4	850	东北	高楼层
2024.10.02	75922	95.23	723	南	中楼层
2024.10.01	79126	119.81	948	西南	高楼层
2024.09.02	71777	82.2	590	西	中楼层
2024.09.01	70488	82	578	南 西南	高楼层
2024.07.19	72451	81.09	587.5	西	中楼层
2024.07.14	66610	70.56	470	东南	中楼层
2024.07.02	77123	119.42	921	西南 南	低楼层
2024.06.18	68323	83.72	572	西	低楼层
2024.06.01	69734	81.74	570	西北	高楼层
2024.05.19	68231	83.54	570	北	中楼层
2024.03.12	86617	117.76	1020	东南	中楼层
2024.03.12	78544	82.12	645	西 南	中楼层
2023.12.30	86851	81.75	710	西南	高楼层
2023.12.15	83763	85.36	715	东南	低楼层
2023.12.05	89763	99.15	890	东南 西北	高楼层
2023.11.03	94048	100.8	948	西南	中楼层
2023.10.12	104001	116.42	1210.8	东南	高楼层
2023.06.19	100299	46.96	471	西	高楼层
2023.05.03	105191	80.14	843	东南 西南	高楼层
2023.03.22	105929	119.42	1265	西南	低楼层
2023.02.11	101086	121.58	1229	东北	低楼层
2023.02.10	103035	119.96	1236	东南	低楼层
2023.02.08	103244	82	846.6	东南	低楼层
2023.01.18	97115	122.33	1188	东南	高楼层
2022.12.11	96011	120.82	1160	北 东北	中楼层
2022.11.18	102977	100.8	1038	东 西	高楼层
2022.10.13	99570	120.82	1203	西北	中楼层
2022.09.27	102169	83	848	东北	高楼层
2022.08.27	112540	119.78	1348	西南	中楼层
2022.08.22	103785	119.96	1245	东南	中楼层
2022.04.28	108600	78.73	855	东	高楼层
2022.02.28	105714	44.46	470	西南	高楼层
2022.02.26	108413	122.68	1330	东南 南 西南	低楼层
2021.10.15	115108	139	1600	东南 南	高楼层
2021.10.07	102288	82.61	845	东北	中楼层
2021.08.27	113560	82.6	938	东南	高楼层
2021.07.12	104672	80.06	838	西南	低楼层
2021.05.11	105758	80.94	856	西南	中楼层
2021.05.06	106637	67.05	715	西南	中楼层
2021.02.21	94891	82.2	780	西北	高楼层
2021.01.07	99021	46.96	465	南	低楼层
2021.01.05	108781	115.83	1260	东 西 北	中楼层
2020.12.23	97225	117.46	1142	东南	低楼层
2020.11.09	94509	95.23	900	南	中楼层
2020.10.31	102934	129.21	1330	东南	中楼层
2020.10.25	80636	84.33	680	东 西北	中楼层
2020.10.06	82200	70.56	580	南	中楼层
2020.08.04	89656	116	1040	南	低楼层
2020.06.21	82349	75.29	620	西南	高楼层
2020.05.13	74405	70.56	525	东南	中楼层
2019.11.17	67115	67.05	450	西南	低楼层
2019.08.15	78655	81.75	643	西南	中楼层
2019.06.24	69405	84	583	北	中楼层
2019.05.25	71588	81.02	580	西北	高楼层
2019.05.01	69151	70.86	490	西北	高楼层
2019.04.30	76875	80	615	西南	高楼层
2019.04.05	74330	82	609.5	西南	高楼层`;
const XIAOFENGYINYUE_DATA_TEXT = `日期	单价	面积（㎡）	总价	朝向	楼层
2025.12.01	17894	100.82	180.4	南	高楼层
2025.10.26	22775	129.53	295	南 北	高楼层
2025.07.09	22858	175	400	南 北	低楼层
2025.04.20	23161	129.53	300	南	低楼层`;
const HUIYAYUAN_DATA_TEXT = `日期,单价(元/平),面积(平米),总价(万),朝向,楼层
2025.12.31,43313,94.66,410,南,低楼层(共31层)
2025.09.26,48085,113.55,546,北,低楼层(共31层)
2025.08.27,52136,118.92,620,东北,低楼层(共31层)
2025.07.24,60661,112.1,680,南,高楼层(共31层)
2025.06.21,53031,118.8,630,南,中楼层(共31层)
2025.06.22,53241,104.62,557,西北,中楼层(共31层)
2025.06.17,67083,94.66,635,南,高楼层(共31层)
2025.05.07,67822,94.66,642,东南,高楼层(共31层)
2025.05.04,58903,118.84,700,北,高楼层(共31层)
2025.03.28,55710,104.83,584,东北,低楼层(共31层)
2025.03.14,55599,104.32,580,东南,低楼层(共31层)
2024.12.29,66554,94.66,630,南,高楼层(共31层)
2024.12.23,56441,118.71,670,南 北 东北,低楼层(共31层)
2024.12.09,60735,118.94,722.4,东 南 北,高楼层(共31层)
2024.10.26,60266,118.94,716.8,南 北,高楼层(共31层)
2024.10.01,62389,111.88,698,南,中楼层(共31层)
2024.08.30,64801,104.32,676,西南,高楼层(共31层)
2024.08.11,71603,94.27,675,南,中楼层(共31层)
2024.06.23,64289,113.55,730,东北,高楼层(共31层)
2024.06.10,64675,112.1,725,南,中楼层(共31层)
2024.06.09,75846,94.27,715,南,中楼层(共31层)
2024.03.31,78112,94.48,738,南,高楼层(共31层)
2024.01.31,69716,118.84,828.5,南 北,高楼层(共31层)
2024.01.06,66051,113.55,750,东北,低楼层(共31层)
2023.11.22,78074,94.27,736,低楼层(共31层),低楼层(共31层)
2023.11.12,69001,118.84,820,东北,低楼层(共31层)
2023.10.29,78174,118.71,928,南 北,高楼层(共31层)
2023.09.06,78324,94.48,740,南,中楼层(共31层)
2023.05.17,86441,112.1,969,东南,中楼层(共31层)
2023.02.20,79874,118.94,950.1,南 北,高楼层(共31层)
2023.01.15,80041,118.94,952,北,高楼层(共31层)
2022.11.08,80441,94.48,760,南,低楼层(共31层)
2022.11.06,80179,112.1,898.8,南,中楼层(共31层)
2022.10.13,85359,94.66,808,南,中楼层(共31层)
2022.08.28,83656,118.94,995,南 北,高楼层(共31层)
2022.07.01,95138,94.6,900,南,中楼层(共31层)
2022.07.01,97346,113,东南,中楼层(共31层),1100
2022.06.25,93667,112.1,1050,南,中楼层(共31层)
2022.06.20,78379,104.62,820,东西北,中楼层(共31层)
2022.06.05,95471,94.27,900,南,中楼层(共31层)
2022.04.26,80713,118.94,960,北,低楼层(共31层)
2021.03.21,102668,94.48,970,南,高楼层(共31层)
2021.01.15,98653,94.27,930,东南,高楼层(共31层)
2020.12.20,78422,95,745,西南,低楼层(共31层)
2020.11.20,71579,95,680,南,高楼层(共31层)
2020.10.21,66221,104.5,692,北,低楼层(共31层)
2020.09.03,63076,104.32,658,东南,中楼层(共31层)
2020.08.30,63409,113.55,720,西北,高楼层(共31层)
2020.08.29,65635,118.84,780,南 北,低楼层(共31层)
2020.08.07,61652,104.62,645,东北,高楼层(共31层)
2020.08.04,67102,104.32,700,南,低楼层(共31层)
2020.08.01,63337,112.1,710,东南,低楼层(共31层)
2020.07.12,60955,94.66,577,西南,低楼层(共31层)
2020.06.08,56628,113.55,643,西北,中楼层(共31层)
2020.01.19,58098,111.88,650,南,低楼层(共31层)
2019.12.28,58908,119,南 北,高楼层(共31层)
2019.11.07,60679,104.32,633,南,低楼层(共31层)
2019.10.18,64564,94.48,610,西南,低楼层(共31层)
2019.09.24,57205,111.88,640,南,低楼层(共31层)
2019.09.01,64843,95,616,东南,中楼层(共31层)
2019.07.31,57143,105,东北,中楼层(共31层)
2019.06.29,57143,105,北,中楼层(共31层)
2019.06.21,65790,95,625,东南,中楼层(共31层)
2019.05.18,57715,105,606,东北,低楼层(共31层)
2019.05.13,62667,105,658,南,中楼层(共31层)
2019.04.12,64035,94.48,605,南,低楼层(共31层)
2019.02.18,57429,105,603,东 北,高楼层(共31层)
2018.12.21,64843,95,616,南,中楼层(共31层)
2018.11.07,65239,94.27,615,西南,中楼层(共31层)
2018.08.21,59745,118.84,710,南 北,低楼层(共31层)
2018.06.12,57236,104.83,600,东北,中楼层(共31层)`;
const TIANYU_GARDEN_DATA_TEXT = `日期,单价(元/平),面积(平米),总价(万),朝向,楼层
2026.01.18,49862,93.86,468,东南 南,中楼层(共30层)
2025.12.27,42500,112,476,东北,中楼层(共31层)
2025.12.27,42649,112.08,478,北,中楼层(共31层)
2025.10.09,50246,164.79,828,南,中楼层(共30层)
2025.07.27,50935,150.39,766,东南,中楼层(共31层)
2025.07.20,49969,112.07,560,北,高楼层(共31层)
2025.06.30,56429,90.38,510,东,中楼层(共30层)
2025.06.28,47555,109.98,523,南,低楼层(共31层)
2025.05.01,58794,77.9,458,西北,高楼层(共30层)
2025.04.30,53196,150.39,800,北,高楼层(共31层)
2025.03.22,57584,150.39,866,东南,低楼层(共31层)
2025.03.14,55920,109.98,615,北,中楼层(共31层)
2025.03.13,56520,150.39,850,南,高楼层(共31层)
2024.12.19,67435,177.95,1200,南 西,中楼层(共30层)
2024.12.16,56829,109.98,625,南,高楼层(共31层)
2024.12.08,51819,110,570,北,中楼层(共31层)
2024.11.29,53526,164.78,882,东南,中楼层(共30层)
2024.11.14,57436,176.72,1015,西,中楼层(共30层)
2024.10.27,55417,75.79,420,东南,高楼层(共30层)
2024.10.24,53995,90.38,488,西,中楼层(共30层)
2024.10.18,51373,109.98,565,北,高楼层(共31层)
2024.10.08,57426,88.81,510,南,高楼层(共30层)
2024.10.01,57512,93.86,539.8,西南,高楼层(共30层)
2024.09.16,53840,112,603,北,中楼层(共31层)
2024.08.14,57841,176,1018,西,高楼层(共30层)
2024.07.24,57185,150.39,860,南,高楼层(共31层)
2024.06.26,59822,112,670,南,高楼层(共31层)
2024.06.17,60335,75.91,458,西北,高楼层(共30层)
2024.03.27,71919,90.38,650,东,高楼层(共30层)
2024.01.31,69146,141.73,980,北,高楼层(共31层)
2023.11.06,59102,109.98,650,北,高楼层(共31层)
2023.10.29,58738,109.98,646,北,低楼层(共31层)
2023.09.23,68557,108.67,745,北,高楼层(共31层)
2023.08.21,61353,147.02,902,南,低楼层(共30层)
2023.08.08,57995,112.08,650,北,中楼层(共31层)
2023.06.22,65497,150.39,985,东南 南,中楼层(共31层)
2023.03.02,70073,142.71,1000,北,中楼层(共31层)
2023.02.18,77531,139.3,1080,南,高楼层(共31层)
2022.09.03,68489,150.39,1030,东北,中楼层(共31层)
2021.06.02,72674,141.73,1030,东北,高楼层(共31层)
2021.03.07,83426,90.38,754,西南,低楼层(共30层)
2021.02.28,72559,109.98,798,北,低楼层(共31层)
2021.02.06,71378,112.08,800,北,高楼层(共31层)
2021.01.13,57841,77.8,450,北,高楼层(共30层)
2021.01.02,59845,150.39,900,北,中楼层(共31层)
2020.12.31,61103,142.71,872,北,高楼层(共31层)
2020.12.29,73898,177.95,1315,东,中楼层(共30层)
2020.12.22,53196,150.39,800,北,低楼层(共31层)
2020.12.11,46613,150.39,701,北,低楼层(共31层)
2020.12.01,69604,177.96,1238.7,西南,中楼层(共30层)
2020.11.26,50536,150.39,760,北,低楼层(共31层)
2020.11.07,57799,109,630,南,低楼层(共31层)
2020.10.29,46504,275.25,1280,北 南,高楼层(共31层)
2020.10.13,65000,78,507,西北,高楼层(共30层)
2020.10.11,53055,147.02,780,南,高楼层(共30层)
2020.10.08,56720,109.98,623.8,北,低楼层(共31层)
2020.07.31,52778,162,855,北,中楼层(共30层)
2020.07.29,55920,109.98,615,北,高楼层(共31层)
2020.07.24,51429,161,828,东北,高楼层(共30层)
2020.07.24,57693,78,450,西北,低楼层(共30层)
2020.07.22,56374,109.98,620,北,高楼层(共31层)
2020.06.11,46546,150.39,700,东,中楼层(共31层)
2020.06.07,54546,143,780,南,中楼层(共31层)
2020.04.09,50036,139.3,697,南 北,高楼层(共31层)
2019.11.23,53572,112,600,北,中楼层(共31层)
2019.10.12,49734,150,746,东南,高楼层(共31层)
2019.09.23,45889,161,738.8,北,中楼层(共30层)
2019.09.08,56483,77.9,440,北,中楼层(共30层)
2019.03.10,54829,109.98,603,南,低楼层(共31层)
2018.12.20,59065,112.08,662,南,中楼层(共31层)
2018.09.20,58395,109,636.5,南,高楼层(共31层)
2018.04.10,52995,177,938,西,高楼层(共30层)`;
const TIANYUE_JIANGWAN_DATA_TEXT = `越秀明珠天悦江湾 3室1厅 95.61平米-广州越秀明珠天悦江湾二手房成交
越秀明珠天悦江湾 3室1厅 95.61平米
南 | 精装2026.01.14134.5万
中楼层(共23层) 塔楼14068元/平
房屋满两年
挂牌158万成交周期282天
孙亚迪免费咨询
越秀明珠天悦江湾 5室2厅 178.85平米-广州越秀明珠天悦江湾二手房成交
越秀明珠天悦江湾 5室2厅 178.85平米
南 | 精装2025.12.20345万
低楼层(共24层) 塔楼19290元/平
挂牌438万成交周期14天
钟昊峻免费咨询
越秀明珠天悦江湾 4室2厅 137.1平米-广州越秀明珠天悦江湾二手房成交
越秀明珠天悦江湾 4室2厅 137.1平米
南 | 毛坯2025.11.21230万
高楼层(共25层) 塔楼16777元/平
挂牌267万成交周期402天
梁铭健免费咨询
越秀明珠天悦江湾 3室2厅 90.85平米-广州越秀明珠天悦江湾二手房成交
越秀明珠天悦江湾 3室2厅 90.85平米
东北 | 精装2025.11.19138万
高楼层(共23层) 塔楼15190元/平
挂牌155万成交周期241天
崔夏连免费咨询
越秀明珠天悦江湾 3室1厅 93.27平米-广州越秀明珠天悦江湾二手房成交
越秀明珠天悦江湾 3室1厅 93.27平米
南 | 精装2025.11.01152.8万
高楼层(共29层) 塔楼16383元/平
房屋满两年
挂牌168万成交周期104天
卿伟民免费咨询
越秀明珠天悦江湾 5室2厅 123.89平米-广州越秀明珠天悦江湾二手房成交
越秀明珠天悦江湾 5室2厅 123.89平米
西南 | 精装2025.10.28228万
高楼层(共23层) 塔楼18404元/平
房屋满两年
挂牌270万成交周期249天
陶瑞凌免费咨询
越秀明珠天悦江湾 4室2厅 136.45平米-广州越秀明珠天悦江湾二手房成交
越秀明珠天悦江湾 4室2厅 136.45平米
南 | 精装2025.10.22248万
中楼层(共24层) 塔楼18176元/平
房屋满两年
挂牌278万成交周期40天
王磊免费咨询
越秀明珠天悦江湾 3室2厅 90平米-广州越秀明珠天悦江湾二手房成交
越秀明珠天悦江湾 3室2厅 90平米
东 北 | 简装2025.10.19135万
高楼层(共24层) 塔楼15000元/平
房屋满两年
挂牌160万成交周期307天
郑珊珊免费咨询
越秀明珠天悦江湾 3室2厅 98.93平米-广州越秀明珠天悦江湾二手房成交
越秀明珠天悦江湾 3室2厅 98.93平米
东北 | 精装2025.09.30149万
中楼层(共25层) 塔楼15062元/平
房屋满两年
挂牌165万成交周期222天
王磊免费咨询
越秀明珠天悦江湾 4室2厅 178.89平米-广州越秀明珠天悦江湾二手房成交
越秀明珠天悦江湾 4室2厅 178.89平米
南 | 精装2025.09.22438万
高楼层(共24层) 塔楼24485元/平
房屋满两年
挂牌450万成交周期65天
杨志军免费咨询
越秀明珠天悦江湾 3室2厅 98.78平米-广州越秀明珠天悦江湾二手房成交
越秀明珠天悦江湾 3室2厅 98.78平米
南 | 精装2025.07.12170万
中楼层(共29层) 塔楼17210元/平
房屋满两年
挂牌200万成交周期85天
陈伟亮免费咨询
越秀明珠天悦江湾 3室2厅 80.3平米-广州越秀明珠天悦江湾二手房成交
越秀明珠天悦江湾 3室2厅 80.3平米
南 北 | 精装2025.07.06129万
低楼层(共29层) 塔楼16065元/平
挂牌140万成交周期122天
李凯免费咨询
越秀明珠天悦江湾 3室2厅 79.83平米-广州越秀明珠天悦江湾二手房成交
越秀明珠天悦江湾 3室2厅 79.83平米
北 | 精装2025.07.01125万
中楼层(共29层) 塔楼15659元/平
挂牌135万成交周期79天
罗远明免费咨询
越秀明珠天悦江湾 5室2厅 139.45平米-广州越秀明珠天悦江湾二手房成交
越秀明珠天悦江湾 5室2厅 139.45平米
南 | 毛坯2025.04.02448万
中楼层(共12层) 塔楼32127元/平
房屋满两年
挂牌490万成交周期161天
王磊免费咨询
越秀明珠天悦江湾 3室2厅 92.96平米-广州越秀明珠天悦江湾二手房成交
越秀明珠天悦江湾 3室2厅 92.96平米
西南 | 精装2025.03.05179.9万
低楼层(共29层) 塔楼19351元/平
挂牌198万成交周期177天
王磊免费咨询`;
const DIECUIFENG_DATA_TEXT = `叠翠峰 3室2厅 106.97平米
东南 | 精装2026.01.20182万
低楼层(共16层) 2018年塔楼17015元/平
房屋满五年近地铁
挂牌207万成交周期423天
徐湘免费咨询
叠翠峰 2室2厅 73.55平米-广州叠翠峰二手房成交
叠翠峰 2室2厅 73.55平米
北 | 其他2026.01.1984.1万
中楼层(共31层) 2017年板楼11434元/平
房屋满两年近地铁
挂牌95万成交周期508天
朱彭鑫免费咨询
叠翠峰 3室1厅 107.97平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 107.97平米
南 | 精装2026.01.15151万
中楼层(共32层) 2017年塔楼13986元/平
房屋满五年近地铁
挂牌169万成交周期589天
陈丹玲免费咨询
叠翠峰 3室1厅 80.98平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 80.98平米
北 | 精装2025.12.26113万
中楼层(共17层) 2017年板楼13955元/平
房屋满五年近地铁
挂牌125万成交周期39天
詹若珊免费咨询
叠翠峰 3室1厅 89.84平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 89.84平米
北 | 其他2025.12.14148万
中楼层(共17层) 2018年塔楼16474元/平
房屋满五年近地铁
挂牌165万成交周期664天
高锡泉免费咨询
叠翠峰 3室1厅 110.31平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 110.31平米
南 | 精装2025.12.12130万
低楼层(共31层) 2017年板楼11785元/平
房屋满五年近地铁
挂牌142万成交周期303天
崔夏连免费咨询
叠翠峰 3室2厅 69.21平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 69.21平米
东北 | 精装2025.12.1290万
中楼层(共25层) 2018年板塔结合13004元/平
房屋满五年近地铁
挂牌115万成交周期32天
房敏红免费咨询
叠翠峰 2室2厅 69.25平米-广州叠翠峰二手房成交
叠翠峰 2室2厅 69.25平米
北 | 精装2025.12.0895万
中楼层(共25层) 2018年板塔结合13719元/平
房屋满五年近地铁
挂牌100万成交周期20天
季东阳免费咨询
叠翠峰 3室2厅 97.75平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 97.75平米
南 | 简装2025.12.07143.8万
高楼层(共26层) 2018年板楼14711元/平
近地铁
挂牌168万成交周期13天
邓少龙免费咨询
叠翠峰 3室2厅 107.97平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 107.97平米
西南 | 精装2025.12.02163万
低楼层(共32层) 2017年塔楼15097元/平
房屋满五年近地铁
挂牌180万成交周期73天
杨冰华免费咨询
叠翠峰 3室2厅 111.3平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 111.3平米
东南 南 西南 | 精装2025.11.29153万
中楼层(共31层) 2017年板楼13747元/平
房屋满五年近地铁
挂牌170万成交周期185天
莫灿林免费咨询
叠翠峰 3室2厅 97.75平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 97.75平米
南 | 精装2025.11.22138万
高楼层(共26层) 2018年板楼14118元/平
房屋满两年近地铁
挂牌148万成交周期322天
宁博免费咨询
叠翠峰 2室1厅 71.28平米-广州叠翠峰二手房成交
叠翠峰 2室1厅 71.28平米
北 | 精装2025.11.17105.8万
高楼层(共32层) 2017年塔楼14843元/平
房屋满两年近地铁
挂牌112万成交周期27天
詹若珊免费咨询
叠翠峰 3室2厅 89.2平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 89.2平米
北 | 精装2025.11.15113万
中楼层(共31层) 2017年板楼12669元/平
房屋满五年近地铁
挂牌122万成交周期279天
崔夏连免费咨询
叠翠峰 3室2厅 110.43平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 110.43平米
南 | 精装2025.11.10155万
中楼层(共31层) 2017年板楼14037元/平
房屋满两年近地铁
挂牌178万成交周期62天
黎秋仪免费咨询
叠翠峰 3室2厅 108.45平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 108.45平米
南 | 精装2025.11.02159.8万
中楼层(共32层) 2017年塔楼14735元/平
房屋满五年
挂牌176万成交周期144天
周燕免费咨询
叠翠峰 4室1厅 133.9平米-广州叠翠峰二手房成交
叠翠峰 4室1厅 133.9平米
东南 南 | 精装2025.11.01302万
中楼层(共17层) 2018年塔楼22555元/平
房屋满五年近地铁
挂牌389万成交周期234天
郭来明免费咨询
叠翠峰 3室2厅 77.81平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 77.81平米
南 | 精装2025.10.25120万
高楼层(共17层) 2017年板楼15423元/平
房屋满五年近地铁
挂牌125万成交周期185天
郑晖凡免费咨询
叠翠峰 2室1厅 69.25平米-广州叠翠峰二手房成交
叠翠峰 2室1厅 69.25平米
北 | 精装2025.10.25105万
中楼层(共25层) 2018年板塔结合15163元/平
房屋满五年近地铁
挂牌119万成交周期108天
郑基免费咨询
叠翠峰 3室1厅 80.71平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 80.71平米
西北 | 精装2025.10.24105万
中楼层(共17层) 2017年板楼13010元/平
房屋满五年近地铁
挂牌121万成交周期92天
詹若珊免费咨询
叠翠峰 3室2厅 111.33平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 111.33平米
东南 | 精装2025.10.12155万
中楼层(共31层) 2017年板楼13923元/平
房屋满五年近地铁
挂牌185万成交周期190天
林国栋免费咨询
叠翠峰 3室2厅 66.84平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 66.84平米
北 | 精装2025.10.0793万
高楼层(共23层) 2017年板楼13914元/平
房屋满五年近地铁
挂牌98万成交周期40天
刘小兰免费咨询
叠翠峰 3室2厅 86.61平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 86.61平米
南 | 精装2025.10.01120万
低楼层(共22层) 2017年板楼13856元/平
房屋满五年近地铁
挂牌135万成交周期1192天
林家兴免费咨询
叠翠峰 3室2厅 96.75平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 96.75平米
东南 | 精装2025.09.20176.8万
低楼层(共25层) 2018年板塔结合18274元/平
房屋满五年近地铁
挂牌198万成交周期49天
陈佳宜免费咨询
叠翠峰 3室2厅 80.98平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 80.98平米
北 | 简装2025.09.14105万
中楼层(共17层) 2017年板楼12967元/平
房屋满五年近地铁
挂牌129万成交周期41天
詹若珊免费咨询
叠翠峰 3室1厅 104.45平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 104.45平米
东南 | 其他2025.09.14200万
中楼层(共26层) 2018年塔楼19148元/平
房屋满两年近地铁
挂牌220万成交周期23天
林少棕免费咨询
叠翠峰 2室1厅 71.39平米-广州叠翠峰二手房成交
叠翠峰 2室1厅 71.39平米
北 | 精装2025.09.13107万
中楼层(共32层) 2017年塔楼14989元/平
房屋满五年
挂牌110万成交周期19天
钱海燕免费咨询
叠翠峰 3室1厅 89.29平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 89.29平米
南 西南 | 简装2025.09.08134.8万
高楼层(共31层) 2017年塔楼15097元/平
房屋满五年
挂牌140万成交周期4天
田源港免费咨询
叠翠峰 3室2厅 86.16平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 86.16平米
北 | 精装2025.08.27113.6万
低楼层(共22层) 2017年板楼13179元/平
房屋满五年近地铁
挂牌129万成交周期463天
程梅免费咨询
叠翠峰 3室2厅 86.56平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 86.56平米
北 东北 | 精装2025.08.26100万
低楼层(共11层) 2017年塔楼11553元/平
房屋满五年
挂牌105万成交周期26天
王志强免费咨询
叠翠峰 3室2厅 87.38平米
北 | 简装2025.08.21118万
中楼层(共22层) 2017年塔楼13505元/平
房屋满五年近地铁
挂牌128万成交周期241天
高锡泉免费咨询
叠翠峰 3室2厅 103.62平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 103.62平米
东南 | 精装2025.08.17205万
高楼层(共17层) 2018年板塔结合19784元/平
房屋满五年近地铁
挂牌235万成交周期382天
林国栋免费咨询
叠翠峰 3室2厅 89.29平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 89.29平米
西南 南 | 简装2025.07.27130万
低楼层(共31层) 2017年塔楼14560元/平
房屋满五年
挂牌145万成交周期7天
林少棕免费咨询
叠翠峰 3室2厅 95.72平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 95.72平米
南 | 精装2025.07.18163.2万
中楼层(共22层) 2017年板楼17050元/平
房屋满五年近地铁
挂牌178万成交周期139天
郑晖凡免费咨询
叠翠峰 3室2厅 86.5平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 86.5平米
西北 | 其他2025.07.13128.8万
中楼层(共11层) 2017年塔楼14891元/平
房屋满五年近地铁
挂牌142万成交周期344天
詹若珊免费咨询
叠翠峰 2室1厅 72平米-广州叠翠峰二手房成交
叠翠峰 2室1厅 72平米
南 北 | 精装2025.07.13105万
高楼层(共31层) 2017年塔楼14584元/平
房屋满五年
挂牌105万成交周期11天
詹若珊免费咨询
叠翠峰 3室1厅 89.29平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 89.29平米
南 | 精装2025.07.12132万
中楼层(共31层) 2017年塔楼14784元/平
房屋满五年
挂牌152万成交周期243天
陈学聪免费咨询
叠翠峰 3室2厅 97.54平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 97.54平米
南 | 精装2025.07.10185万
中楼层(共26层) 2018年塔楼18967元/平
房屋满五年近地铁
挂牌228万成交周期748天
詹若珊免费咨询
叠翠峰 3室2厅 89.29平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 89.29平米
南 | 精装2025.07.06133.6万
中楼层(共31层) 2017年塔楼14963元/平
房屋满五年
挂牌148万成交周期299天
申雪萍免费咨询
叠翠峰 3室1厅 106.43平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 106.43平米
东南 南 | 精装2025.06.21249.8万
中楼层(共17层) 2018年塔楼23471元/平
房屋满两年近地铁
挂牌290万成交周期101天
莫灿林免费咨询
叠翠峰 3室2厅 109.11平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 109.11平米
东南 | 精装2025.06.19200万
高楼层(共24层) 2017年塔楼18331元/平
房屋满两年
挂牌225万成交周期93天
李佳音免费咨询
叠翠峰 3室2厅 97.07平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 97.07平米
南 | 精装2025.05.18165万
高楼层(共22层) 2017年塔楼16999元/平
房屋满五年近地铁
挂牌183万成交周期613天
云乾免费咨询
叠翠峰 3室2厅 86.56平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 86.56平米
东北 | 精装2025.05.18125万
中楼层(共11层) 2017年塔楼14441元/平
挂牌137万成交周期65天
黎秋仪免费咨询
叠翠峰 3室2厅 96.82平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 96.82平米
东南 南 | 简装2025.05.13188万
低楼层(共26层) 2018年板楼19418元/平
房屋满五年近地铁
挂牌210万成交周期428天
曾伟平免费咨询
叠翠峰 3室2厅 95.63平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 95.63平米
南 | 精装2025.05.12166万
中楼层(共23层) 2017年板楼17359元/平
房屋满五年近地铁
挂牌188万成交周期1011天
林国栋免费咨询
叠翠峰 3室1厅 89.03平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 89.03平米
南 | 精装2025.05.10151.6万
高楼层(共32层) 2017年塔楼17028元/平
房屋满五年
挂牌170万成交周期293天
林少棕免费咨询
叠翠峰 3室2厅 108.56平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 108.56平米
南 | 精装2025.04.23223.9万
高楼层(共31层) 2017年塔楼20625元/平
房屋满五年
挂牌240万成交周期126天
林柳春免费咨询
叠翠峰 2室1厅 72.87平米-广州叠翠峰二手房成交
叠翠峰 2室1厅 72.87平米
北 | 其他2025.04.19105万
低楼层(共31层) 2017年板楼14410元/平
房屋满五年近地铁
挂牌120万成交周期50天
钱海燕免费咨询
叠翠峰 3室2厅 89.97平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 89.97平米
东北 | 精装2025.04.07158万
中楼层(共32层) 2017年塔楼17562元/平
房屋满五年近地铁
挂牌180万成交周期86天
林智博免费咨询
叠翠峰 3室1厅 97.07平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 97.07平米
南 | 精装2025.03.23163.5万
中楼层(共22层) 2017年塔楼16844元/平
房屋满五年近地铁
挂牌180万成交周期140天
梅健业免费咨询
叠翠峰 2室1厅 71.67平米-广州叠翠峰二手房成交
叠翠峰 2室1厅 71.67平米
北 | 精装2025.03.18102万
低楼层(共31层) 2017年塔楼14232元/平
房屋满五年
挂牌105万成交周期15天
申雪萍免费咨询
叠翠峰 2室1厅 71.28平米-广州叠翠峰二手房成交
叠翠峰 2室1厅 71.28平米
北 | 其他2025.03.15109万
中楼层(共32层) 2017年塔楼15292元/平
房屋满五年近地铁
挂牌125万成交周期528天
熊朝辉免费咨询
叠翠峰 3室1厅 90.1平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 90.1平米
东北 | 精装2025.03.14138万
低楼层(共32层) 2017年塔楼15317元/平
房屋满五年
挂牌145万成交周期21天
陈含嫦免费咨询
叠翠峰 3室2厅 77.81平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 77.81平米
南 | 精装2025.03.10138万
中楼层(共17层) 2017年板楼17736元/平
房屋满五年近地铁
挂牌165万成交周期1215天
熊朝辉免费咨询
叠翠峰 2室2厅 72.87平米-广州叠翠峰二手房成交
叠翠峰 2室2厅 72.87平米
东北 | 精装2025.02.18103.8万
高楼层(共31层) 2017年板楼14245元/平
房屋满五年近地铁
挂牌118万成交周期168天
刘小兰免费咨询
叠翠峰 3室2厅 108.79平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 108.79平米
南 | 其他2025.02.17211.8万
高楼层(共31层) 2017年塔楼19469元/平
房屋满两年
挂牌238万成交周期100天
申雪萍免费咨询
叠翠峰 3室2厅 80.71平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 80.71平米
东北 | 简装2025.02.16120.8万
中楼层(共17层) 2017年板楼14968元/平
房屋满五年近地铁
挂牌130万成交周期76天
田源港免费咨询
叠翠峰 3室2厅 90.1平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 90.1平米
北 | 精装2025.02.16141.9万
低楼层(共32层) 2017年塔楼15750元/平
房屋满五年
挂牌160万成交周期554天
陈学聪免费咨询
叠翠峰 2室2厅 71.28平米
北 | 其他2025.02.15102.5万
高楼层(共32层) 2017年塔楼14380元/平
房屋满五年近地铁
挂牌115万成交周期24天
詹若珊免费咨询
叠翠峰 3室2厅 80.71平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 80.71平米
北 | 简装2025.02.15135万
高楼层(共17层) 2017年板楼16727元/平
房屋满五年近地铁
挂牌153万成交周期133天
林少棕免费咨询
叠翠峰 3室1厅 110平米
东 南 | 简装2025.02.15208.8万
中楼层(共31层) 2017年板楼18982元/平
房屋满两年近地铁
挂牌238万成交周期157天
曾文君免费咨询
叠翠峰 3室2厅 108.3平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 108.3平米
西南 | 其他2025.02.11210万
高楼层(共32层) 2017年塔楼19391元/平
房屋满五年近地铁
挂牌240万成交周期92天
曾伟平免费咨询
叠翠峰 2室1厅 72.87平米-广州叠翠峰二手房成交
叠翠峰 2室1厅 72.87平米
东 东北 | 精装2025.02.09102.9万
低楼层(共31层) 2017年板楼14122元/平
房屋满五年近地铁
挂牌107万成交周期97天
梁瀚源免费咨询
叠翠峰 2室2厅 71.28平米-广州叠翠峰二手房成交
叠翠峰 2室2厅 71.28平米
北 | 精装2025.02.07108万
中楼层(共32层) 2017年塔楼15152元/平
房屋满两年近地铁
挂牌115万成交周期187天
刘煜山免费咨询
叠翠峰 3室2厅 96.74平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 96.74平米
南 | 其他2025.01.08245万
高楼层(共25层) 2018年板塔结合25326元/平
房屋满两年近地铁
挂牌280万成交周期54天
田源港免费咨询
叠翠峰 3室1厅 106.9平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 106.9平米
东南 | 精装2025.01.05263.7万
中楼层(共16层) 2018年塔楼24667元/平
房屋满两年近地铁
挂牌288万成交周期23天
詹若珊免费咨询
叠翠峰 3室2厅 89.27平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 89.27平米
东北 | 精装2024.12.22169万
中楼层(共16层) 2018年塔楼18932元/平
房屋满两年近地铁
挂牌186万成交周期234天
崔夏连免费咨询
叠翠峰 5室2厅 181.75平米-广州叠翠峰二手房成交
叠翠峰 5室2厅 181.75平米
东 东南 | 毛坯2024.12.21730万
低楼层(共3层) 暂无数据40166元/平
近地铁
挂牌900万成交周期116天
詹若珊免费咨询
叠翠峰 3室1厅 90.48平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 90.48平米
东北 | 精装2024.12.20150万
中楼层(共31层) 2017年塔楼16579元/平
房屋满五年
挂牌185万成交周期21天
杨冰华免费咨询
叠翠峰 2室1厅 69.25平米-广州叠翠峰二手房成交
叠翠峰 2室1厅 69.25平米
西北 | 精装2024.12.10119.8万
中楼层(共25层) 2018年板塔结合17300元/平
房屋满两年近地铁
挂牌135万成交周期100天
田源港免费咨询
叠翠峰 3室2厅 89.29平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 89.29平米
南 | 其他2024.12.07172.7万
中楼层(共31层) 2017年塔楼19340元/平
房屋满五年
挂牌190万成交周期24天
黄智明免费咨询
叠翠峰 3室2厅 103.95平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 103.95平米
南 | 精装2024.12.06228万
中楼层(共17层) 2017年板楼21934元/平
房屋满五年近地铁
挂牌235万成交周期30天
田源港免费咨询
叠翠峰 3室2厅 89.97平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 89.97平米
东北 | 精装2024.11.24129万
低楼层(共32层) 2017年塔楼14339元/平
房屋满五年近地铁
挂牌143万成交周期1057天
林少棕免费咨询
叠翠峰 3室2厅 69.25平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 69.25平米
西北 | 精装2024.11.20117.6万
低楼层(共25层) 2018年板塔结合16982元/平
房屋满两年近地铁
挂牌129万成交周期244天
陈湧东免费咨询
叠翠峰 3室2厅 80.71平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 80.71平米
北 | 精装2024.11.17146万
中楼层(共17层) 2017年板楼18090元/平
房屋满五年近地铁
挂牌170万成交周期74天
朱娟免费咨询
叠翠峰 3室1厅 87.95平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 87.95平米
南 | 其他2024.11.16168万
中楼层(共22层) 2018年塔楼19102元/平
房屋满五年近地铁
挂牌176万成交周期67天
马海燕免费咨询
叠翠峰 3室2厅 81.81平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 81.81平米
北 | 精装2024.11.02129万
高楼层(共17层) 2017年板楼15769元/平
房屋满五年近地铁
挂牌136万成交周期153天
朱娟免费咨询
叠翠峰 3室2厅 86.08平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 86.08平米
北 | 简装2024.10.31154万
中楼层(共23层) 2017年板楼17891元/平
房屋满两年近地铁
挂牌169万成交周期229天
林国栋免费咨询
叠翠峰 3室2厅 80.98平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 80.98平米
北 | 精装2024.10.26123万
中楼层(共17层) 2017年板楼15189元/平
房屋满五年近地铁
挂牌158万成交周期87天
林少棕免费咨询
叠翠峰 2室2厅 72.82平米-广州叠翠峰二手房成交
叠翠峰 2室2厅 72.82平米
北 | 精装2024.10.26116万
低楼层(共31层) 2017年板楼15930元/平
房屋满五年近地铁
挂牌126万成交周期551天
崔夏连免费咨询
叠翠峰 3室2厅 84.89平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 84.89平米
北 | 精装2024.10.25126万
低楼层(共17层) 2018年板塔结合14843元/平
房屋满两年近地铁
挂牌138万成交周期23天
詹若珊免费咨询
叠翠峰 3室2厅 85.39平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 85.39平米
北 | 精装2024.10.21155万
中楼层(共26层) 2018年塔楼18153元/平
房屋满两年近地铁
挂牌165万成交周期157天
陈淑贞免费咨询
叠翠峰 3室2厅 86.16平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 86.16平米
北 东北 | 精装2024.10.12162万
高楼层(共22层) 2017年板楼18803元/平
房屋满两年近地铁
挂牌168万成交周期133天
黄灿坚免费咨询
叠翠峰 3室1厅 70.02平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 70.02平米
东北 | 精装2024.10.06110万
低楼层(共22层) 2017年塔楼15709元/平
房屋满五年近地铁
挂牌120万成交周期414天
林少棕免费咨询
叠翠峰 2室1厅 71.28平米-广州叠翠峰二手房成交
叠翠峰 2室1厅 71.28平米
北 | 其他2024.09.28120万
中楼层(共32层) 2017年塔楼16836元/平
近地铁
挂牌150万成交周期1天
詹若珊免费咨询
叠翠峰 3室2厅 97.75平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 97.75平米
南 北 | 精装2024.09.08181.8万
低楼层(共26层) 2018年板楼18599元/平
房屋满两年近地铁
挂牌225万成交周期335天
詹若珊免费咨询
叠翠峰 3室2厅 90.48平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 90.48平米
北 | 精装2024.08.25161.5万
高楼层(共31层) 2017年塔楼17850元/平
房屋满两年
挂牌180万成交周期294天
谢丽君免费咨询
叠翠峰 3室1厅 107平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 107平米
东南 南 | 其他2024.08.10305万
中楼层(共16层) 2018年塔楼28505元/平
近地铁
挂牌330万成交周期3天
谢云峰免费咨询
叠翠峰 3室2厅 96.23平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 96.23平米
南 | 其他2024.08.05190万
低楼层(共26层) 2018年塔楼19745元/平
房屋满两年近地铁
挂牌205万成交周期41天
詹若珊免费咨询
叠翠峰 3室1厅 109.11平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 109.11平米
东南 | 精装2024.08.04240万
中楼层(共24层) 2017年塔楼21997元/平
房屋满五年
挂牌275万成交周期375天
岑丽花免费咨询
叠翠峰 3室2厅 85.57平米
东 南 北 | 简装2024.08.04169.2万
高楼层(共17层) 2018年板塔结合19774元/平
房屋满两年近地铁
挂牌182万成交周期43天
赖敏芳免费咨询
叠翠峰 2室1厅 70.02平米-广州叠翠峰二手房成交
叠翠峰 2室1厅 70.02平米
南 北 | 简装2024.07.23115万
低楼层(共22层) 2017年塔楼16424元/平
房屋满五年近地铁
挂牌120万成交周期157天
季东阳免费咨询
叠翠峰 3室2厅 88.4平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 88.4平米
西南 | 精装2024.07.17156万
低楼层(共26层) 2018年板楼17648元/平
房屋满两年近地铁
挂牌176万成交周期87天
崔夏连免费咨询
叠翠峰 3室2厅 79.42平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 79.42平米
东南 | 精装2024.07.06153万
低楼层(共17层) 2017年板楼19265元/平
房屋满两年近地铁
挂牌168万成交周期113天
詹若珊免费咨询
叠翠峰 2室2厅 73.55平米-广州叠翠峰二手房成交
叠翠峰 2室2厅 73.55平米
北 | 精装2024.06.24136万
低楼层(共31层) 2017年板楼18491元/平
房屋满五年近地铁
挂牌155万成交周期59天
詹若珊免费咨询
叠翠峰 3室1厅 108.56平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 108.56平米
南 | 精装2024.06.23225万
中楼层(共31层) 2017年塔楼20726元/平
房屋满五年
挂牌240万成交周期490天
周燕免费咨询
叠翠峰 3室1厅 107.97平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 107.97平米
南 | 精装2024.06.22232万
中楼层(共32层) 2017年塔楼21488元/平
房屋满五年近地铁
挂牌250万成交周期8天
黄景林免费咨询
叠翠峰 3室1厅 90.48平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 90.48平米
北 | 精装2024.06.15166万
中楼层(共31层) 2017年塔楼18347元/平
房屋满两年
挂牌185万成交周期295天
许丽英免费咨询
叠翠峰 3室2厅 90.48平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 90.48平米
东北 | 精装2024.06.12170万
中楼层(共31层) 2017年塔楼18789元/平
房屋满五年
挂牌187万成交周期101天
崔夏连免费咨询
叠翠峰 3室2厅 107.29平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 107.29平米
南 | 精装2024.06.09278万
中楼层(共17层) 2018年塔楼25912元/平
房屋满两年近地铁
挂牌285万成交周期77天
黎秋仪免费咨询
叠翠峰 3室2厅 103.95平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 103.95平米
南 | 精装2024.06.05256万
中楼层(共17层) 2017年板楼24628元/平
房屋满两年近地铁
挂牌270万成交周期284天
陈湧东免费咨询
叠翠峰 3室1厅 80平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 80平米
南 | 精装2024.05.31187万
中楼层(共17层) 2017年板楼23375元/平
房屋满两年近地铁
挂牌199万成交周期597天
季东阳免费咨询
叠翠峰 2室1厅 73.55平米-广州叠翠峰二手房成交
叠翠峰 2室1厅 73.55平米
北 | 精装2024.05.27138万
低楼层(共31层) 2017年板楼18763元/平
房屋满五年近地铁
挂牌145万成交周期320天
叶绍俊免费咨询
叠翠峰 3室2厅 86.16平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 86.16平米
南 北 | 精装2024.05.11162万
低楼层(共22层) 2017年板楼18803元/平
房屋满两年近地铁
挂牌178.8万成交周期75天
张杰免费咨询
叠翠峰 3室2厅 108.12平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 108.12平米
东南 | 精装2024.05.06236万
低楼层(共32层) 2017年塔楼21828元/平
房屋满五年
挂牌245万成交周期73天
梁嘉仪免费咨询
叠翠峰 3室2厅 108.56平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 108.56平米
西南 | 其他2024.04.20229万
高楼层(共31层) 2017年塔楼21095元/平
房屋满五年
挂牌258万成交周期231天
崔夏连免费咨询
叠翠峰 3室1厅 108.12平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 108.12平米
南 | 精装2024.04.06231万
中楼层(共32层) 2017年塔楼21366元/平
房屋满五年
挂牌250万成交周期379天
詹若珊免费咨询
叠翠峰 3室1厅 109.11平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 109.11平米
东南 | 精装2024.03.21237万
低楼层(共24层) 2017年塔楼21722元/平
房屋满五年
挂牌250万成交周期133天
郑基免费咨询
叠翠峰 3室2厅 89.27平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 89.27平米
东北 | 精装2024.03.16210万
中楼层(共16层) 2018年塔楼23525元/平
房屋满两年近地铁
挂牌230万成交周期547天
郑基免费咨询
叠翠峰 3室1厅 108.79平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 108.79平米
南 | 精装2024.03.02240万
低楼层(共31层) 2017年塔楼22061元/平
房屋满五年
挂牌248万成交周期528天
钱海燕免费咨询
叠翠峰 3室2厅 89.03平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 89.03平米
南 | 精装2024.02.24201万
中楼层(共32层) 2017年塔楼22577元/平
房屋满五年
挂牌215万成交周期204天
张伟浩免费咨询
叠翠峰 3室1厅 109.11平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 109.11平米
南 | 精装2024.02.15263.6万
高楼层(共24层) 2017年塔楼24160元/平
房屋满五年
挂牌285万成交周期79天
詹若珊免费咨询
叠翠峰 3室1厅 109.11平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 109.11平米
东南 南 | 精装2024.01.22218万
低楼层(共24层) 2017年塔楼19980元/平
房屋满五年
挂牌255万成交周期87天
麦东华免费咨询
叠翠峰 3室1厅 108.12平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 108.12平米
东南 | 精装2024.01.08249.8万
中楼层(共32层) 2017年塔楼23104元/平
房屋满五年
挂牌268万成交周期89天
张伟浩免费咨询
叠翠峰 3室2厅 108.56平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 108.56平米
南 | 精装2024.01.04239万
高楼层(共31层) 2017年塔楼22016元/平
房屋满五年
挂牌252万成交周期9天
马言博免费咨询
叠翠峰 2室1厅 69.22平米-广州叠翠峰二手房成交
叠翠峰 2室1厅 69.22平米
北 | 精装2023.12.28140万
高楼层(共26层) 2018年板楼20226元/平
房屋满两年近地铁
挂牌158万成交周期93天
钱海燕免费咨询
叠翠峰 3室2厅 108.12平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 108.12平米
南 | 精装2023.12.14250万
中楼层(共32层) 2017年塔楼23123元/平
房屋满两年
挂牌260万成交周期208天
林少棕免费咨询
叠翠峰 3室2厅 86.08平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 86.08平米
北 | 精装2023.12.13190万
高楼层(共23层) 2017年板楼22073元/平
房屋满两年近地铁
挂牌203万成交周期125天
林智博免费咨询
叠翠峰 3室2厅 107.19平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 107.19平米
东 东南 南 | 简装2023.12.13245万
低楼层(共17层) 2018年塔楼22857元/平
房屋满两年近地铁
挂牌270万成交周期95天
姚韩凯免费咨询
叠翠峰 3室2厅 97.73平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 97.73平米
南 | 精装2023.12.10233万
高楼层(共17层) 2017年板楼23842元/平
房屋满两年近地铁
挂牌250万成交周期54天
叠翠峰 2室1厅 71.28平米
东北 | 精装2023.12.07150万
高楼层(共32层) 2017年塔楼21044元/平
房屋满两年近地铁
挂牌169万成交周期149天
栗本信免费咨询
叠翠峰 3室2厅 97平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 97平米
南 | 精装2023.12.02207.5万
高楼层(共23层) 2017年板楼21392元/平
房屋满两年近地铁
挂牌234万成交周期455天
曾志辉免费咨询
叠翠峰 3室2厅 96.82平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 96.82平米
南 | 精装2023.12.01260万
中楼层(共26层) 2018年板楼26854元/平
房屋满两年近地铁
挂牌270万成交周期36天
邹采玲免费咨询
叠翠峰 3室2厅 108.12平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 108.12平米
南 | 精装2023.11.30249万
中楼层(共32层) 2017年塔楼23030元/平
房屋满五年
挂牌255万成交周期24天
刘陆海免费咨询
叠翠峰 3室2厅 108平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 108平米
南 | 精装2023.11.27248.5万
中楼层(共32层) 2017年塔楼23010元/平
房屋满两年近地铁
挂牌250万成交周期859天
龚飞飞免费咨询
叠翠峰 3室1厅 104.19平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 104.19平米
东南 南 | 精装2023.11.26268万
中楼层(共11层) 2017年塔楼25723元/平
房屋满两年
挂牌278万成交周期96天
崔夏连免费咨询
叠翠峰 3室2厅 97平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 97平米
南 | 精装2023.11.08239.8万
低楼层(共25层) 2018年板塔结合24722元/平
房屋满两年近地铁
挂牌245万成交周期17天
叶海燕免费咨询
叠翠峰 3室1厅 89.84平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 89.84平米
东北 | 精装2023.11.07210万
中楼层(共17层) 2018年塔楼23375元/平
房屋满两年近地铁
挂牌218万成交周期208天
朱娟免费咨询
叠翠峰 2室1厅 71.67平米-广州叠翠峰二手房成交
叠翠峰 2室1厅 71.67平米
北 | 简装2023.11.04168万
高楼层(共31层) 2017年塔楼23441元/平
房屋满五年
挂牌173万成交周期54天
崔夏连免费咨询
叠翠峰 3室2厅 97.54平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 97.54平米
南 | 其他2023.11.03239万
低楼层(共26层) 2018年塔楼24503元/平
房屋满两年近地铁
挂牌268万成交周期473天
梁嘉仪免费咨询
叠翠峰 3室2厅 86.88平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 86.88平米
东 | 精装2023.10.29203万
高楼层(共17层) 2018年板塔结合23366元/平
房屋满两年近地铁
挂牌215万成交周期568天
郑基免费咨询
叠翠峰 3室1厅 97.07平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 97.07平米
东南 | 其他2023.10.22225万
中楼层(共22层) 2017年塔楼23180元/平
房屋满两年近地铁
挂牌249万成交周期83天
林智博免费咨询
叠翠峰 3室2厅 89.27平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 89.27平米
西北 | 精装2023.10.21208万
中楼层(共16层) 2018年塔楼23301元/平
房屋满两年近地铁
挂牌225万成交周期232天
郑基免费咨询
叠翠峰 2室2厅 71.28平米-广州叠翠峰二手房成交
叠翠峰 2室2厅 71.28平米
北 | 精装2023.10.05173万
低楼层(共32层) 2017年塔楼24271元/平
房屋满两年近地铁
挂牌185万成交周期301天
黄景林免费咨询
叠翠峰 3室2厅 90.67平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 90.67平米
北 | 精装2023.09.25206万
高楼层(共24层) 2017年塔楼22720元/平
房屋满五年
挂牌225万成交周期737天
吴刘意免费咨询
叠翠峰 3室2厅 97平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 97平米
南 | 精装2023.09.17286万
中楼层(共26层) 2018年板楼29485元/平
近地铁
挂牌297万成交周期177天
许楷淋免费咨询
叠翠峰 2室1厅 70.02平米-广州叠翠峰二手房成交
叠翠峰 2室1厅 70.02平米
西北 | 精装2023.09.05165万
中楼层(共22层) 2017年塔楼23565元/平
房屋满两年近地铁
挂牌178万成交周期6天
李建琴免费咨询
叠翠峰 3室2厅 66.78平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 66.78平米
北 | 精装2023.08.31151.9万
高楼层(共22层) 2017年板楼22744元/平
房屋满两年近地铁
挂牌160万成交周期111天
姚韩凯免费咨询
叠翠峰 3室2厅 89.83平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 89.83平米
南 北 | 精装2023.08.27225.8万
中楼层(共31层) 2017年板楼25137元/平
房屋满五年近地铁
挂牌230万成交周期191天
林海燕免费咨询
叠翠峰 3室2厅 86.16平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 86.16平米
北 | 精装2023.08.27200万
低楼层(共22层) 2017年板楼23213元/平
房屋满两年近地铁
挂牌203万成交周期746天
朱娟免费咨询
叠翠峰 3室2厅 97.54平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 97.54平米
东南 南 | 其他2023.08.24274万
中楼层(共26层) 2018年塔楼28091元/平
房屋满两年近地铁
挂牌285万成交周期291天
莫灿林免费咨询
叠翠峰 3室1厅 110.44平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 110.44平米
南 | 精装2023.08.11247万
低楼层(共31层) 2017年板楼22366元/平
房屋满五年近地铁
挂牌260万成交周期899天
崔夏连免费咨询
叠翠峰 3室1厅 105.86平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 105.86平米
南 | 精装2023.08.10266.8万
中楼层(共18层) 2017年塔楼25204元/平
房屋满五年
挂牌275万成交周期78天
张伟浩免费咨询
叠翠峰 2室1厅 71.4平米-广州叠翠峰二手房成交
叠翠峰 2室1厅 71.4平米
北 东 | 简装2023.08.06183.5万
低楼层(共32层) 2017年塔楼25701元/平
房屋满五年
挂牌192万成交周期152天
林智博免费咨询
叠翠峰 3室1厅 89.28平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 89.28平米
南 | 精装2023.07.22218万
高楼层(共31层) 2017年塔楼24418元/平
房屋满两年
挂牌228万成交周期293天
崔夏连免费咨询
叠翠峰 3室2厅 86.1平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 86.1平米
北 | 精装2023.07.01193万
高楼层(共22层) 2017年板楼22416元/平
房屋满两年近地铁
挂牌198万成交周期257天
高锡泉免费咨询
叠翠峰 3室1厅 89.03平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 89.03平米
南 | 简装2023.05.24223.5万
中楼层(共32层) 2017年塔楼25104元/平
房屋满五年
挂牌235万成交周期1天
黄景林免费咨询
叠翠峰 3室1厅 86.08平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 86.08平米
北 | 精装2023.05.07210万
高楼层(共23层) 2017年板楼24396元/平
房屋满两年近地铁
挂牌210万成交周期47天
黄灿坚免费咨询
叠翠峰 2室1厅 73.55平米-广州叠翠峰二手房成交
叠翠峰 2室1厅 73.55平米
北 | 精装2023.04.25177万
中楼层(共31层) 2017年板楼24066元/平
房屋满两年近地铁
挂牌180万成交周期64天
詹若珊免费咨询
叠翠峰 3室2厅 105.86平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 105.86平米
南 | 精装2023.04.24265万
低楼层(共18层) 2017年塔楼25034元/平
房屋满两年
挂牌280万成交周期44天
崔夏连免费咨询
叠翠峰 3室1厅 88.4平米
南 | 精装2023.03.23248万
高楼层(共26层) 2018年板楼28055元/平
房屋满两年近地铁
挂牌255万成交周期45天
黄林艳免费咨询
叠翠峰 3室2厅 89.29平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 89.29平米
南 | 精装2023.03.22238万
中楼层(共31层) 2017年塔楼26655元/平
房屋满五年
挂牌243万成交周期278天
高锡泉免费咨询
叠翠峰 3室1厅 110.44平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 110.44平米
东南 | 其他2023.03.19278.8万
高楼层(共31层) 2016年板楼25245元/平
近地铁
挂牌285万成交周期1天
詹若珊免费咨询
叠翠峰 3室1厅 108.79平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 108.79平米
南 | 精装2023.03.04283万
高楼层(共31层) 2017年塔楼26014元/平
房屋满五年
挂牌286万成交周期35天
李春波免费咨询
叠翠峰 2室1厅 73.55平米-广州叠翠峰二手房成交
叠翠峰 2室1厅 73.55平米
北 | 精装2023.02.26184.8万
高楼层(共31层) 2017年板楼25126元/平
房屋满两年近地铁
挂牌190万成交周期662天
赵康文免费咨询
叠翠峰 3室2厅 109.11平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 109.11平米
东南 | 其他2023.02.18273万
低楼层(共24层) 2017年塔楼25021元/平
房屋满五年
挂牌283万成交周期40天
朱永豪免费咨询
叠翠峰 3室2厅 103.45平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 103.45平米
东南 | 精装2023.02.05267万
低楼层(共17层) 2017年板楼25810元/平
房屋满两年近地铁
挂牌280万成交周期124天
黄林艳免费咨询
叠翠峰 2室2厅 71.4平米-广州叠翠峰二手房成交
叠翠峰 2室2厅 71.4平米
东北 | 精装2023.01.15190.8万
高楼层(共32层) 2017年塔楼26723元/平
房屋满两年
挂牌196万成交周期172天
林智博免费咨询
叠翠峰 3室2厅 89.97平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 89.97平米
北 | 精装2021.04.22275万
低楼层(共32层) 2017年塔楼30566元/平
房屋满五年近地铁
挂牌275万成交周期26天
黄灿坚免费咨询
叠翠峰 3室2厅 108.79平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 108.79平米
南 | 精装2021.04.03365万
高楼层(共31层) 2017年塔楼33551元/平
房屋满五年
挂牌370万成交周期5天
黄灿坚免费咨询
叠翠峰 2室2厅 72.87平米-广州叠翠峰二手房成交
叠翠峰 2室2厅 72.87平米
东北 | 精装2021.03.27256万
高楼层(共31层) 2017年板楼35132元/平
房屋满五年近地铁
挂牌258万成交周期16天
曾伟平免费咨询
叠翠峰 3室2厅 80.71平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 80.71平米
北 东北 | 精装2021.03.27270万
中楼层(共17层) 2017年板楼33454元/平
房屋满五年近地铁
挂牌272万成交周期190天
黄灿坚免费咨询
叠翠峰 3室2厅 86.5平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 86.5平米
南 | 精装2021.03.26285万
高楼层(共23层) 2017年板楼32948元/平
房屋满两年近地铁
挂牌285万成交周期23天
黄灿坚免费咨询
叠翠峰 3室2厅 89.2平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 89.2平米
西 | 其他2021.03.15280万
低楼层(共31层) 2017年板楼31391元/平
房屋满五年近地铁
挂牌285万成交周期15天
黄灿坚免费咨询
叠翠峰 3室1厅 89.97平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 89.97平米
北 | 精装2021.03.15287.6万
高楼层(共32层) 2017年塔楼31967元/平
房屋满五年近地铁
挂牌290万成交周期78天
黄进欣免费咨询
叠翠峰 3室2厅 90.48平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 90.48平米
北 | 精装2021.01.27265万
低楼层(共31层) 2017年塔楼29289元/平
房屋满五年
挂牌268万成交周期18天
张志云免费咨询
叠翠峰 3室2厅 110.44平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 110.44平米
南 | 其他2021.01.20361.5万
高楼层(共31层) 2017年板楼32733元/平
房屋满五年近地铁
挂牌366万成交周期2天
黄灿坚免费咨询
叠翠峰 3室2厅 90.1平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 90.1平米
东北 | 精装2021.01.18283万
中楼层(共32层) 2017年塔楼31410元/平
房屋满五年
挂牌290万成交周期24天
黄灿坚免费咨询
叠翠峰 3室2厅 91平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 91平米
东北 | 简装2021.01.16276万
中楼层(共24层) 2017年塔楼30330元/平
房屋满五年
挂牌283万成交周期12天
黄灿坚免费咨询
叠翠峰 3室2厅 90.67平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 90.67平米
北 | 精装2021.01.16285万
中楼层(共24层) 2017年塔楼31433元/平
房屋满五年
挂牌288万成交周期91天
赵康文免费咨询
叠翠峰 3室2厅 108平米
东南 | 其他2021.01.11343.5万
高楼层(共32层) 2017年塔楼31806元/平
房屋满五年近地铁
挂牌346万成交周期12天
刘文爽免费咨询
叠翠峰 3室2厅 109.11平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 109.11平米
南 | 精装2020.12.28320万
高楼层(共24层) 2017年塔楼29329元/平
房屋满五年
挂牌330万成交周期355天
叶海燕免费咨询
叠翠峰 2室1厅 71.67平米-广州叠翠峰二手房成交
叠翠峰 2室1厅 71.67平米
东北 | 精装2020.12.27222.5万
低楼层(共31层) 2017年塔楼31046元/平
房屋满五年
挂牌225万成交周期2天
黄灿坚免费咨询
叠翠峰 3室1厅 90.48平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 90.48平米
东北 | 其他2020.12.07279.3万
高楼层(共31层) 2017年塔楼30869元/平
房屋满五年
挂牌290万成交周期14天
黄林艳免费咨询
叠翠峰 3室2厅 105平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 105平米
东南 | 精装2020.12.06328万
中楼层(共11层) 2017年塔楼31239元/平
房屋满五年
挂牌346万成交周期62天
谢丽君免费咨询
叠翠峰 3室2厅 66.71平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 66.71平米
北 | 精装2020.12.06204.3万
高楼层(共23层) 2017年板楼30626元/平
房屋满五年近地铁
挂牌205万成交周期112天
黄灿坚免费咨询
叠翠峰 2室1厅 66.71平米-广州叠翠峰二手房成交
叠翠峰 2室1厅 66.71平米
北 | 精装2020.12.02211万
低楼层(共23层) 2017年板楼31630元/平
房屋满五年近地铁
挂牌206万成交周期81天
黄灿坚免费咨询
叠翠峰 3室2厅 108.79平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 108.79平米
南 | 精装2020.11.16325万
高楼层(共31层) 2017年塔楼29875元/平
房屋满五年
挂牌328万成交周期48天
曾晴免费咨询
叠翠峰 3室1厅 88.29平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 88.29平米
西南 | 精装2020.11.15276万
高楼层(共31层) 2017年塔楼31261元/平
房屋满五年
挂牌277万成交周期8天
黄林艳免费咨询
叠翠峰 3室2厅 89.9平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 89.9平米
北 | 精装2020.11.08262万
中楼层(共32层) 2017年塔楼29144元/平
房屋满五年近地铁
挂牌263万成交周期32天
侯文良免费咨询
叠翠峰 3室2厅 107.29平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 107.29平米
东南 | 精装2020.10.17360万
高楼层(共17层) 2018年塔楼33554元/平
房屋满五年近地铁
挂牌368万成交周期90天
黄灿坚免费咨询
叠翠峰 3室2厅 110平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 110平米
南 | 精装2020.10.08318万
高楼层(共31层) 2017年板楼28910元/平
房屋满五年近地铁
挂牌324.5万成交周期18天
黄灿坚免费咨询
叠翠峰 2室2厅 72平米-广州叠翠峰二手房成交
叠翠峰 2室2厅 72平米
东北 | 精装2020.09.25190万
低楼层(共32层) 2017年塔楼26389元/平
房屋满五年近地铁
挂牌195万成交周期9天
莫灿林免费咨询
叠翠峰 3室2厅 87.95平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 87.95平米
东 | 精装2020.09.21267万
中楼层(共18层) 2017年塔楼30359元/平
房屋满五年
挂牌268万成交周期50天
黄灿坚免费咨询
叠翠峰 3室2厅 108平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 108平米
南 | 精装2020.09.20308万
低楼层(共32层) 2017年塔楼28519元/平
房屋满五年
挂牌313万成交周期50天
谢晓雯免费咨询
叠翠峰 3室2厅 104.19平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 104.19平米
南 | 其他2020.09.15305万
中楼层(共11层) 2017年塔楼29274元/平
房屋满五年
挂牌312万成交周期54天
黄灿坚免费咨询
叠翠峰 3室1厅 69.86平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 69.86平米
北 | 其他2020.09.06175万
低楼层(共22层) 2017年塔楼25051元/平
近地铁
挂牌180万成交周期3天
黄灿坚免费咨询
叠翠峰 3室1厅 90.48平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 90.48平米
北 | 其他2020.08.31249.8万
低楼层(共31层) 2017年塔楼27609元/平
挂牌253万成交周期1天
黄智明免费咨询
叠翠峰 3室2厅 97.07平米
南 北 | 其他2020.08.31282万
高楼层(共22层) 2017年塔楼29052元/平
房屋满五年近地铁
挂牌283万成交周期136天
黄灿坚免费咨询
叠翠峰 3室2厅 108.56平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 108.56平米
东南 | 精装2020.08.25275万
低楼层(共31层) 2017年塔楼25332元/平
房屋满五年
挂牌280万成交周期4天
黄灿坚免费咨询
叠翠峰 3室2厅 108.79平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 108.79平米
南 | 精装2020.08.02293万
低楼层(共31层) 2017年塔楼26933元/平
房屋满五年
挂牌300万成交周期28天
黄灿坚免费咨询
叠翠峰 3室2厅 90.67平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 90.67平米
东北 | 精装2020.08.01230万
低楼层(共24层) 2017年塔楼25367元/平
房屋满五年
挂牌230万成交周期27天
黄灿坚免费咨询
叠翠峰 3室1厅 108.79平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 108.79平米
南 | 精装2020.07.28253.8万
高楼层(共31层) 2017年塔楼23330元/平
房屋满五年
挂牌260万成交周期37天
李志光免费咨询
叠翠峰 3室1厅 89.29平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 89.29平米
南 | 精装2020.07.19240万
低楼层(共31层) 2017年塔楼26879元/平
房屋满五年
挂牌241万成交周期7天
梁家辉免费咨询
叠翠峰 3室2厅 110.44平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 110.44平米
南 | 精装2020.07.17298万
低楼层(共31层) 2017年板楼26983元/平
房屋满五年近地铁
挂牌300万成交周期389天
黄灿坚免费咨询
叠翠峰 3室2厅 96平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 96平米
南 | 其他2020.07.08263万
中楼层(共23层) 2017年板楼27396元/平
房屋满五年近地铁
挂牌268万成交周期3天
黄灿坚免费咨询
叠翠峰 3室2厅 89平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 89平米
北 | 简装2020.07.07211万
高楼层(共23层) 2017年板楼23708元/平
房屋满五年近地铁
挂牌213万成交周期37天
范小玉免费咨询
叠翠峰 3室2厅 66.84平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 66.84平米
北 | 精装2020.06.25163万
中楼层(共23层) 2017年板楼24387元/平
房屋满五年近地铁
挂牌165万成交周期256天
黄灿坚免费咨询
叠翠峰 3室2厅 89.2平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 89.2平米
北 | 简装2020.06.23226万
高楼层(共31层) 2017年板楼25337元/平
房屋满五年近地铁
挂牌228万成交周期77天
曾晴免费咨询
叠翠峰 3室2厅 90.67平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 90.67平米
北 | 精装2020.06.19230万
中楼层(共24层) 2017年塔楼25367元/平
房屋满五年
挂牌235万成交周期93天
黄智明免费咨询
叠翠峰 3室2厅 108.56平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 108.56平米
南 | 精装2020.06.04256万
中楼层(共31层) 2017年塔楼23582元/平
房屋满五年
挂牌258万成交周期55天
黄智明免费咨询
叠翠峰 2室2厅 70.02平米-广州叠翠峰二手房成交
叠翠峰 2室2厅 70.02平米
北 | 精装2020.05.31186万
高楼层(共22层) 2017年塔楼26564元/平
房屋满五年近地铁
挂牌180万成交周期12天
郑建鸿免费咨询
叠翠峰 3室2厅 105平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 105平米
南 | 其他2020.05.30216万
低楼层(共18层) 2017年塔楼20572元/平
挂牌260万成交周期59天
张俭免费咨询
叠翠峰 2室1厅 71.4平米-广州叠翠峰二手房成交
叠翠峰 2室1厅 71.4平米
东北 | 其他2020.05.28187万
高楼层(共32层) 2017年塔楼26191元/平
房屋满五年
挂牌188万成交周期1天
陆浩佳免费咨询
叠翠峰 3室2厅 95.63平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 95.63平米
南 北 | 精装2020.05.24248.3万
中楼层(共23层) 2017年板楼25965元/平
房屋满五年近地铁
挂牌240万成交周期372天
陈培云免费咨询
叠翠峰 2室2厅 70.02平米-广州叠翠峰二手房成交
叠翠峰 2室2厅 70.02平米
北 | 精装2020.05.23182万
中楼层(共22层) 2017年塔楼25993元/平
房屋满五年近地铁
挂牌175万成交周期433天
黄灿坚免费咨询
叠翠峰 3室2厅 89平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 89平米
北 | 精装2020.05.18205万
低楼层(共31层) 2017年塔楼23034元/平
房屋满五年
挂牌215万成交周期23天
黄灿坚免费咨询
叠翠峰 2室2厅 71平米-广州叠翠峰二手房成交
叠翠峰 2室2厅 71平米
北 | 精装2020.05.17182.5万
低楼层(共32层) 2017年塔楼25705元/平
房屋满五年近地铁
挂牌187万成交周期138天
黄灿坚免费咨询
叠翠峰 2室2厅 72.87平米-广州叠翠峰二手房成交
叠翠峰 2室2厅 72.87平米
北 | 精装2020.05.12178万
中楼层(共31层) 2017年板楼24428元/平
房屋满五年近地铁
挂牌185万成交周期3天
黄灿坚免费咨询
叠翠峰 3室2厅 90.48平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 90.48平米
东北 | 精装2020.05.12228万
高楼层(共31层) 2017年塔楼25199元/平
房屋满五年
挂牌230万成交周期23天
季东阳免费咨询
叠翠峰 3室2厅 90.48平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 90.48平米
北 | 其他2020.05.11223万
中楼层(共31层) 2017年塔楼24647元/平
房屋满五年
挂牌228万成交周期121天
黄智明免费咨询
叠翠峰 3室1厅 89.83平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 89.83平米
南 | 精装2020.05.06235万
高楼层(共31层) 2017年板楼26161元/平
近地铁
挂牌235万成交周期40天
陈力免费咨询
叠翠峰 3室2厅 108.56平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 108.56平米
南 | 精装2020.04.24259万
低楼层(共31层) 2017年塔楼23858元/平
房屋满五年
挂牌263万成交周期31天
黄灿坚免费咨询
叠翠峰 3室2厅 95.72平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 95.72平米
东南 | 精装2020.04.23239万
中楼层(共22层) 2017年板楼24969元/平
房屋满五年近地铁
挂牌248万成交周期66天
叶海燕免费咨询
叠翠峰 3室2厅 88平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 88平米
北 | 精装2020.04.19210万
低楼层(共18层) 2017年塔楼23864元/平
挂牌228万成交周期19天
张远锋免费咨询
叠翠峰 2室1厅 72.87平米
北 | 其他2020.03.23178万
高楼层(共31层) 2017年板楼24428元/平
近地铁
挂牌180万成交周期3天
曾晴免费咨询
叠翠峰 3室2厅 108.79平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 108.79平米
南 | 精装2020.03.22260万
高楼层(共31层) 2017年塔楼23900元/平
房屋满五年
挂牌266万成交周期29天
曾晴免费咨询
叠翠峰 2室2厅 73.55平米-广州叠翠峰二手房成交
叠翠峰 2室2厅 73.55平米
东北 | 精装2020.03.14174万
中楼层(共31层) 2017年板楼23658元/平
房屋满五年近地铁
挂牌180万成交周期71天
黄灿坚免费咨询
叠翠峰 3室1厅 90.48平米
北 | 其他2020.03.07218.8万
中楼层(共31层) 2017年塔楼24183元/平
挂牌225万成交周期2天
黄灿坚免费咨询
叠翠峰 3室2厅 86.37平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 86.37平米
东北 | 精装2020.01.03198万
低楼层(共11层) 2017年塔楼22925元/平
房屋满五年
挂牌205万成交周期7天
黄灿坚免费咨询
叠翠峰 3室2厅 108.79平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 108.79平米
南 | 精装2019.12.29255万
低楼层(共31层) 2017年塔楼23440元/平
房屋满五年
挂牌260万成交周期164天
黄智明免费咨询
叠翠峰 2室2厅 71.4平米
北 | 其他2019.12.24176万
高楼层(共32层) 2017年塔楼24650元/平
挂牌176万成交周期1天
黄灿坚免费咨询
叠翠峰 3室2厅 90平米
东北 | 精装2019.12.23197万
低楼层(共32层) 2017年塔楼21889元/平
房屋满五年
挂牌200万成交周期335天
梁家辉免费咨询
叠翠峰 2室2厅 71.67平米-广州叠翠峰二手房成交
叠翠峰 2室2厅 71.67平米
东北 | 精装2019.12.21175万
低楼层(共31层) 2017年塔楼24418元/平
房屋满五年
挂牌178万成交周期94天
张俊龙免费咨询
叠翠峰 3室1厅 66.9平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 66.9平米
北 | 其他2019.12.17157.5万
低楼层(共22层) 2017年板楼23543元/平
房屋满五年近地铁
挂牌165万成交周期2天
曾晴免费咨询
叠翠峰 3室2厅 109.11平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 109.11平米
东南 | 精装2019.11.25242万
低楼层(共24层) 2017年塔楼22180元/平
房屋满五年
挂牌247万成交周期307天
陈培云免费咨询
叠翠峰 3室1厅 89平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 89平米
南 | 精装2019.11.19212万
中楼层(共32层) 2017年塔楼23821元/平
房屋满五年
挂牌220万成交周期59天
黄灿坚免费咨询
叠翠峰 3室2厅 80平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 80平米
南 | 精装2019.10.28226.5万
中楼层(共17层) 2017年板楼28313元/平
近地铁
挂牌235万成交周期93天
黄灿坚免费咨询
叠翠峰 3室2厅 87.77平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 87.77平米
南 | 精装2019.10.27195万
高楼层(共22层) 2017年塔楼22218元/平
房屋满五年近地铁
挂牌200万成交周期17天
黄灿坚免费咨询
叠翠峰 2室2厅 72.4平米-广州叠翠峰二手房成交
叠翠峰 2室2厅 72.4平米
北 | 精装2019.09.16170万
高楼层(共31层) 2017年板楼23481元/平
近地铁
挂牌170万成交周期11天
黄灿坚免费咨询
叠翠峰 3室2厅 109平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 109平米
南 | 精装2019.07.28220万
低楼层(共31层) 2017年塔楼20184元/平
挂牌225万成交周期132天
梁家辉免费咨询
叠翠峰 2室2厅 74平米-广州叠翠峰二手房成交
叠翠峰 2室2厅 74平米
东北 | 精装2019.07.15170万
高楼层(共31层) 2017年板楼22973元/平
近地铁
挂牌175万成交周期202天
黄灿坚免费咨询
叠翠峰 3室2厅 110.44平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 110.44平米
南 | 精装2019.06.09245万
中楼层(共31层) 2017年板楼22184元/平
近地铁
挂牌260万成交周期166天
黄灿坚免费咨询
叠翠峰 3室2厅 90平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 90平米
东北 | 其他2019.04.14200万
中楼层(共31层) 2017年塔楼22223元/平
挂牌208万成交周期38天
黄灿坚免费咨询
叠翠峰 3室2厅 89平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 89平米
东南 | 其他2019.04.02210万
低楼层(共32层) 2017年塔楼23596元/平
近地铁
挂牌230万成交周期70天
梁家辉免费咨询
叠翠峰 3室2厅 108.56平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 108.56平米
西南 | 精装2019.03.13230万
高楼层(共31层) 2015年塔楼21187元/平
房屋满五年
挂牌230万成交周期156天
黄灿坚免费咨询
叠翠峰 3室2厅 90.11平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 90.11平米
东北 | 其他2019.01.29198万
高楼层(共32层) 2017年塔楼21974元/平
房屋满五年
挂牌205万成交周期41天
黄灿坚免费咨询
叠翠峰 3室2厅 69平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 69平米
北 | 精装2022.12.12176万
低楼层(共25层) 2018年板塔结合25508元/平
房屋满两年近地铁
挂牌176万成交周期123天
钱海燕免费咨询
叠翠峰 4室1厅 125.39平米-广州叠翠峰二手房成交
叠翠峰 4室1厅 125.39平米
东南 | 精装2022.12.11346.8万
中楼层(共11层) 2017年塔楼27658元/平
房屋满五年近地铁
挂牌440万成交周期404天
黄林艳免费咨询
叠翠峰 3室2厅 103.62平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 103.62平米
南 | 精装2022.11.27270万
中楼层(共17层) 2018年板塔结合26057元/平
房屋满两年近地铁
挂牌285万成交周期108天
詹若珊免费咨询
叠翠峰 3室2厅 86平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 86平米
北 | 精装2022.11.22226.9万
高楼层(共17层) 2018年板塔结合26383元/平
房屋满两年近地铁
挂牌237万成交周期70天
黄林艳免费咨询
叠翠峰 3室2厅 97.08平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 97.08平米
南 | 简装2022.10.01275万
低楼层(共26层) 2018年板楼28328元/平
房屋满五年近地铁
挂牌278万成交周期175天
刘宝珠免费咨询
叠翠峰 2室1厅 71.4平米-广州叠翠峰二手房成交
叠翠峰 2室1厅 71.4平米
北 | 精装2022.08.06185万
低楼层(共32层) 2017年塔楼25911元/平
房屋满五年
挂牌190万成交周期126天
崔夏连免费咨询
叠翠峰 3室2厅 87.38平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 87.38平米
北 | 精装2022.07.17218万
低楼层(共22层) 2017年塔楼24949元/平
房屋满五年近地铁
挂牌225万成交周期379天
黄灿坚免费咨询
叠翠峰 3室2厅 66.77平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 66.77平米
北 | 其他2022.07.09190万
低楼层(共22层) 2017年板楼28456元/平
房屋满两年近地铁
挂牌195万成交周期35天
黄灿坚免费咨询
叠翠峰 3室2厅 97.54平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 97.54平米
东南 | 精装2022.07.09238万
低楼层(共26层) 2018年塔楼24401元/平
房屋满五年近地铁
挂牌269万成交周期199天
龚醒洪免费咨询
叠翠峰 3室2厅 105.86平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 105.86平米
南 北 | 精装2022.07.03270.1万
高楼层(共18层) 2017年塔楼25515元/平
房屋满五年
挂牌297万成交周期124天
谢晓雯免费咨询
叠翠峰 3室1厅 96.23平米-广州叠翠峰二手房成交
叠翠峰 3室1厅 96.23平米
东南 | 精装2022.06.29286.4万
低楼层(共26层) 2018年塔楼29758元/平
房屋满五年近地铁
挂牌293万成交周期14天
郑蔓娴免费咨询
叠翠峰 3室2厅 97.54平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 97.54平米
南 | 其他2022.06.23315万
中楼层(共26层) 2018年塔楼32295元/平
房屋满五年近地铁
挂牌350万成交周期131天
詹若珊免费咨询
叠翠峰 3室2厅 86.16平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 86.16平米
北 | 精装2022.06.08221万
低楼层(共22层) 2017年板楼25650元/平
房屋满五年近地铁
挂牌223万成交周期376天
郑蔓娴免费咨询
叠翠峰 3室2厅 110.44平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 110.44平米
南 | 其他2022.03.23317万
中楼层(共31层) 2017年板楼28704元/平
房屋满五年近地铁
挂牌320万成交周期176天
黄林艳免费咨询
叠翠峰 3室2厅 66.9平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 66.9平米
北 | 简装2022.03.23172万
低楼层(共22层) 2017年板楼25711元/平
房屋满五年近地铁
挂牌182万成交周期206天
龚醒洪免费咨询
叠翠峰 3室2厅 104.19平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 104.19平米
南 | 简装2022.01.27333.8万
中楼层(共11层) 2017年塔楼32038元/平
房屋满两年
挂牌339万成交周期117天
黄灿坚免费咨询
叠翠峰 3室2厅 87.94平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 87.94平米
南 | 精装2022.01.08260万
高楼层(共22层) 2017年塔楼29566元/平
房屋满两年近地铁
挂牌265万成交周期251天
郑蔓娴免费咨询
叠翠峰 2室2厅 68平米-广州叠翠峰二手房成交
叠翠峰 2室2厅 68平米
北 | 精装2021.12.13180万
低楼层(共23层) 2017年板楼26471元/平
房屋满五年近地铁
挂牌185万成交周期216天
彭桂英免费咨询
叠翠峰 2室1厅 71平米-广州叠翠峰二手房成交
叠翠峰 2室1厅 71平米
北 | 简装2021.12.12200万
中楼层(共31层) 2017年塔楼28170元/平
挂牌205万成交周期101天
黄丹免费咨询
叠翠峰 3室2厅 107.29平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 107.29平米
南 | 精装2021.07.18418万
高楼层(共17层) 2018年塔楼38960元/平
房屋满五年近地铁
挂牌435万成交周期148天
黄灿坚免费咨询
叠翠峰 3室2厅 86.16平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 86.16平米
北 | 精装2021.06.18292万
中楼层(共22层) 2017年板楼33891元/平
房屋满五年近地铁
挂牌292万成交周期26天
张旭免费咨询
叠翠峰 3室2厅 109.11平米-广州叠翠峰二手房成交
叠翠峰 3室2厅 109.11平米
南 | 精装2021.04.28364.8万
中楼层(共24层) 2017年塔楼33435元/平
房屋满五年
挂牌375万成交周期45天
刘鹏杰免费咨询
`;

let parsedData = [];
let activePointIndex = -1;
let coasterFrameId = null;
let coasterDistance = 0;
let activeFireworks = [];
let cityIndexLayout = null;
let cityIndexHoverSeriesIndex = -1;
let cityIndexLockedSeriesIndex = -1;
let pyramidYearIndex = 0;
let pyramidTimer = null;
let pyramidPlaying = true;
const PYRAMID_FRAME_MS = 650;
const BGM_SRC = "./assets/montagem-miau.mp3";
let bgmAudio = null;
let bgmIsPlaying = false;
const IS_SAFARI = /^((?!chrome|android|crios|fxios|edgios).)*safari/i.test(
  navigator.userAgent || "",
);

function buildMonthlyLabels(startYm, endYm) {
  const [startY, startM] = startYm.split("-").map(Number);
  const [endY, endM] = endYm.split("-").map(Number);
  if (!startY || !startM || !endY || !endM) return [];

  const labels = [];
  let y = startY;
  let m = startM;
  while (y < endY || (y === endY && m <= endM)) {
    labels.push(`${y}-${String(m).padStart(2, "0")}`);
    m += 1;
    if (m > 12) {
      m = 1;
      y += 1;
    }
  }
  return labels;
}

function buildInterpolatedSeries(monthLabels, anchors, seed = 1, wiggleAmp = 3.5) {
  if (!Array.isArray(monthLabels) || !monthLabels.length || !Array.isArray(anchors) || !anchors.length) {
    return [];
  }

  const idxByMonth = new Map(monthLabels.map((m, idx) => [m, idx]));
  const cleanAnchors = anchors
    .map(([month, value]) => ({ month, value: Number(value), idx: idxByMonth.get(month) }))
    .filter((x) => Number.isFinite(x.value) && Number.isInteger(x.idx))
    .sort((a, b) => a.idx - b.idx);
  if (!cleanAnchors.length) return monthLabels.map(() => 0);

  const output = new Array(monthLabels.length).fill(cleanAnchors[0].value);
  const noise = (i) => {
    const v = Math.sin((i + seed * 13.17) * 12.9898) * 43758.5453123;
    return (v - Math.floor(v)) * 2 - 1;
  };

  for (let i = 0; i < cleanAnchors.length - 1; i += 1) {
    const a = cleanAnchors[i];
    const b = cleanAnchors[i + 1];
    const span = Math.max(1, b.idx - a.idx);
    for (let idx = a.idx; idx <= b.idx; idx += 1) {
      const t = (idx - a.idx) / span;
      const base = a.value + (b.value - a.value) * t;
      // Keep anchor points exact, add gentle monthly fluctuation between them.
      const envelope = Math.sin(Math.PI * t);
      const wave = (Math.sin((idx + seed) * 0.58) + noise(idx) * 0.7) * wiggleAmp * envelope;
      output[idx] = Number((base + wave).toFixed(1));
    }
  }

  const first = cleanAnchors[0];
  for (let i = 0; i < first.idx; i += 1) output[i] = first.value;
  const last = cleanAnchors[cleanAnchors.length - 1];
  for (let i = last.idx; i < output.length; i += 1) output[i] = output[last.idx];
  cleanAnchors.forEach((a) => {
    output[a.idx] = Number(a.value.toFixed(1));
  });
  return output;
}

function buildYearLabels(startYear, endYear) {
  const years = [];
  for (let year = startYear; year <= endYear; year += 1) {
    years.push(String(year));
  }
  return years;
}

function parsePopulationLabelToNumber(label) {
  return Number(String(label || "").replace(/[^0-9.]/g, "")) || 0;
}

function formatPopulationNumber(value) {
  return Math.round(value).toLocaleString("en-US");
}

function buildPyramidFramesByYear(anchorFrames) {
  const frames = {};
  PYRAMID_YEARS.forEach((yearText) => {
    const year = Number(yearText);
    let leftYear = PYRAMID_ANCHOR_YEARS[0];
    let rightYear = PYRAMID_ANCHOR_YEARS[PYRAMID_ANCHOR_YEARS.length - 1];
    for (let i = 0; i < PYRAMID_ANCHOR_YEARS.length - 1; i += 1) {
      const a = PYRAMID_ANCHOR_YEARS[i];
      const b = PYRAMID_ANCHOR_YEARS[i + 1];
      if (year >= a && year <= b) {
        leftYear = a;
        rightYear = b;
        break;
      }
    }

    const leftFrame = anchorFrames[String(leftYear)] || [];
    const rightFrame = anchorFrames[String(rightYear)] || leftFrame;
    const span = Math.max(1, rightYear - leftYear);
    const t = leftYear === rightYear ? 0 : (year - leftYear) / span;

    frames[yearText] = leftFrame.map((leftCountry, countryIdx) => {
      const rightCountry = rightFrame[countryIdx] || leftCountry;
      const male = leftCountry.male.map((value, idx) => {
        const rightValue = rightCountry.male[idx] ?? value;
        return Number((value + (rightValue - value) * t).toFixed(1));
      });
      const female = leftCountry.female.map((value, idx) => {
        const rightValue = rightCountry.female[idx] ?? value;
        return Number((value + (rightValue - value) * t).toFixed(1));
      });

      const leftTotal = parsePopulationLabelToNumber(leftCountry.totalLabel);
      const rightTotal = parsePopulationLabelToNumber(rightCountry.totalLabel);
      const totalLabel = formatPopulationNumber(leftTotal + (rightTotal - leftTotal) * t);
      return {
        name: leftCountry.name,
        male,
        female,
        totalLabel,
        colors: leftCountry.colors,
      };
    });
  });
  return frames;
}

function formatSignedPercent(value, digits = 1) {
  const fixed = Number(value).toFixed(digits);
  return `${value >= 0 ? "+" : ""}${fixed}%`;
}

function formatSignedNumber(value, digits = 1) {
  const fixed = Number(value).toFixed(digits);
  return `${value >= 0 ? "+" : ""}${fixed}`;
}

function formatWanByFactor(value, factor = 1, digits = 0) {
  return `${formatSignedNumber(value * factor, digits)} 万`;
}

init();

function init() {
  ensureSavedItem(DEFAULT_SAVED_NAME, YIDE_DATA_TEXT);
  ensureSavedItem(XIYA_SAVED_NAME, XIYA_DATA_TEXT);
  ensureSavedItem(PENGRUI_SAVED_NAME, PENGRUI_DATA_TEXT);
  ensureSavedItem(NANSHAN_SAVED_NAME, NANSHAN_DATA_TEXT);
  ensureSavedItem(FULI_DONGDIWAN_SAVED_NAME, FULI_DONGDIWAN_DATA_TEXT);
  ensureSavedItem(XIAOFENGYINYUE_SAVED_NAME, XIAOFENGYINYUE_DATA_TEXT);
  ensureSavedItem(HUIYAYUAN_SAVED_NAME, HUIYAYUAN_DATA_TEXT);
  ensureSavedItem(TIANYU_GARDEN_SAVED_NAME, TIANYU_GARDEN_DATA_TEXT);
  ensureSavedItem(TIANYUE_JIANGWAN_SAVED_NAME, TIANYUE_JIANGWAN_DATA_TEXT);
  ensureSavedItem(DIECUIFENG_SAVED_NAME, DIECUIFENG_DATA_TEXT);
  if (parseBtn) parseBtn.addEventListener("click", onParse);
  if (bgmBtn) bgmBtn.addEventListener("click", toggleBgm);
  if (bgmVolume) bgmVolume.addEventListener("input", onBgmVolumeChange);
  if (saveBtn) saveBtn.addEventListener("click", saveCurrentPaste);
  if (savedSelect) savedSelect.addEventListener("change", loadSelectedPaste);
  if (deleteBtn) deleteBtn.addEventListener("click", deleteSelectedPaste);
  if (exportSavedBtn) exportSavedBtn.addEventListener("click", exportSavedData);
  if (importSavedBtn) importSavedBtn.addEventListener("click", openImportPicker);
  if (importSavedFile) importSavedFile.addEventListener("change", importSavedData);
  if (startYearSlider) startYearSlider.addEventListener("input", render);
  renderSavedOptions();
  loadDefaultSavedData();
  renderDistrictResidenceChart();
  renderCityIndexChart();
  initPyramidControls();
  initBgm();
}

function renderDistrictResidenceChart() {
  if (!districtResidenceChart) return;

  const width = 980;
  const height = 440;
  const pad = { top: 112, right: 20, bottom: 48, left: 64 };
  const innerW = width - pad.left - pad.right;
  const innerH = height - pad.top - pad.bottom;
  const yMax = Math.ceil(Math.max(...DISTRICT_YEAR_TOTALS) / 20000) * 20000;
  const y = (v) => pad.top + innerH - (v / yMax) * innerH;

  const gridLines = 5;
  const yGrid = Array.from({ length: gridLines + 1 }, (_, i) => {
    const value = (yMax / gridLines) * i;
    const py = y(value);
    return `
      <line class="grid-line" x1="${pad.left}" y1="${py}" x2="${width - pad.right}" y2="${py}" />
      <text x="10" y="${py + 4}" fill="#637581" font-size="12">${Math.round(value).toLocaleString("zh-CN")}</text>
    `;
  }).join("");

  const groupW = innerW / DISTRICT_YEARS.length;
  const barW = Math.max(34, Math.min(84, groupW * 0.42));
  const bars = DISTRICT_YEARS.map((year, yearIdx) => {
    const x = pad.left + yearIdx * groupW + (groupW - barW) / 2;
    let cumulative = 0;
    const stacked = DISTRICT_RESIDENCE_SERIES.map((s, sIdx) => {
      const value = s.data[yearIdx];
      const from = cumulative;
      const to = cumulative + value;
      cumulative = to;
      const yTop = y(to);
      const h = y(from) - y(to);
      return `<rect class="district-segment"
        x="${x}"
        y="${yTop}"
        width="${barW}"
        height="${h}"
        fill="${s.color}"
        data-district="${encodeForAttr(s.name)}"
        data-series-index="${sIdx}"
        data-year="${encodeForAttr(year)}"
        data-year-index="${yearIdx}"
        data-value="${value}">
        <title>${s.name} ${year}: ${value.toLocaleString("zh-CN")} 套</title>
      </rect>`;
    }).join("");
    const totalLabel = `<text x="${x + barW / 2}" y="${y(cumulative) - 6}" text-anchor="middle" fill="#3a4b57" font-size="11">${cumulative.toLocaleString("zh-CN")}</text>`;
    return `${stacked}${totalLabel}`;
  }).join("");

  const xTicks = DISTRICT_YEARS.map((year, idx) => {
    const px = pad.left + idx * groupW + groupW / 2;
    return `<text x="${px}" y="${height - 14}" text-anchor="middle" fill="#637581" font-size="12">${year}</text>`;
  }).join("");

  let legendX = pad.left;
  let legendY = 26;
  const legend = DISTRICT_RESIDENCE_SERIES.map((s) => {
    const itemW = 62;
    if (legendX + itemW > width - pad.right) {
      legendX = pad.left;
      legendY += 22;
    }
    const item = `
      <rect x="${legendX}" y="${legendY - 9}" width="10" height="10" rx="2" fill="${s.color}" />
      <text x="${legendX + 14}" y="${legendY}" fill="#374957" font-size="12">${s.name}</text>
    `;
    legendX += itemW;
    return item;
  }).join("");

  districtResidenceChart.innerHTML = `
    ${legend}
    ${yGrid}
    <line class="axis" x1="${pad.left}" y1="${pad.top + innerH}" x2="${width - pad.right}" y2="${pad.top + innerH}" />
    <line class="axis" x1="${pad.left}" y1="${pad.top}" x2="${pad.left}" y2="${pad.top + innerH}" />
    ${bars}
    ${xTicks}
  `;
  bindDistrictTooltip();
}

function bindDistrictTooltip() {
  if (!districtResidenceChart) return;
  districtResidenceChart.onmouseleave = () => {
    hideDistrictTooltip();
    clearActiveDistrictSegments();
  };
  districtResidenceChart.onmousemove = (event) => {
    const target = event.target;
    if (!(target instanceof Element)) {
      hideDistrictTooltip();
      clearActiveDistrictSegments();
      return;
    }
    const segment = target.closest(".district-segment");
    if (!segment) {
      hideDistrictTooltip();
      clearActiveDistrictSegments();
      return;
    }
    const seriesIndex = Number(segment.getAttribute("data-series-index") || -1);
    setActiveDistrictSegments(seriesIndex);
    showDistrictTooltip(segment, event);
  };
}

function showDistrictTooltip(segment, event) {
  if (!districtTooltip || !districtPanel) return;
  const district = decodeURIComponent(segment.getAttribute("data-district") || "");
  const year = decodeURIComponent(segment.getAttribute("data-year") || "");
  const yearIdx = Number(segment.getAttribute("data-year-index") || 0);
  const seriesIdx = Number(segment.getAttribute("data-series-index") || -1);
  const value = Number(segment.getAttribute("data-value") || 0);
  const currentShare = value && DISTRICT_YEAR_TOTALS[yearIdx] ? (value / DISTRICT_YEAR_TOTALS[yearIdx]) * 100 : 0;
  const linkedRows = DISTRICT_YEARS.filter((y) => Number(y) >= 2022)
    .map((yy) => {
      const idx = DISTRICT_YEARS.indexOf(yy);
      const districtValue = seriesIdx >= 0 ? DISTRICT_RESIDENCE_SERIES[seriesIdx].data[idx] : 0;
      const share = districtValue && DISTRICT_YEAR_TOTALS[idx] ? (districtValue / DISTRICT_YEAR_TOTALS[idx]) * 100 : 0;
      return `<div>${yy}：${districtValue.toLocaleString("zh-CN")} 套（${share.toFixed(2)}%）</div>`;
    })
    .join("");
  districtTooltip.innerHTML = `
    <div class="title">${district}</div>
    <div>${year}：${value.toLocaleString("zh-CN")} 套（${currentShare.toFixed(2)}%）</div>
    <div style="margin-top:4px;opacity:.9;">22-25联动占比</div>
    ${linkedRows}
  `;
  districtTooltip.style.display = "block";

  const panelRect = districtPanel.getBoundingClientRect();
  const tooltipRect = districtTooltip.getBoundingClientRect();
  let left = event.clientX - panelRect.left + 12;
  let top = event.clientY - panelRect.top - 10;
  const maxLeft = districtPanel.clientWidth - tooltipRect.width - 8;
  if (left > maxLeft) left = Math.max(8, event.clientX - panelRect.left - tooltipRect.width - 12);
  if (top - tooltipRect.height < 4) top = event.clientY - panelRect.top + 12;

  districtTooltip.style.left = `${left}px`;
  districtTooltip.style.top = `${top}px`;
}

function hideDistrictTooltip() {
  if (!districtTooltip) return;
  districtTooltip.style.display = "none";
}

function clearActiveDistrictSegments() {
  if (!districtResidenceChart) return;
  districtResidenceChart.querySelectorAll(".district-segment.active-district").forEach((el) => {
    el.classList.remove("active-district");
  });
}

function setActiveDistrictSegments(seriesIndex) {
  clearActiveDistrictSegments();
  if (!districtResidenceChart || seriesIndex < 0) return;
  districtResidenceChart
    .querySelectorAll(`.district-segment[data-series-index="${seriesIndex}"]`)
    .forEach((el) => el.classList.add("active-district"));
}

function renderCityIndexChart() {
  if (!cityIndexChart) return;

  const width = 980;
  const height = 680;
  const pad = { top: 34, right: 92, bottom: 88, left: 62 };
  const innerW = width - pad.left - pad.right;
  const innerH = height - pad.top - pad.bottom;
  const allValues = CITY_INDEX_SERIES.flatMap((s) => s.data);
  const rawMin = Math.min(...allValues);
  const rawMax = Math.max(...allValues);
  const valueRange = Math.max(1, rawMax - rawMin);
  const valuePad = Math.max(3, valueRange * 0.02);
  const minValue = rawMin - valuePad;
  const maxValue = rawMax + valuePad;
  const x = (idx) => pad.left + (idx / (CITY_INDEX_DATES.length - 1)) * innerW;
  const y = (value) => pad.top + innerH - ((value - minValue) / (maxValue - minValue)) * innerH;
  cityIndexLayout = { width, height, pad, innerW, innerH, minValue, maxValue, x, y };
  cityIndexChart.setAttribute("viewBox", `0 0 ${width} ${height}`);

  const yTickCount = 6;
  const yGrid = Array.from({ length: yTickCount + 1 }, (_, i) => {
    const value = minValue + ((maxValue - minValue) / yTickCount) * i;
    const py = y(value);
    return `
      <line class="grid-line" x1="${pad.left}" y1="${py}" x2="${width - pad.right}" y2="${py}" />
      <text x="12" y="${py + 4}" fill="#637581" font-size="12">${value.toFixed(0)}</text>
    `;
  }).join("");

  const xTicks = CITY_INDEX_DATES.map((date, idx) => {
    const isYearStart = date.endsWith("-01");
    const isLast = idx === CITY_INDEX_DATES.length - 1;
    if (!isYearStart && !isLast) return "";
    const px = x(idx);
    const yy = date.slice(0, 4);
    return `<text x="${px}" y="${height - 30}" text-anchor="middle" fill="#637581" font-size="11">${yy}</text>`;
  }).join("");

  let legendX = pad.left;
  let legendY = 22;
  const legend = CITY_INDEX_SERIES.map((series) => {
    const textW = 52;
    const item = `
      <line x1="${legendX}" y1="${legendY - 4}" x2="${legendX + 18}" y2="${legendY - 4}" stroke="${series.color}" stroke-width="3" />
      <text x="${legendX + 24}" y="${legendY}" fill="#364652" font-size="12">${series.name}</text>
    `;
    legendX += textW;
    return item;
  }).join("");

  const lines = CITY_INDEX_SERIES.map((series, seriesIdx) => {
    const latest = series.data[series.data.length - 1];
    const pathD = series.data
      .map((value, idx) => `${idx === 0 ? "M" : "L"} ${x(idx).toFixed(2)} ${y(value).toFixed(2)}`)
      .join(" ");
    const labelX = x(CITY_INDEX_DATES.length - 1) + 8;
    const labelY = y(latest) + 4;
    const endLabel = `<text class="city-index-end-label" data-series-index="${seriesIdx}" x="${labelX}" y="${labelY}" fill="${series.color}" font-size="13" font-weight="700">${series.name}</text>`;
    return `
      <path class="city-index-line" data-series-index="${seriesIdx}" d="${pathD}" fill="none" stroke="${series.color}" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" />
      ${endLabel}
    `;
  }).join("");

  cityIndexChart.innerHTML = `
    ${legend}
    ${yGrid}
    <line class="axis" x1="${pad.left}" y1="${pad.top + innerH}" x2="${width - pad.right}" y2="${pad.top + innerH}" />
    <line class="axis" x1="${pad.left}" y1="${pad.top}" x2="${pad.left}" y2="${pad.top + innerH}" />
    ${xTicks}
    ${lines}
    <g id="city-index-hover-layer"></g>
    <rect id="city-index-hover-overlay" class="city-index-hover-overlay" x="0" y="0" width="${width}" height="${height}" fill="transparent"></rect>
    <text x="${width - pad.right}" y="${height - 2}" text-anchor="end" fill="#41515d" font-size="11">基准：2008-01 = 100</text>
  `;

  renderCityIndexSummary();
  clearCityIndexHoverProjection();
  applyLockedCityIndexStyle();
  bindCityIndexTooltip();
}

function bindCityIndexTooltip() {
  if (!cityIndexChart) return;
  const overlay = cityIndexChart.querySelector("#city-index-hover-overlay");
  if (!overlay) return;

  overlay.onmouseleave = () => {
    hideCityIndexTooltip();
    if (cityIndexLockedSeriesIndex >= 0) {
      setActiveCityIndexSeries(cityIndexLockedSeriesIndex);
    } else {
      clearActiveCityIndexSeries();
    }
    clearCityIndexHoverProjection();
    if (cityIndexLockedSeriesIndex < 0) cityIndexHoverSeriesIndex = -1;
  };
  overlay.onmousemove = (event) => {
    if (!cityIndexLayout) {
      hideCityIndexTooltip();
      clearActiveCityIndexSeries();
      clearCityIndexHoverProjection();
      return;
    }
    const svgPoint = getSvgPointFromEvent(cityIndexChart, event);
    if (!svgPoint) {
      hideCityIndexTooltip();
      clearActiveCityIndexSeries();
      clearCityIndexHoverProjection();
      return;
    }

    const { pad, innerW, innerH } = cityIndexLayout;
    const clampedX = Math.max(pad.left, Math.min(pad.left + innerW, svgPoint.x));
    const clampedY = Math.max(pad.top, Math.min(pad.top + innerH, svgPoint.y));
    const floatIndex = ((clampedX - pad.left) / innerW) * (CITY_INDEX_DATES.length - 1);
    const dataIndex = Math.max(0, Math.min(CITY_INDEX_DATES.length - 1, Math.round(floatIndex)));

    let seriesIndex = cityIndexLockedSeriesIndex;
    if (seriesIndex < 0) {
      seriesIndex = 0;
      let minDistance = Number.POSITIVE_INFINITY;
      const distances = [];
      CITY_INDEX_SERIES.forEach((series, idx) => {
        const py = getSeriesYAtFloatIndex(series.data, floatIndex, cityIndexLayout.y);
        const distance = Math.abs(py - clampedY);
        distances.push({ idx, distance });
        if (distance < minDistance) {
          minDistance = distance;
          seriesIndex = idx;
        }
      });
      // Keep previous series when two lines are very close to avoid jitter jumping.
      if (cityIndexHoverSeriesIndex >= 0) {
        const prev = distances.find((d) => d.idx === cityIndexHoverSeriesIndex);
        if (prev && prev.distance <= minDistance + 8) {
          seriesIndex = cityIndexHoverSeriesIndex;
        }
      }
    }
    cityIndexHoverSeriesIndex = seriesIndex;

    setActiveCityIndexSeries(seriesIndex);
    renderCityIndexHoverProjection(seriesIndex, dataIndex, floatIndex);
    showCityIndexTooltip(seriesIndex, dataIndex, event);
  };

  overlay.onclick = (event) => {
    if (cityIndexLockedSeriesIndex >= 0) {
      cityIndexLockedSeriesIndex = -1;
      cityIndexHoverSeriesIndex = -1;
      clearActiveCityIndexSeries();
      clearCityIndexHoverProjection();
      applyLockedCityIndexStyle();
      return;
    }
    if (!cityIndexLayout) return;
    const svgPoint = getSvgPointFromEvent(cityIndexChart, event);
    if (!svgPoint) return;
    const { pad, innerW, innerH } = cityIndexLayout;
    const clampedX = Math.max(pad.left, Math.min(pad.left + innerW, svgPoint.x));
    const clampedY = Math.max(pad.top, Math.min(pad.top + innerH, svgPoint.y));
    const floatIndex = ((clampedX - pad.left) / innerW) * (CITY_INDEX_DATES.length - 1);

    let nearestSeries = 0;
    let minDistance = Number.POSITIVE_INFINITY;
    CITY_INDEX_SERIES.forEach((series, idx) => {
      const py = getSeriesYAtFloatIndex(series.data, floatIndex, cityIndexLayout.y);
      const distance = Math.abs(py - clampedY);
      if (distance < minDistance) {
        minDistance = distance;
        nearestSeries = idx;
      }
    });

    cityIndexLockedSeriesIndex = nearestSeries;
    cityIndexHoverSeriesIndex = nearestSeries;
    setActiveCityIndexSeries(nearestSeries);
    applyLockedCityIndexStyle();
  };
}

function showCityIndexTooltip(seriesIndex, dataIndex, event) {
  if (!cityIndexTooltip || !cityIndexPanel) return;
  const series = CITY_INDEX_SERIES[seriesIndex];
  if (!series) return;
  const city = series.name;
  const date = CITY_INDEX_DATES[dataIndex] || "-";
  const value = series.data[dataIndex] || 0;
  const peak = Math.max(...series.data);
  const latest = series.data[series.data.length - 1] || 0;
  const fromPeak = peak ? ((value - peak) / peak) * 100 : 0;
  const drawdown = peak ? ((latest - peak) / peak) * 100 : 0;
  const samePoint = getEarliestSameValuePoint(series.data, dataIndex, value);
  const samePointText = samePoint
    ? `<div>最早同值点：${formatYearMonthByFloatIndex(samePoint.floatIndex ?? samePoint.index)}（${samePoint.value.toFixed(1)}）</div>`
    : "";
  cityIndexTooltip.innerHTML = `
    <div class="title">${city} ${formatYearMonth(date)}</div>
    <div>指数：${value.toFixed(1)}</div>
    <div>历史峰值：${peak.toFixed(1)}</div>
    <div>距峰值：${formatSignedPercent(fromPeak, 1)}</div>
    <div>当前值：${latest.toFixed(1)}（较峰值 ${formatSignedPercent(drawdown, 1)}）</div>
    ${samePointText}
  `;
  cityIndexTooltip.style.display = "block";

  const panelRect = cityIndexPanel.getBoundingClientRect();
  const tooltipRect = cityIndexTooltip.getBoundingClientRect();
  let left = event.clientX - panelRect.left + 12;
  let top = event.clientY - panelRect.top - 10;
  const maxLeft = cityIndexPanel.clientWidth - tooltipRect.width - 8;
  if (left > maxLeft) left = Math.max(8, event.clientX - panelRect.left - tooltipRect.width - 12);
  if (top - tooltipRect.height < 4) top = event.clientY - panelRect.top + 12;

  cityIndexTooltip.style.left = `${left}px`;
  cityIndexTooltip.style.top = `${top}px`;
}

function hideCityIndexTooltip() {
  if (!cityIndexTooltip) return;
  cityIndexTooltip.style.display = "none";
}

function clearActiveCityIndexSeries() {
  if (!cityIndexChart) return;
  cityIndexChart.querySelectorAll(".city-index-line.active-city-index-line").forEach((el) => {
    el.classList.remove("active-city-index-line");
  });
}

function setActiveCityIndexSeries(seriesIndex) {
  clearActiveCityIndexSeries();
  if (!cityIndexChart || seriesIndex < 0) return;
  cityIndexChart
    .querySelectorAll(`.city-index-line[data-series-index="${seriesIndex}"]`)
    .forEach((el) => el.classList.add("active-city-index-line"));
}

function clearCityIndexHoverProjection() {
  if (!cityIndexChart) return;
  const layer = cityIndexChart.querySelector("#city-index-hover-layer");
  if (layer) layer.innerHTML = "";
}

function applyLockedCityIndexStyle() {
  if (!cityIndexChart) return;
  cityIndexChart.querySelectorAll(".city-index-line.locked-city-index-line").forEach((el) => {
    el.classList.remove("locked-city-index-line");
  });
  cityIndexChart.querySelectorAll(".city-index-end-label.locked-city-index-line").forEach((el) => {
    el.classList.remove("locked-city-index-line");
  });
  if (cityIndexLockedSeriesIndex < 0) return;
  cityIndexChart
    .querySelectorAll(`.city-index-line[data-series-index="${cityIndexLockedSeriesIndex}"]`)
    .forEach((el) => el.classList.add("locked-city-index-line"));
  cityIndexChart
    .querySelectorAll(`.city-index-end-label[data-series-index="${cityIndexLockedSeriesIndex}"]`)
    .forEach((el) => el.classList.add("locked-city-index-line"));
}

function renderCityIndexHoverProjection(seriesIndex, dataIndex, floatIndex) {
  if (!cityIndexChart || !cityIndexLayout) return;
  const series = CITY_INDEX_SERIES[seriesIndex];
  if (!series) return;
  const layer = cityIndexChart.querySelector("#city-index-hover-layer");
  if (!layer) return;

  const px = cityIndexLayout.x(Math.max(0, Math.min(CITY_INDEX_DATES.length - 1, floatIndex)));
  const py = getSeriesYAtFloatIndex(series.data, floatIndex, cityIndexLayout.y);
  const axisX = cityIndexLayout.pad.left;
  const axisY = cityIndexLayout.pad.top + cityIndexLayout.innerH;
  const color = series.color;
  const sameValue = Number.isFinite(series.data[dataIndex]) ? series.data[dataIndex] : null;
  const samePoint = sameValue === null ? null : getEarliestSameValuePoint(series.data, dataIndex, sameValue);
  const samePointDate = samePoint ? formatYearMonthByFloatIndex(samePoint.floatIndex ?? samePoint.index) : "";
  const samePointX = samePoint ? cityIndexLayout.x(samePoint.floatIndex ?? samePoint.index) : 0;
  const samePointMarkup = samePoint
    ? `
    <line class="city-index-proj-line" x1="${samePointX}" y1="${cityIndexLayout.y(samePoint.value)}" x2="${samePointX}" y2="${axisY}" stroke="${color}" opacity="0.45"></line>
    <circle class="city-index-proj-dot" cx="${samePointX}" cy="${cityIndexLayout.y(samePoint.value)}" r="4.2" fill="${color}" opacity="0.65"></circle>
    <text x="${samePointX}" y="${axisY + 14}" text-anchor="middle" fill="${color}" font-size="10" opacity="0.75">${samePointDate}</text>
    `
    : "";
  layer.innerHTML = `
    <line class="city-index-proj-line" x1="${px}" y1="${py}" x2="${px}" y2="${axisY}" stroke="${color}"></line>
    <line class="city-index-proj-line" x1="${axisX}" y1="${py}" x2="${px}" y2="${py}" stroke="${color}"></line>
    <circle class="city-index-proj-dot" cx="${px}" cy="${py}" r="4.8" fill="${color}"></circle>
    ${samePointMarkup}
  `;
}

function getSeriesYAtFloatIndex(seriesData, floatIndex, yMapper) {
  if (!Array.isArray(seriesData) || !seriesData.length) return 0;
  const left = Math.max(0, Math.min(seriesData.length - 1, Math.floor(floatIndex)));
  const right = Math.max(0, Math.min(seriesData.length - 1, Math.ceil(floatIndex)));
  if (left === right) return yMapper(seriesData[left]);
  const t = Math.max(0, Math.min(1, floatIndex - left));
  const value = seriesData[left] + (seriesData[right] - seriesData[left]) * t;
  return yMapper(value);
}

function getEarliestSameValuePoint(seriesData, dataIndex, targetValue) {
  if (!Array.isArray(seriesData) || dataIndex <= 0 || !Number.isFinite(targetValue)) return null;
  const tolerance = 0.05;
  const history = seriesData.slice(0, dataIndex).filter((v) => Number.isFinite(v));
  if (!history.length) return null;
  const prevMax = Math.max(...history);
  const prevMin = Math.min(...history);
  // If current point is a new historical high, there is no earlier "same value" to fall back to.
  if (targetValue > prevMax + tolerance || targetValue < prevMin - tolerance) return null;

  // Priority 1: earliest true same-value crossing in continuous segments (supports interpolation).
  for (let idx = 0; idx < dataIndex - 1; idx += 1) {
    const left = seriesData[idx];
    const right = seriesData[idx + 1];
    if (!Number.isFinite(left) || !Number.isFinite(right)) continue;
    const leftDelta = left - targetValue;
    const rightDelta = right - targetValue;

    if (Math.abs(leftDelta) <= tolerance) {
      return { index: idx, floatIndex: idx, value: targetValue, same: true };
    }
    if (Math.abs(rightDelta) <= tolerance) {
      return { index: idx + 1, floatIndex: idx + 1, value: targetValue, same: true };
    }
    if (leftDelta * rightDelta < 0) {
      const ratio = (targetValue - left) / (right - left);
      const floatIndex = idx + ratio;
      return {
        index: Math.max(0, Math.min(dataIndex - 1, Math.round(floatIndex))),
        floatIndex,
        value: targetValue,
        same: true,
      };
    }
  }

  // Priority 2: integer-level crossing, to match displayed headline values (e.g. 305).
  const targetInt = Math.round(targetValue);
  for (let idx = 0; idx < dataIndex - 1; idx += 1) {
    const left = seriesData[idx];
    const right = seriesData[idx + 1];
    if (!Number.isFinite(left) || !Number.isFinite(right)) continue;
    const leftInt = Math.round(left);
    const rightInt = Math.round(right);
    if (leftInt === targetInt) {
      return { index: idx, floatIndex: idx, value: targetValue, same: true };
    }
    if (rightInt === targetInt) {
      return { index: idx + 1, floatIndex: idx + 1, value: targetValue, same: true };
    }
    if ((leftInt - targetInt) * (rightInt - targetInt) < 0) {
      const denom = rightInt - leftInt;
      const ratio = denom === 0 ? 0 : (targetInt - leftInt) / denom;
      const floatIndex = idx + ratio;
      return {
        index: Math.max(0, Math.min(dataIndex - 1, Math.round(floatIndex))),
        floatIndex,
        value: targetValue,
        same: true,
      };
    }
  }
  return null;
}

function formatYearMonthByFloatIndex(floatIndex) {
  if (!Array.isArray(CITY_INDEX_DATES) || !CITY_INDEX_DATES.length || !Number.isFinite(floatIndex)) return "-";
  const clamped = Math.max(0, Math.min(CITY_INDEX_DATES.length - 1, floatIndex));
  const left = Math.floor(clamped);
  const right = Math.ceil(clamped);
  if (left === right) return formatYearMonth(CITY_INDEX_DATES[left]);

  const leftTime = monthLabelToUtcTime(CITY_INDEX_DATES[left]);
  const rightTime = monthLabelToUtcTime(CITY_INDEX_DATES[right]);
  if (!Number.isFinite(leftTime) || !Number.isFinite(rightTime) || rightTime <= leftTime) {
    return formatYearMonth(CITY_INDEX_DATES[Math.round(clamped)]);
  }

  const t = clamped - left;
  const currentTime = leftTime + (rightTime - leftTime) * t;
  const date = new Date(currentTime);
  const year = date.getUTCFullYear();
  const month = String(date.getUTCMonth() + 1).padStart(2, "0");
  return `${year}.${month}`;
}

function monthLabelToUtcTime(label) {
  const match = String(label || "").match(/^(\d{4})-(\d{2})$/);
  if (!match) return NaN;
  const year = Number(match[1]);
  const month = Number(match[2]);
  if (!Number.isFinite(year) || !Number.isFinite(month) || month < 1 || month > 12) return NaN;
  return Date.UTC(year, month - 1, 1);
}

function getSvgPointFromEvent(svg, event) {
  const ctm = svg.getScreenCTM();
  if (!ctm) return null;
  const point = svg.createSVGPoint();
  point.x = event.clientX;
  point.y = event.clientY;
  return point.matrixTransform(ctm.inverse());
}

function renderCityIndexSummary() {
  if (!cityIndexSummary) return;
  const rows = CITY_INDEX_SERIES.map((series) => {
    const peak = Math.max(...series.data);
    const latest = series.data[series.data.length - 1];
    const drawdown = peak ? ((latest - peak) / peak) * 100 : 0;
    const peakIdx = series.data.findIndex((v) => v === peak);
    const peakDate = peakIdx >= 0 ? CITY_INDEX_DATES[peakIdx] : "-";
    const peakDateText = formatYearMonth(peakDate);
    const samePoint = getEarliestSameValuePoint(series.data, series.data.length - 1, latest);
    const latestDateText = samePoint ? formatYearMonthByFloatIndex(samePoint.floatIndex ?? samePoint.index) : "-";
    const drawdownColor = drawdown <= 0 ? "#b64848" : "#1b8f4f";
    const drawdownText = formatSignedPercent(drawdown, 1);
    return `
      <tr>
        <td style="color:${series.color};font-weight:700;">${series.name}</td>
        <td>${peak.toFixed(1)}（${peakDateText}）</td>
        <td>${latest.toFixed(1)}（${latestDateText}）</td>
        <td style="color:${drawdownColor};font-weight:700;">${drawdownText}</td>
      </tr>
    `;
  }).join("");

  cityIndexSummary.innerHTML = `
    <table>
      <thead>
        <tr>
          <th>城市</th>
          <th>最高位置</th>
          <th>当前位置（跌回）</th>
          <th>较峰值变动</th>
        </tr>
      </thead>
      <tbody>${rows}</tbody>
    </table>
  `;
}

function initPyramidControls() {
  if (pyramidYearSlider) {
    pyramidYearSlider.min = "0";
    pyramidYearSlider.max = String(Math.max(0, PYRAMID_YEARS.length - 1));
    pyramidYearSlider.step = "1";
    pyramidYearSlider.value = String(pyramidYearIndex);
    pyramidYearSlider.addEventListener("input", () => {
      pyramidYearIndex = Math.max(0, Math.min(PYRAMID_YEARS.length - 1, Number(pyramidYearSlider.value) || 0));
      syncPyramidYearUI();
      renderPopulationPyramidChart();
    });
  }
  if (pyramidPlayBtn) {
    pyramidPlayBtn.addEventListener("click", () => {
      if (pyramidPlaying) {
        stopPyramidAnimation();
      } else {
        startPyramidAnimation();
      }
    });
  }
  syncPyramidYearUI();
  renderPopulationPyramidChart();
  startPyramidAnimation();
}

function syncPyramidYearUI() {
  const year = PYRAMID_YEARS[pyramidYearIndex] || PYRAMID_YEARS[0];
  if (pyramidYearSlider) pyramidYearSlider.value = String(pyramidYearIndex);
  if (pyramidYearLabel) pyramidYearLabel.textContent = year;
  if (pyramidPlayBtn) pyramidPlayBtn.textContent = pyramidPlaying ? "暂停动图" : "播放动图";
}

function startPyramidAnimation() {
  stopPyramidAnimation();
  pyramidPlaying = true;
  syncPyramidYearUI();
  pyramidTimer = window.setInterval(() => {
    pyramidYearIndex = (pyramidYearIndex + 1) % PYRAMID_YEARS.length;
    syncPyramidYearUI();
    renderPopulationPyramidChart();
  }, PYRAMID_FRAME_MS);
}

function stopPyramidAnimation() {
  pyramidPlaying = false;
  if (pyramidTimer) {
    window.clearInterval(pyramidTimer);
    pyramidTimer = null;
  }
  syncPyramidYearUI();
}

function renderPopulationPyramidChart() {
  if (!populationPyramidChart) return;
  const year = PYRAMID_YEARS[pyramidYearIndex] || PYRAMID_YEARS[0];
  const frame = POPULATION_PYRAMID_FRAMES[year] || [];
  if (!frame.length) {
    populationPyramidChart.innerHTML = "";
    if (pyramidWorkingAgeSummary) pyramidWorkingAgeSummary.innerHTML = "";
    return;
  }

  const width = 980;
  const height = 470;
  const pad = { top: 70, right: 44, bottom: 66, left: 44 };
  const innerH = height - pad.top - pad.bottom;
  const rowCount = PYRAMID_AGE_GROUPS.length;
  const rowH = innerH / rowCount;
  const centerX = width / 2;
  const chinaCenter = width * 0.25;
  const indiaCenter = width * 0.75;
  const barMaxW = Math.min(170, (width * 0.22));
  const maxValue = Math.max(1, ...frame.flatMap((country) => [...country.male, ...country.female]));
  const scale = (value) => (value / maxValue) * barMaxW;

  const guide = Array.from({ length: rowCount }, (_, row) => {
    const y = pad.top + row * rowH + rowH / 2;
    const age = PYRAMID_AGE_GROUPS[rowCount - 1 - row];
    return `
      <line class="grid-line" x1="${pad.left}" y1="${y}" x2="${width - pad.right}" y2="${y}" />
      <text x="${centerX}" y="${y + 4}" text-anchor="middle" fill="#5d6d79" font-size="11">${age}</text>
    `;
  }).join("");

  const bars = frame.map((country, countryIdx) => {
    const center = countryIdx === 0 ? chinaCenter : indiaCenter;
    const total = country.male.reduce((sum, v) => sum + v, 0) + country.female.reduce((sum, v) => sum + v, 0);
    const countryBars = Array.from({ length: rowCount }, (_, row) => {
      const idx = rowCount - 1 - row;
      const age = PYRAMID_AGE_GROUPS[idx];
      const y = pad.top + row * rowH + 2;
      const h = Math.max(8, rowH - 4);
      const male = country.male[idx];
      const female = country.female[idx];
      const maleW = scale(male);
      const femaleW = scale(female);
      return `
        <rect class="pyramid-bar"
          x="${center - maleW}" y="${y}" width="${maleW}" height="${h}"
          fill="${country.colors.male}"
          data-country="${encodeForAttr(country.name)}" data-sex="男" data-year="${year}"
          data-age="${age}" data-value="${male}" data-total="${total}" />
        <rect class="pyramid-bar"
          x="${center}" y="${y}" width="${femaleW}" height="${h}"
          fill="${country.colors.female}"
          data-country="${encodeForAttr(country.name)}" data-sex="女" data-year="${year}"
          data-age="${age}" data-value="${female}" data-total="${total}" />
      `;
    }).join("");

    const titleY = pad.top - 28;
    const sexY = pad.top - 8;
    const totalY = height - 20;
    return `
      <text x="${center}" y="${titleY}" text-anchor="middle" fill="${country.colors.male}" font-size="42" font-weight="700">${country.name}</text>
      <text x="${center - 64}" y="${sexY}" text-anchor="middle" fill="${country.colors.male}" font-size="12" font-weight="700">男</text>
      <text x="${center + 64}" y="${sexY}" text-anchor="middle" fill="${country.colors.female}" font-size="12" font-weight="700">女</text>
      ${countryBars}
      <text x="${center}" y="${totalY}" text-anchor="middle" fill="${country.colors.male}" font-size="14" font-weight="700">总人口：${country.totalLabel}</text>
    `;
  }).join("");

  const ticks = [0, maxValue * 0.25, maxValue * 0.5, maxValue * 0.75, maxValue];
  const xTicks = ticks
    .map((value) => {
      const w = scale(value);
      return `
        <text x="${chinaCenter - w}" y="${height - 40}" text-anchor="middle" fill="#667884" font-size="11">${value.toFixed(0)}</text>
        <text x="${chinaCenter + w}" y="${height - 40}" text-anchor="middle" fill="#667884" font-size="11">${value.toFixed(0)}</text>
        <text x="${indiaCenter - w}" y="${height - 40}" text-anchor="middle" fill="#667884" font-size="11">${value.toFixed(0)}</text>
        <text x="${indiaCenter + w}" y="${height - 40}" text-anchor="middle" fill="#667884" font-size="11">${value.toFixed(0)}</text>
      `;
    })
    .join("");

  populationPyramidChart.innerHTML = `
    ${guide}
    <line class="axis" x1="${chinaCenter}" y1="${pad.top - 4}" x2="${chinaCenter}" y2="${height - pad.bottom + 8}" />
    <line class="axis" x1="${indiaCenter}" y1="${pad.top - 4}" x2="${indiaCenter}" y2="${height - pad.bottom + 8}" />
    ${bars}
    ${xTicks}
    <text x="${centerX}" y="34" text-anchor="middle" fill="#3f505d" font-size="44" font-weight="800">${year}</text>
    <text x="${centerX}" y="${pad.top + 8}" text-anchor="middle" fill="#4f606c" font-size="13">年龄组</text>
    <text x="${centerX}" y="${height - 8}" text-anchor="middle" fill="#4f606c" font-size="12">人口（百万）</text>
  `;
  populationPyramidChart.setAttribute("aria-label", `中国与印度人口年龄结构对比（${year}）`);

  renderPyramidWorkingAgeSummary(year, frame);
  bindPopulationPyramidTooltip();
}

function renderPyramidWorkingAgeSummary(year, frame) {
  if (!pyramidWorkingAgeSummary) return;
  const workingIdx = new Set([2, 3, 4]); // 20-30, 30-40, 40-50
  const yearPos = PYRAMID_YEARS.indexOf(String(year));
  const prevYear = yearPos > 0 ? PYRAMID_YEARS[yearPos - 1] : "";
  const prevFrame = prevYear ? POPULATION_PYRAMID_FRAMES[prevYear] || [] : [];
  const baseYear = PYRAMID_YEARS[0];
  const baseFrame = POPULATION_PYRAMID_FRAMES[baseYear] || [];

  const computeStats = (country) => {
    const allTotal = country.male.reduce((sum, v, idx) => sum + v + (country.female[idx] || 0), 0);
    const workingTotal = country.male.reduce((sum, v, idx) => {
      if (!workingIdx.has(idx)) return sum;
      return sum + v + (country.female[idx] || 0);
    }, 0);
    const share = allTotal ? (workingTotal / allTotal) * 100 : 0;
    return { allTotal, workingTotal, share };
  };

  const currentChina = frame.find((item) => item.name === "中国");
  if (!currentChina) {
    pyramidWorkingAgeSummary.innerHTML = "";
    return;
  }
  const prevChina = prevFrame.find((item) => item.name === "中国");
  const baseChina = baseFrame.find((item) => item.name === "中国");
  const currentStats = computeStats(currentChina);
  const prevStats = prevChina ? computeStats(prevChina) : null;
  const baseStats = baseChina ? computeStats(baseChina) : null;
  const buildDeltaClass = (value) => (value >= 0 ? "pyramid-age-up" : "pyramid-age-down");
  const deltaPop = prevStats ? currentStats.workingTotal - prevStats.workingTotal : null;
  const deltaShare = prevStats ? currentStats.share - prevStats.share : null;
  const accumPop = baseStats ? currentStats.workingTotal - baseStats.workingTotal : null;
  const accumShare = baseStats ? currentStats.share - baseStats.share : null;

  const deltaPopHtml = deltaPop === null
    ? '<span class="value">首年无上年对比</span>'
    : `<span class="value ${buildDeltaClass(deltaPop)}">${formatWanByFactor(deltaPop, 1, 0)}</span>`;
  const deltaShareHtml = deltaShare === null
    ? '<span class="value">首年无上年对比</span>'
    : `<span class="value ${buildDeltaClass(deltaShare)}">${formatSignedPercent(deltaShare, 2)}</span>`;
  const accumPopHtml = accumPop === null
    ? '<span class="value">无初始年份数据</span>'
    : `<span class="value ${buildDeltaClass(accumPop)}">${formatWanByFactor(accumPop, 1, 0)}</span>`;
  const accumShareHtml = accumShare === null
    ? '<span class="value">无初始年份数据</span>'
    : `<span class="value ${buildDeltaClass(accumShare)}">${formatSignedPercent(accumShare, 2)}</span>`;

  pyramidWorkingAgeSummary.innerHTML = `
    <article class="pyramid-age-card">
      <h3 style="color:${currentChina.colors.male};">中国 · 20-50岁（${year}）</h3>
      <div class="pyramid-age-row"><span class="label">总人口</span><span class="value">${currentStats.workingTotal.toFixed(1)} 百万</span></div>
      <div class="pyramid-age-row"><span class="label">占比</span><span class="value">${currentStats.share.toFixed(2)}%</span></div>
      <div class="pyramid-age-row"><span class="label">较上年人口变动</span>${deltaPopHtml}</div>
      <div class="pyramid-age-row"><span class="label">较上年占比变动</span>${deltaShareHtml}</div>
      <div class="pyramid-age-row"><span class="label">较初始年累计人口变动</span>${accumPopHtml}</div>
      <div class="pyramid-age-row"><span class="label">较初始年累计占比变动</span>${accumShareHtml}</div>
    </article>
  `;
}

function bindPopulationPyramidTooltip() {
  if (!populationPyramidChart) return;
  populationPyramidChart.onmouseleave = () => {
    hidePopulationPyramidTooltip();
    clearActivePyramidBars();
  };
  populationPyramidChart.onmousemove = (event) => {
    const target = event.target;
    if (!(target instanceof Element)) {
      hidePopulationPyramidTooltip();
      clearActivePyramidBars();
      return;
    }
    const bar = target.closest(".pyramid-bar");
    if (!bar) {
      hidePopulationPyramidTooltip();
      clearActivePyramidBars();
      return;
    }
    showPopulationPyramidTooltip(bar, event);
  };
}

function showPopulationPyramidTooltip(bar, event) {
  if (!populationPyramidTooltip || !pyramidPanel) return;

  clearActivePyramidBars();
  bar.classList.add("active-pyramid-bar");
  const country = decodeURIComponent(bar.getAttribute("data-country") || "-");
  const sex = bar.getAttribute("data-sex") || "-";
  const year = bar.getAttribute("data-year") || "-";
  const age = bar.getAttribute("data-age") || "-";
  const value = Number(bar.getAttribute("data-value") || 0);
  const total = Number(bar.getAttribute("data-total") || 0);
  const share = total ? (value / total) * 100 : 0;
  populationPyramidTooltip.innerHTML = `
    <div class="title">${country} · ${sex} · ${year}</div>
    <div>年龄段：${age}</div>
    <div>人口：${value.toFixed(1)} 百万</div>
    <div>占本国样本：${share.toFixed(2)}%</div>
  `;
  populationPyramidTooltip.style.display = "block";

  const panelRect = pyramidPanel.getBoundingClientRect();
  const tipRect = populationPyramidTooltip.getBoundingClientRect();
  let left = event.clientX - panelRect.left + 12;
  let top = event.clientY - panelRect.top - 10;
  const maxLeft = pyramidPanel.clientWidth - tipRect.width - 8;
  if (left > maxLeft) left = Math.max(8, event.clientX - panelRect.left - tipRect.width - 12);
  if (top - tipRect.height < 4) top = event.clientY - panelRect.top + 12;

  populationPyramidTooltip.style.left = `${left}px`;
  populationPyramidTooltip.style.top = `${top}px`;
}

function hidePopulationPyramidTooltip() {
  if (!populationPyramidTooltip) return;
  populationPyramidTooltip.style.display = "none";
}

function clearActivePyramidBars() {
  if (!populationPyramidChart) return;
  populationPyramidChart.querySelectorAll(".pyramid-bar.active-pyramid-bar").forEach((el) => {
    el.classList.remove("active-pyramid-bar");
  });
}

function openImportPicker() {
  if (!importSavedFile) return;
  parseStatus.classList.remove("error");
  parseStatus.textContent = "请在弹窗中选择 JSON 文件。";
  if (typeof importSavedFile.showPicker === "function") {
    importSavedFile.showPicker();
    return;
  }
  importSavedFile.click();
}

function initBgm() {
  bgmAudio = new Audio(BGM_SRC);
  bgmAudio.loop = true;
  bgmAudio.preload = "auto";
  onBgmVolumeChange();
  tryAutoPlayBgm();
}

async function tryAutoPlayBgm() {
  if (!bgmAudio) return;
  try {
    await bgmAudio.play();
    setBgmPlayingUI(true);
  } catch {
    setBgmPlayingUI(false);
    parseStatus.classList.remove("error");
    parseStatus.textContent = "自动播放被浏览器限制，请点击“播放BGM”。";
  }
}

async function toggleBgm() {
  if (!bgmAudio) return;
  if (!bgmIsPlaying) {
    try {
      await bgmAudio.play();
      setBgmPlayingUI(true);
    } catch {
      parseStatus.classList.add("error");
      parseStatus.textContent = "BGM播放失败，请确认 ./assets/montagem-miau.mp3 文件存在。";
    }
  } else {
    bgmAudio.pause();
    setBgmPlayingUI(false);
  }
}

function setBgmPlayingUI(playing) {
  bgmIsPlaying = playing;
  bgmBtn.textContent = playing ? "暂停BGM" : "播放BGM";
  bgmBtn.classList.toggle("playing", playing);
}

function onBgmVolumeChange() {
  if (!bgmAudio) return;
  const value = Number(bgmVolume.value) / 100;
  bgmAudio.volume = Math.max(0, Math.min(1, value));
}

function loadDefaultSavedData() {
  const preferred = getSavedItems().find((item) => item.name === DEFAULT_SAVED_NAME);
  if (preferred) {
    if (savedSelect) savedSelect.value = preferred.id;
    rawInput.value = preferred.rawText;
    saveNameInput.value = preferred.name;
    onParse();
    parseStatus.classList.remove("error");
    parseStatus.textContent = `已加载保存数据“${preferred.name}”。`;
    return;
  }

  const demoText = YIDE_DATA_TEXT;
  upsertSavedItem(DEFAULT_SAVED_NAME, demoText);
  renderSavedOptions();
  const saved = getSavedItems().find((item) => item.name === DEFAULT_SAVED_NAME);
  if (saved) savedSelect.value = saved.id;
  rawInput.value = demoText;
  saveNameInput.value = DEFAULT_SAVED_NAME;
  onParse();
  parseStatus.classList.remove("error");
  parseStatus.textContent = `已将示例数据写入保存名称“${DEFAULT_SAVED_NAME}”。`;
}

function upsertSavedItem(name, rawText) {
  const items = getSavedItems();
  const existing = items.find((x) => x.name === name);
  const now = Date.now();

  if (existing) {
    existing.rawText = rawText;
    existing.updatedAt = now;
  } else {
    items.push({
      id: `${now}-${Math.random().toString(36).slice(2, 7)}`,
      name,
      rawText,
      updatedAt: now,
    });
  }
  setSavedItems(items);
}

function ensureSavedItem(name, rawText) {
  const items = getSavedItems();
  const existing = items.find((x) => x.name === name);
  if (!existing || existing.rawText !== rawText) {
    upsertSavedItem(name, rawText);
  }
}

function onParse() {
  const rows = extractDatePriceRows(rawInput.value);
  if (rows.length < 2) {
    parseStatus.textContent = "解析到的数据不足。请确认文本中包含日期和“元/平”。";
    parseStatus.classList.add("error");
    return;
  }

  parseStatus.classList.remove("error");
  parsedData = rows.sort((a, b) => a.date.localeCompare(b.date));

  const years = parsedData.map((d) => Number(d.date.slice(0, 4)));
  const minYear = Math.min(...years);
  const maxYear = Math.max(...years);
  const yearSet = new Set(years);
  const missingYears = [];
  for (let y = minYear; y <= maxYear; y += 1) {
    if (!yearSet.has(y)) missingYears.push(y);
  }
  parseStatus.textContent = missingYears.length
    ? `已从粘贴内容中解析出 ${rows.length} 条记录。注意：检测到中间缺少年份 ${missingYears.join("、")}。`
    : `已从粘贴内容中解析出 ${rows.length} 条记录。`;

  startYearSlider.min = String(minYear);
  startYearSlider.max = String(maxYear);
  startYearSlider.value = String(minYear);

  render();
}

function getSavedItems() {
  let raw = null;
  try {
    raw = localStorage.getItem(SAVED_KEY);
  } catch {
    return [];
  }
  if (!raw) return [];
  try {
    const parsed = JSON.parse(raw);
    return Array.isArray(parsed) ? parsed : [];
  } catch {
    return [];
  }
}

function setSavedItems(items) {
  try {
    localStorage.setItem(SAVED_KEY, JSON.stringify(items));
  } catch {
    parseStatus.textContent = "浏览器存储空间不足，已跳过保存。";
    parseStatus.classList.add("error");
  }
}

function renderSavedOptions() {
  const items = getSavedItems();
  savedSelect.innerHTML = "";

  if (!items.length) {
    const opt = document.createElement("option");
    opt.value = "";
    opt.textContent = "暂无已保存数据";
    savedSelect.append(opt);
    savedSelect.disabled = true;
    deleteBtn.disabled = true;
    return;
  }

  savedSelect.disabled = false;
  deleteBtn.disabled = false;

  items
    .sort((a, b) => b.updatedAt - a.updatedAt)
    .forEach((item) => {
      const opt = document.createElement("option");
      opt.value = item.id;
      opt.textContent = item.name;
      savedSelect.append(opt);
    });
}

function saveCurrentPaste() {
  const name = saveNameInput.value.trim();
  const text = rawInput.value.trim();

  if (!name) {
    parseStatus.textContent = "请先输入保存名称。";
    parseStatus.classList.add("error");
    return;
  }
  if (!text) {
    parseStatus.textContent = "请先粘贴内容，再进行保存。";
    parseStatus.classList.add("error");
    return;
  }

  const items = getSavedItems();
  const existing = items.find((x) => x.name === name);
  const now = Date.now();

  if (existing) {
    existing.rawText = text;
    existing.updatedAt = now;
  } else {
    items.push({
      id: `${now}-${Math.random().toString(36).slice(2, 7)}`,
      name,
      rawText: text,
      updatedAt: now,
    });
  }

  setSavedItems(items);
  renderSavedOptions();
  savedSelect.value = existing ? existing.id : items[items.length - 1].id;
  parseStatus.classList.remove("error");
  parseStatus.textContent = `已保存“${name}”。`;
}

function loadSelectedPaste() {
  const id = savedSelect.value;
  if (!id) return;
  const item = getSavedItems().find((x) => x.id === id);
  if (!item) return;

  rawInput.value = item.rawText;
  saveNameInput.value = item.name;
  onParse();
  parseStatus.classList.remove("error");
  parseStatus.textContent = `已加载“${item.name}”。`;
}

function deleteSelectedPaste() {
  const id = savedSelect.value;
  if (!id) return;
  const items = getSavedItems();
  const target = items.find((x) => x.id === id);
  const next = items.filter((x) => x.id !== id);
  setSavedItems(next);
  renderSavedOptions();
  parseStatus.classList.remove("error");
  parseStatus.textContent = target ? `已删除“${target.name}”。` : "已删除所选数据。";
}

function exportSavedData() {
  const items = getSavedItems();
  if (!items.length) {
    parseStatus.classList.add("error");
    parseStatus.textContent = "当前没有可导出的小区数据。";
    return;
  }

  const payload = {
    version: 1,
    exportedAt: new Date().toISOString(),
    items: items.map((item) => ({
      name: item.name,
      rawText: item.rawText,
      updatedAt: item.updatedAt || Date.now(),
    })),
  };

  const jsonText = JSON.stringify(payload, null, 2);
  const jsonTextUtf8 = `\uFEFF${jsonText}`;
  const stamp = new Date().toISOString().slice(0, 10).replace(/-/g, "");
  const fileName = `housing-saved-${stamp}.json`;

  const blob = new Blob([jsonTextUtf8], { type: "application/json;charset=utf-8" });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = fileName;
  a.rel = "noopener";
  document.body.appendChild(a);
  a.click();
  a.remove();
  setTimeout(() => URL.revokeObjectURL(url), 1000);

  parseStatus.classList.remove("error");
  parseStatus.textContent = `已导出 ${items.length} 个小区数据。`;
}

async function importSavedData(event) {
  const file = event.target.files && event.target.files[0];
  if (!file) return;

  try {
    const text = await readFileText(file);
    const parsed = JSON.parse(text);
    const importedItems = Array.isArray(parsed) ? parsed : parsed.items;
    if (!Array.isArray(importedItems)) {
      throw new Error("bad-format");
    }

    const cleaned = importedItems
      .filter((x) => x && typeof x.name === "string" && typeof x.rawText === "string")
      .map((x) => ({
        name: x.name.trim(),
        rawText: x.rawText,
        updatedAt: Number(x.updatedAt) || Date.now(),
      }))
      .filter((x) => x.name && x.rawText);

    if (!cleaned.length) {
      throw new Error("empty");
    }

    const now = Date.now();
    const byName = new Map(getSavedItems().map((x) => [x.name, x]));
    cleaned.forEach((item, idx) => {
      const existing = byName.get(item.name);
      if (existing) {
        existing.rawText = item.rawText;
        existing.updatedAt = now + idx;
      } else {
        byName.set(item.name, {
          id: `${now + idx}-${Math.random().toString(36).slice(2, 7)}`,
          name: item.name,
          rawText: item.rawText,
          updatedAt: now + idx,
        });
      }
    });

    setSavedItems([...byName.values()]);
    renderSavedOptions();

    const firstImportedName = cleaned[0].name;
    const selected = getSavedItems().find((x) => x.name === firstImportedName);
    if (selected) {
      savedSelect.value = selected.id;
      loadSelectedPaste();
    }

    parseStatus.classList.remove("error");
    parseStatus.textContent = `已导入 ${cleaned.length} 个小区数据。`;
  } catch {
    parseStatus.classList.add("error");
    parseStatus.textContent = "导入失败，请选择正确的 JSON 文件。";
  } finally {
    importSavedFile.value = "";
  }
}

function readFileText(file) {
  if (typeof file.text === "function") {
    return file.text();
  }
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.onload = () => resolve(String(reader.result || ""));
    reader.onerror = () => reject(new Error("read-failed"));
    reader.readAsText(file, "utf-8");
  });
}

function extractDatePriceRows(text) {
  const tabularRows = extractTabularRows(text);
  if (tabularRows.length) return tabularRows;

  const dateRegex = /(\d{4})(?:[.\/-]|年)(\d{1,2})(?:(?:[.\/-]|月)(\d{1,2}))?/g;
  const unitPriceRegex = /(\d{4,7}(?:\.\d+)?)\s*元(?:\s*[\/／]\s*(?:平|平米|㎡|m²))?/;

  const dates = Array.from(text.matchAll(dateRegex)).map((m) => ({
    index: m.index,
    year: Number(m[1]),
    month: Number(m[2]),
    day: m[3] ? Number(m[3]) : 1,
  }));

  if (!dates.length) return [];

  const out = [];

  for (let i = 0; i < dates.length; i += 1) {
    const d = dates[i];
    if (
      d.year < 2000 ||
      d.year > 2100 ||
      d.month < 1 ||
      d.month > 12 ||
      d.day < 1 ||
      d.day > 31
    ) {
      continue;
    }
    const nextDate = dates[i + 1];
    const currentLineStart = text.lastIndexOf("\n", d.index - 1) + 1;
    const previousLineBreak = text.lastIndexOf("\n", currentLineStart - 2);
    const blockStart = previousLineBreak >= 0 ? previousLineBreak + 1 : 0;
    const nextLineStart = nextDate ? text.lastIndexOf("\n", nextDate.index - 1) + 1 : text.length;
    const blockEnd = nextDate ? nextLineStart : text.length;
    const block = text.slice(blockStart, blockEnd);
    if (isParkingRecord(block)) continue;
    const unitPriceMatch = block.match(unitPriceRegex);
    if (!unitPriceMatch) continue;

    const y = String(d.year).padStart(4, "0");
    const m = String(d.month).padStart(2, "0");
    const day = String(d.day).padStart(2, "0");
    const details = extractHouseDetails(block, d);

    out.push({
      date: `${y}-${m}-${day}`,
      price: Number(unitPriceMatch[1]),
      area: details.area,
      totalPrice: details.totalPrice,
      direction: details.direction,
      floor: details.floor,
    });
  }

  return out;
}

function isParkingRecord(textBlock) {
  return /车位|车库|停车位|车位房/.test(textBlock);
}

function extractTabularRows(text) {
  const lines = text
    .replace(/\r/g, "")
    .split("\n")
    .map((line) => line.trim())
    .filter(Boolean);

  const rows = [];
  lines.forEach((line) => {
    if (/^日期[\t ,，]*单价/.test(line)) return;
    const delimiter = line.includes("\t") ? "\t" : line.includes(",") ? "," : line.includes("，") ? "，" : "";
    if (!delimiter) return;
    if (isParkingRecord(line)) return;

    const cols = line.split(delimiter).map((s) => s.trim());
    if (cols.length < 5) return;

    const dateMatch = cols[0].match(/(\d{4})(?:[.\/-]|年)(\d{1,2})(?:(?:[.\/-]|月)(\d{1,2}))?/);
    const priceMatch = cols[1].match(/(\d+(?:\.\d+)?)(?:\s*元)?/);
    if (!dateMatch || !priceMatch) return;
    const yearNum = Number(dateMatch[1]);
    const monthNum = Number(dateMatch[2]);
    const dayNum = Number(dateMatch[3] || "1");
    if (
      yearNum < 2000 ||
      yearNum > 2100 ||
      monthNum < 1 ||
      monthNum > 12 ||
      dayNum < 1 ||
      dayNum > 31
    ) {
      return;
    }

    const y = dateMatch[1].padStart(4, "0");
    const m = String(Number(dateMatch[2])).padStart(2, "0");
    const d = String(Number(dateMatch[3] || "1")).padStart(2, "0");
    const areaCol = cols[2] || "";
    const c3 = cols[3] || "";
    const c4 = cols[4] || "";
    const c5 = cols[5] || "";
    const c6 = cols[6] || "";

    const areaMatch = areaCol.match(/(\d+(?:\.\d+)?)/);
    let totalRaw = c3;
    let directionRaw = c4;
    let floorRaw = c5;
    // Handle shifted CSV rows like: date,price,area,direction,floor,total
    if (/\d/.test(c6) && /(高楼层|中楼层|低楼层|顶层|底层|高层|中层|低层)/.test(c5)) {
      totalRaw = c6;
      directionRaw = c3;
      floorRaw = c4;
    }
    const totalMatch = totalRaw.match(/(\d+(?:\.\d+)?)(?:\s*万)?/);
    const floorMatch = floorRaw.match(/(高楼层|中楼层|低楼层|顶层|底层|高层|中层|低层)(?:[（(][^）)]*[）)])?/);

    rows.push({
      date: `${y}-${m}-${d}`,
      price: Number(priceMatch[1]),
      area: areaMatch ? `${areaMatch[1]}㎡` : "-",
      totalPrice: totalMatch ? `${totalMatch[1]}万` : "-",
      direction: directionRaw || "-",
      floor: floorMatch ? floorMatch[0] : floorRaw || "-",
    });
  });

  return rows;
}

function extractHouseDetails(chunk, dateInfo) {
  const columnDetails = extractColumnStyleDetails(chunk);
  if (columnDetails) return columnDetails;

  const areaMatch = chunk.match(/(\d+(?:\.\d+)?)\s*(?:平米|㎡|m²)/);
  const exactDatePattern = `${dateInfo.year}(?:[./-]|年)0?${dateInfo.month}(?:(?:[./-]|月)0?${dateInfo.day})?(?:日)?`;
  const dateFollowedPriceRegex = new RegExp(`${exactDatePattern}\\s*(\\d+(?:\\.\\d+)?)\\s*万`);
  const dateInTextRegex = new RegExp(
    exactDatePattern
  );
  const chunkAfterDate = chunk.replace(dateInTextRegex, " ");
  const dateFollowedPriceMatch = chunk.match(dateFollowedPriceRegex);
  const totalPriceMatch =
    dateFollowedPriceMatch ||
    chunkAfterDate.match(/成交总价\s*(\d+(?:\.\d+)?)\s*万/) ||
    chunkAfterDate.match(/总价\s*(\d+(?:\.\d+)?)\s*万/) ||
    chunkAfterDate.match(/(\d+(?:\.\d+)?)\s*万/);
  const directionMatch = chunk.match(/(东南|东北|西南|西北|东|南|西|北)(?:\s+(东南|东北|西南|西北|东|南|西|北))?/);
  const floorMatch = chunk.match(/(高楼层|中楼层|低楼层|顶层|底层|高层|中层|低层)(?:[（(][^）)]*[）)])?/);

  return {
    area: areaMatch ? `${areaMatch[1]}㎡` : "-",
    totalPrice: totalPriceMatch ? `${totalPriceMatch[1]}万` : "-",
    direction: directionMatch ? `${directionMatch[1]}${directionMatch[2] ? ` ${directionMatch[2]}` : ""}` : "-",
    floor: floorMatch ? floorMatch[0] : "-",
  };
}

function extractColumnStyleDetails(chunk) {
  const cols = chunk
    .replace(/\r/g, "")
    .split(/\t+/)
    .map((s) => s.trim())
    .filter(Boolean);

  if (cols.length < 5) return null;

  const areaRaw = cols[2] || "";
  const totalRaw = cols[3] || "";
  const directionRaw = cols[4] || "";
  const floorRaw = cols[5] || "";

  const areaMatch = areaRaw.match(/(\d+(?:\.\d+)?)/);
  const totalMatch = totalRaw.match(/(\d+(?:\.\d+)?)\s*万/);
  const floorMatch = floorRaw.match(/(高楼层|中楼层|低楼层|顶层|底层|高层|中层|低层)(?:[（(][^）)]*[）)])?/);

  return {
    area: areaMatch ? `${areaMatch[1]}㎡` : "-",
    totalPrice: totalMatch ? `${totalMatch[1]}万` : "-",
    direction: directionRaw || "-",
    floor: floorMatch ? floorMatch[0] : floorRaw || "-",
  };
}

function render() {
  if (!parsedData.length) return;

  const startYear = Number(startYearSlider.value);
  startYearLabel.textContent = String(startYear);

  const data = parsedData.filter((p) => Number(p.date.slice(0, 4)) >= startYear);
  if (data.length < 2) return;

  const first = data[0];
  const last = data[data.length - 1];
  const peak = data.reduce((prev, cur) => (cur.price > prev.price ? cur : prev), data[0]);

  startPriceEl.textContent = `${formatCurrency(peak.price)}/㎡（${formatYearMonth(peak.date)}）`;
  startPriceEl.style.color = "#d43b3b";
  latestPriceEl.textContent = `${formatCurrency(last.price)}/㎡（${formatYearMonth(last.date)}）`;

  const drawdown = ((last.price - peak.price) / peak.price) * 100;
  totalChangeEl.textContent = `${drawdown.toFixed(2)}%`;
  totalChangeEl.style.color = drawdown < 0 ? "#8f2121" : "#1f6f5f";

  renderChart(data);
  renderTable([...data].reverse());
}

function renderChart(data) {
  const pad = { top: 24, right: 30, bottom: 36, left: 72 };
  const width = 900;
  const height = 380;
  const innerW = width - pad.left - pad.right;
  const innerH = height - pad.top - pad.bottom;

  const prices = data.map((d) => d.price);
  const min = Math.min(...prices) * 0.985;
  const max = Math.max(...prices) * 1.015;
  const plotDates = buildPlotDates(data);
  const dates = data.map((d) => new Date(d.date));
  const startYear = dates[0].getFullYear();
  const endYear = dates[dates.length - 1].getFullYear();
  // Use full-year domain for consistent year spacing across different compounds.
  const minTime = new Date(`${startYear}-01-01T00:00:00`).getTime();
  const maxTime = new Date(`${endYear + 1}-01-01T00:00:00`).getTime();
  const x = (dateValue) => {
    const t = dateValue.getTime();
    const ratio = (t - minTime) / (maxTime - minTime || 1);
    return pad.left + ratio * innerW;
  };
  const y = (price) => pad.top + ((max - price) / (max - min || 1)) * innerH;

  const points = data.map((d, idx) => ({
    idx,
    x: x(plotDates[idx]),
    y: y(d.price),
    row: d,
  }));
  const path = points.map((p, i) => `${i === 0 ? "M" : "L"}${p.x.toFixed(2)},${p.y.toFixed(2)}`).join(" ");

  const yTicks = 5;
  const grid = Array.from({ length: yTicks + 1 }, (_, i) => {
    const p = min + ((max - min) * i) / yTicks;
    const py = y(p);
    return `
      <line class="grid-line" x1="${pad.left}" y1="${py}" x2="${width - pad.right}" y2="${py}" />
      <text x="10" y="${py + 4}" fill="#637581" font-size="12">${shortCurrency(p)}</text>
    `;
  }).join("");

  const maxPrice = Math.max(...data.map((d) => d.price));
  const minPrice = Math.min(...data.map((d) => d.price));
  const maxPoints = points.filter((p) => p.row.price === maxPrice);
  const minPoints = points.filter((p) => p.row.price === minPrice);
  const dots = points
    .map((point) => {
      const isHighest = point.row.price === maxPrice;
      const isLowest = point.row.price === minPrice;
      const classes = `data-point${isHighest ? " highest-point" : ""}${isLowest ? " lowest-point" : ""}`;
      return `<circle
        class="${classes}"
        cx="${point.x}"
        cy="${point.y}"
        r="3"
        data-date="${encodeForAttr(point.row.date)}"
        data-price="${encodeForAttr(`${formatCurrency(point.row.price)}/㎡`)}"
        data-area="${encodeForAttr(point.row.area || "-")}"
        data-total="${encodeForAttr(point.row.totalPrice || "-")}"
        data-direction="${encodeForAttr(point.row.direction || "-")}"
        data-floor="${encodeForAttr(point.row.floor || "-")}"
        data-index="${point.idx ?? ""}"
      />`;
    })
    .join("");

  const extremePoints = [...maxPoints, ...minPoints.filter((p) => p.row.price !== maxPrice)];
  const extremeOverlays = extremePoints
    .map((point) => {
      const isHighest = point.row.price === maxPrice;
      const className = isHighest ? "extreme-point max-overlay" : "extreme-point min-overlay";
      return `<circle class="${className}" cx="${point.x}" cy="${point.y}" r="${isHighest ? 4.5 : 5}" />`;
    })
    .join("");

  const extremeLabels = extremePoints
    .map((point) => {
      const isHighest = point.row.price === maxPrice;
      const labelClass = isHighest ? "price-label highest-label" : "price-label lowest-label";
      const labelX = point.x + 18;
      const labelY = point.y > height - 34 ? point.y - 10 : point.y + 4;
      return `<text class="${labelClass}" x="${labelX}" y="${labelY}">${shortCurrency(point.row.price)}</text>`;
    })
    .join("");

  const tickMap = new Map();
  for (let year = startYear; year <= endYear; year += 1) {
    const jan1Time = new Date(`${year}-01-01`).getTime();
    tickMap.set(year, jan1Time);
  }

  const xTicks = [...tickMap.entries()]
    .map(([year, time]) => {
      const px = x(new Date(time));
      return `
        <line class="axis" x1="${px}" y1="${height - pad.bottom}" x2="${px}" y2="${height - pad.bottom + 5}" />
        <text x="${px}" y="${height - 10}" text-anchor="middle" fill="#637581" font-size="12">${year}</text>
      `;
    })
    .join("");

  chart.innerHTML = `
    ${grid}
    <line class="axis" x1="${pad.left}" y1="${height - pad.bottom}" x2="${width - pad.right}" y2="${height - pad.bottom}" />
    <line class="axis" x1="${pad.left}" y1="${pad.top}" x2="${pad.left}" y2="${height - pad.bottom}" />
    ${xTicks}
    <path id="trend-path" class="path" d="${path}" />
    ${dots}
    ${extremeOverlays}
    ${extremeLabels}
    <g id="coaster-cart" class="coaster-cart" transform="translate(${points[0].x} ${points[0].y}) rotate(0)">
      <path class="coaster-body" d="M -34 8 L -30 -10 L 18 -10 Q 32 -9 34 1 L 30 8 Z"></path>
      <rect class="coaster-bar" x="-22" y="-2" width="40" height="4" rx="2"></rect>
      <circle class="coaster-wheel" cx="-18" cy="14" r="5"></circle>
      <circle class="coaster-wheel" cx="18" cy="14" r="5"></circle>
      <g class="cat-rider" transform="translate(0,-18)">
        <text class="cat-emoji" x="0" y="-1.2">😻</text>
      </g>
    </g>
    <g id="fireworks-layer"></g>
    <text x="${width - 230}" y="${height - 22}" fill="#637581" font-size="12">${data[0].date.slice(0, 7)} 至 ${data[data.length - 1].date.slice(0, 7)}</text>
  `;
  bindChartTooltip(points);
  startCoasterAnimation(points, maxPrice);
}

function buildPlotDates(rows) {
  const baseDates = rows.map((row) => new Date(`${row.date}T12:00:00`));
  const groups = new Map();

  rows.forEach((row, idx) => {
    const arr = groups.get(row.date) || [];
    arr.push(idx);
    groups.set(row.date, arr);
  });

  const stepMinutes = 90;
  groups.forEach((indexes) => {
    if (indexes.length < 2) return;
    const center = (indexes.length - 1) / 2;
    indexes.forEach((dataIdx, pos) => {
      const offsetMinutes = (pos - center) * stepMinutes;
      baseDates[dataIdx] = new Date(baseDates[dataIdx].getTime() + offsetMinutes * 60 * 1000);
    });
  });

  return baseDates;
}

function renderTable(rows) {
  dataBody.innerHTML = rows
    .map((row) => {
      return `
        <tr>
          <td>${row.date}</td>
          <td>${formatCurrency(row.price)}/㎡</td>
          <td>${row.area || "-"}</td>
          <td>${row.totalPrice || "-"}</td>
          <td>${row.direction || "-"}</td>
          <td>${row.floor || "-"}</td>
        </tr>
      `;
    })
    .join("");
}

function formatCurrency(value) {
  return new Intl.NumberFormat("zh-CN", {
    style: "currency",
    currency: "CNY",
    maximumFractionDigits: 0,
  }).format(value);
}

function shortCurrency(value) {
  const rounded = Math.round(value);
  return `${(rounded / 10000).toFixed(1)}万`;
}

function formatYearMonth(dateText) {
  const match = String(dateText || "").match(/^(\d{4})-(\d{2})/);
  if (!match) return "-";
  return `${match[1]}.${match[2]}`;
}

function encodeForAttr(value) {
  return encodeURIComponent(value);
}

function bindChartTooltip(points) {
  const pointEls = chart.querySelectorAll(".data-point");
  chart.onmouseleave = hideChartTooltip;
  chart.onmousemove = (event) => {
    if (!points.length) return;
    const svgX = getSvgXFromMouse(event);
    const nearestIndex = getNearestPointIndex(points, svgX);
    const nearestEl = chart.querySelector(`.data-point[data-index="${nearestIndex}"]`);
    if (!nearestEl) return;
    showChartTooltip(nearestEl);
    setActivePoint(nearestIndex);
  };

  pointEls.forEach((point) => {
    point.addEventListener("mouseenter", () => showChartTooltip(point));
    point.addEventListener("mousemove", () => showChartTooltip(point));
    point.addEventListener("click", () => showChartTooltip(point));
    point.addEventListener("mouseenter", () => setActivePoint(Number(point.dataset.index || -1)));
  });
}

function showChartTooltip(point) {
  if (!chartTooltip || !chartPanel) return;

  const date = decodeURIComponent(point.dataset.date || "-");
  const price = decodeURIComponent(point.dataset.price || "-");
  const area = decodeURIComponent(point.dataset.area || "-");
  const total = decodeURIComponent(point.dataset.total || "-");
  const direction = decodeURIComponent(point.dataset.direction || "-");
  const floor = decodeURIComponent(point.dataset.floor || "-");

  chartTooltip.innerHTML = `
    <div class="title">${date}</div>
    <div>单价：${price}</div>
    <div>面积：${area}</div>
    <div>总价：${total}</div>
    <div>朝向：${direction}</div>
    <div>楼层：${floor}</div>
  `;
  chartTooltip.style.display = "block";

  const svgWidth = 900;
  const svgHeight = 380;
  const cx = Number(point.getAttribute("cx"));
  const cy = Number(point.getAttribute("cy"));
  const chartRect = chart.getBoundingClientRect();
  const panelRect = chartPanel.getBoundingClientRect();
  const px = chartRect.left - panelRect.left + (cx / svgWidth) * chartRect.width;
  const py = chartRect.top - panelRect.top + (cy / svgHeight) * chartRect.height;

  let left = px + 12;
  let top = py - 10;
  const tipRect = chartTooltip.getBoundingClientRect();
  const maxLeft = chartPanel.clientWidth - tipRect.width - 8;
  if (left > maxLeft) left = Math.max(8, px - tipRect.width - 12);
  if (top - tipRect.height < 4) top = py + 12;

  chartTooltip.style.left = `${left}px`;
  chartTooltip.style.top = `${top}px`;
}

function hideChartTooltip() {
  if (!chartTooltip) return;
  chartTooltip.style.display = "none";
  clearActivePoint();
}

function getSvgXFromMouse(event) {
  const rect = chart.getBoundingClientRect();
  const ratioX = (event.clientX - rect.left) / rect.width;
  return Math.max(0, Math.min(900, ratioX * 900));
}

function getNearestPointIndex(points, svgX) {
  let nearestIndex = 0;
  let nearestDelta = Math.abs(points[0].x - svgX);
  for (let i = 1; i < points.length; i += 1) {
    const delta = Math.abs(points[i].x - svgX);
    if (delta < nearestDelta) {
      nearestDelta = delta;
      nearestIndex = i;
    }
  }
  return nearestIndex;
}

function setActivePoint(index) {
  if (activePointIndex === index) return;
  clearActivePoint();
  const el = chart.querySelector(`.data-point[data-index="${index}"]`);
  if (!el) return;
  el.classList.add("active-point");
  activePointIndex = index;
}

function clearActivePoint() {
  if (activePointIndex < 0) return;
  const prevEl = chart.querySelector(`.data-point[data-index="${activePointIndex}"]`);
  if (prevEl) prevEl.classList.remove("active-point");
  activePointIndex = -1;
}

function startCoasterAnimation(points, maxPrice) {
  if (coasterFrameId) cancelAnimationFrame(coasterFrameId);
  activeFireworks = [];

  const pathEl = chart.querySelector("#trend-path");
  const cart = chart.querySelector("#coaster-cart");
  const fireworksLayer = chart.querySelector("#fireworks-layer");
  if (!pathEl || !cart || !fireworksLayer) return;

  const total = pathEl.getTotalLength();
  const speed = 1.4;
  const peakPoints = points.filter((p) => p.row.price === maxPrice);
  let lastFireworkAt = 0;

  const animate = () => {
    coasterDistance = (coasterDistance + speed) % total;
    const p = pathEl.getPointAtLength(coasterDistance);
    const p2 = pathEl.getPointAtLength((coasterDistance + 1) % total);
    const catEmoji = cart.querySelector(".cat-emoji");
    const slopeY = p2.y - p.y;
    if (slopeY > 0.6) {
      cart.classList.add("downhill");
      if (catEmoji) catEmoji.textContent = "🙀";
    } else if (Math.abs(slopeY) <= 0.6) {
      cart.classList.remove("downhill");
      if (catEmoji) catEmoji.textContent = "😼";
    } else {
      cart.classList.remove("downhill");
      if (catEmoji) catEmoji.textContent = "😻";
    }
    const angle = (Math.atan2(p2.y - p.y, p2.x - p.x) * 180) / Math.PI;
    cart.setAttribute("transform", `translate(${p.x} ${p.y}) rotate(${angle})`);
    maybeTriggerFirework(p, peakPoints, fireworksLayer, () => {
      const now = performance.now();
      if (now - lastFireworkAt < 700) return false;
      lastFireworkAt = now;
      return true;
    });
    updateFireworks(fireworksLayer);
    coasterFrameId = requestAnimationFrame(animate);
  };

  animate();
}

function maybeTriggerFirework(cartPoint, peakPoints, layer, cooldownCheck) {
  const triggerDistance = 16;
  for (const peak of peakPoints) {
    const dx = cartPoint.x - peak.x;
    const dy = cartPoint.y - peak.y;
    if (Math.hypot(dx, dy) <= triggerDistance) {
      if (!cooldownCheck()) return;
      spawnFirework(layer, peak.x, peak.y);
      spawnFirework(layer, peak.x + (Math.random() * 14 - 7), peak.y - (12 + Math.random() * 14));
      return;
    }
  }
}

function spawnFirework(layer, x, y) {
  const colors = ["#ff4d4f", "#ffd666", "#73d13d", "#40a9ff", "#9254de", "#ffa940"];
  const count = 42;
  const ns = "http://www.w3.org/2000/svg";

  const core = document.createElementNS(ns, "circle");
  core.setAttribute("cx", String(x));
  core.setAttribute("cy", String(y));
  core.setAttribute("r", "8");
  core.setAttribute("fill", "#fff1a8");
  core.setAttribute("opacity", "0.9");
  layer.appendChild(core);
  activeFireworks.push({
    el: core,
    x,
    y,
    vx: 0,
    vy: 0,
    life: 0,
    maxLife: 14,
    core: true,
  });

  for (let i = 0; i < count; i += 1) {
    const angle = (Math.PI * 2 * i) / count + Math.random() * 0.2;
    const speed = 3.2 + Math.random() * 3.4;
    const particle = document.createElementNS(ns, "circle");
    particle.setAttribute("cx", String(x));
    particle.setAttribute("cy", String(y));
    particle.setAttribute("r", String(3.8 + Math.random() * 2.4));
    particle.setAttribute("fill", colors[i % colors.length]);
    particle.setAttribute("stroke", "#ffffff");
    particle.setAttribute("stroke-width", "0.7");
    layer.appendChild(particle);
    activeFireworks.push({
      el: particle,
      x,
      y,
      vx: Math.cos(angle) * speed,
      vy: Math.sin(angle) * speed,
      life: 0,
      maxLife: 54 + Math.random() * 30,
      core: false,
    });
  }
}

function updateFireworks(layer) {
  const next = [];
  for (const p of activeFireworks) {
    p.life += 1;
    if (!p.core) {
      p.x += p.vx;
      p.y += p.vy;
      p.vy += 0.055;
      p.vx *= 0.991;
    }
    const alpha = Math.max(0, 1 - p.life / p.maxLife);
    p.el.setAttribute("cx", String(p.x));
    p.el.setAttribute("cy", String(p.y));
    if (p.core) {
      const rr = Math.max(0.6, 8 - p.life * 0.5);
      p.el.setAttribute("r", rr.toFixed(2));
    }
    p.el.setAttribute("opacity", alpha.toFixed(3));
    if (p.life < p.maxLife) {
      next.push(p);
    } else {
      layer.removeChild(p.el);
    }
  }
  activeFireworks = next;
}
