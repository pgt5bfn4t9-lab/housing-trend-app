<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>猫咪房价研究所</title>
    <link rel="stylesheet" href="./housing.css" />
  </head>
  <body>
    <main class="app-shell">
      <header class="hero">
        <div class="hero-title-wrap">
          <p class="eyebrow">链家数据</p>
          <h1>猫咪房价研究所</h1>
        </div>
        <div class="hero-bgm" aria-label="BGM控制">
          <div class="control-row">
            <button id="bgm-btn" type="button" class="ghost">播放BGM</button>
          </div>
          <label>
            BGM音量
            <input id="bgm-volume" type="range" min="0" max="100" step="1" value="35" />
          </label>
        </div>
      </header>

      <section class="panel city-index-panel">
        <h2>二手住宅价格指数（2008-01 至 2026-01）</h2>
        <svg
          id="city-index-chart"
          viewBox="0 0 980 440"
          role="img"
          aria-label="一线城市加香港二手住宅价格指数"
        ></svg>
        <div id="city-index-summary" class="city-index-summary" aria-live="polite"></div>
        <div id="city-index-tooltip" class="viz-tooltip" aria-live="polite"></div>
      </section>

      <section class="panel pyramid-panel">
        <h2>人口年龄结构对比（动态演示）</h2>
        <div class="pyramid-controls">
          <button id="pyramid-play-btn" type="button" class="ghost">暂停动图</button>
          <label class="pyramid-year-control">
            年份
            <input id="pyramid-year" type="range" min="0" max="40" step="1" value="0" />
            <span id="pyramid-year-label">1991</span>
          </label>
        </div>
        <svg
          id="population-pyramid-chart"
          viewBox="0 0 980 470"
          role="img"
          aria-label="中国与印度人口年龄结构对比"
        ></svg>
        <div id="pyramid-working-age-summary" class="pyramid-working-age-summary" aria-live="polite"></div>
        <div id="population-pyramid-tooltip" class="viz-tooltip" aria-live="polite"></div>
      </section>

      <section class="panel district-panel">
        <h2>广州二手房成交套数</h2>
        <svg
          id="district-residence-chart"
          viewBox="0 0 980 440"
          role="img"
          aria-label="2021到2025年按行政区住宅成交套数柱状图"
        ></svg>
        <div id="district-tooltip" class="district-tooltip" aria-live="polite"></div>
      </section>

      <section class="panel controls">
        <div class="control-row">
          <label class="inline-field">
            小区
            <select id="saved-select" aria-label="小区选择"></select>
          </label>
          <button id="delete-btn" type="button" class="ghost">删除所选</button>
        </div>

        <div class="control-row">
          <button id="export-saved-btn" type="button" class="ghost">导出小区JSON</button>
          <button id="import-saved-btn" type="button" class="ghost">导入小区JSON</button>
          <input id="import-saved-file" class="file-input-hidden" type="file" accept="application/json,.json" />
        </div>

      </section>

      <section class="stats" aria-label="汇总统计">
        <article class="stat-card">
          <h2>最高单价</h2>
          <p id="start-price">¥0/㎡</p>
        </article>
        <article class="stat-card">
          <h2>最新单价</h2>
          <p id="latest-price">¥0/㎡</p>
        </article>
        <article class="stat-card">
          <h2>较最高点跌幅</h2>
          <p id="total-change">0%</p>
        </article>
      </section>

      <section class="panel chart-panel">
        <svg id="chart" viewBox="0 0 900 380" role="img" aria-label="猫咪房价研究所折线图"></svg>
        <div id="chart-tooltip" class="chart-tooltip" aria-live="polite"></div>
        <label class="chart-year-control">
          起始年份
          <input id="start-year" type="range" min="2018" max="2026" step="1" value="2021" />
          <span id="start-year-label">2021</span>
        </label>
      </section>

      <section class="panel table-panel">
        <table>
          <thead>
            <tr>
              <th>日期</th>
              <th>单价</th>
              <th>面积</th>
              <th>总价</th>
              <th>朝向</th>
              <th>楼层</th>
            </tr>
          </thead>
          <tbody id="data-body"></tbody>
        </table>
      </section>

      <section class="panel controls">
        <label>
          粘贴链家内容（日期 + 单价）
          <textarea
            id="raw-input"
            rows="7"
            placeholder="示例：\n2024.11.03 ... 38562元/平\n2024.10.18 ... 37210元/平"
          ></textarea>
        </label>

        <div class="control-row">
          <label class="inline-field">
            保存名称
            <input id="save-name" type="text" placeholder="例如：链家 2026年2月" />
          </label>
          <button id="save-btn" type="button">保存当前粘贴数据</button>
        </div>

        <div class="control-row">
          <button id="parse-btn" type="button">使用粘贴数据</button>
        </div>

        <p id="parse-status" class="status">请先粘贴内容，然后点击“使用粘贴数据”。</p>
      </section>
    </main>

    <script type="module" src="./housing-app.mjs"></script>
  </body>
</html>
